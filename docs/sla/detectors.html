<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>sla.detectors API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../sla.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;sla</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#AutoencoderDetector">AutoencoderDetector</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#AutoencoderDetector.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#AutoencoderDetector.predict">predict</a>
                        </li>
                        <li>
                                <a class="function" href="#AutoencoderDetector.anomaly_score">anomaly_score</a>
                        </li>
                        <li>
                                <a class="function" href="#AutoencoderDetector.save_model">save_model</a>
                        </li>
                        <li>
                                <a class="function" href="#AutoencoderDetector.load_model">load_model</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#IsolationForestDetector">IsolationForestDetector</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#IsolationForestDetector.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#IsolationForestDetector.predict">predict</a>
                        </li>
                        <li>
                                <a class="function" href="#IsolationForestDetector.decision_function">decision_function</a>
                        </li>
                        <li>
                                <a class="function" href="#IsolationForestDetector.fit_predict">fit_predict</a>
                        </li>
                        <li>
                                <a class="function" href="#IsolationForestDetector.get_anomalies">get_anomalies</a>
                        </li>
                        <li>
                                <a class="function" href="#IsolationForestDetector.predict_proba">predict_proba</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#RRCFDetector">RRCFDetector</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#RRCFDetector.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#RRCFDetector.predict">predict</a>
                        </li>
                        <li>
                                <a class="function" href="#RRCFDetector.fit_predict">fit_predict</a>
                        </li>
                        <li>
                                <a class="function" href="#RRCFDetector.get_anomalies">get_anomalies</a>
                        </li>
                        <li>
                                <a class="function" href="#RRCFDetector.predict_proba">predict_proba</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#LNNDetector">LNNDetector</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#LNNDetector.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#LNNDetector.predict">predict</a>
                        </li>
                        <li>
                                <a class="function" href="#LNNDetector.anomaly_score">anomaly_score</a>
                        </li>
                        <li>
                                <a class="function" href="#LNNDetector.save_model">save_model</a>
                        </li>
                        <li>
                                <a class="function" href="#LNNDetector.load_model">load_model</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#BaseCustomDetector">BaseCustomDetector</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#BaseCustomDetector.__init__">BaseCustomDetector</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseCustomDetector.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseCustomDetector.predict">predict</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseCustomDetector.anomaly_score">anomaly_score</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseCustomDetector.save_model">save_model</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseCustomDetector.load_model">load_model</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../sla.html">sla</a><wbr>.detectors    </h1>

                        <div class="docstring"><p>Module of detectors.</p>

<p>This module provides a collection of anomaly detection classes for time series data.</p>

<p>Classes:</p>

<pre><code>AutoencoderDetector: Implements anomaly detection using an autoencoder model.

IsolationForestDetector: Implements anomaly detection using the Isolation Forest algorithm.

RRCFDetector: Implements anomaly detection using the Robust Random Cut Forest (RRCF) algorithm.

LNNDetector: Implements anomaly detection using a Learned Neural Network (LNN) approach.
</code></pre>

<p>The detectors are designed to identify anomalous time points in time series data.</p>
</div>

                        <input id="mod-detectors-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-detectors-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="sd">&quot;&quot;&quot;Module of detectors.</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a><span class="sd">This module provides a collection of anomaly detection classes for time series data.</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a><span class="sd">Classes:</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="sd">    AutoencoderDetector: Implements anomaly detection using an autoencoder model.</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="sd">    IsolationForestDetector: Implements anomaly detection using the Isolation Forest algorithm.</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a><span class="sd">    RRCFDetector: Implements anomaly detection using the Robust Random Cut Forest (RRCF) algorithm.</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a><span class="sd">    </span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a><span class="sd">    LNNDetector: Implements anomaly detection using a Learned Neural Network (LNN) approach.</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="sd">The detectors are designed to identify anomalous time points in time series data.</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.autoencoder</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoencoderDetector</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.isolation_forest</span><span class="w"> </span><span class="kn">import</span> <span class="n">IsolationForestDetector</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.rrcf_detector</span><span class="w"> </span><span class="kn">import</span> <span class="n">RRCFDetector</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.lnn</span><span class="w"> </span><span class="kn">import</span> <span class="n">LNNDetector</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.custom_detector</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseCustomDetector</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AutoencoderDetector&#39;</span><span class="p">,</span> <span class="s1">&#39;IsolationForestDetector&#39;</span><span class="p">,</span> <span class="s1">&#39;RRCFDetector&#39;</span><span class="p">,</span> <span class="s1">&#39;LNNDetector&#39;</span><span class="p">,</span> <span class="s1">&#39;BaseCustomDetector&#39;</span><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="AutoencoderDetector">
                            <input id="AutoencoderDetector-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AutoencoderDetector</span>:

                <label class="view-source-button" for="AutoencoderDetector-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AutoencoderDetector"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AutoencoderDetector-158"><a href="#AutoencoderDetector-158"><span class="linenos">158</span></a><span class="k">class</span><span class="w"> </span><span class="nc">AutoencoderDetector</span><span class="p">:</span>
</span><span id="AutoencoderDetector-159"><a href="#AutoencoderDetector-159"><span class="linenos">159</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector-160"><a href="#AutoencoderDetector-160"><span class="linenos">160</span></a><span class="sd">    Autoencoder-based anomaly detector.</span>
</span><span id="AutoencoderDetector-161"><a href="#AutoencoderDetector-161"><span class="linenos">161</span></a><span class="sd">    </span>
</span><span id="AutoencoderDetector-162"><a href="#AutoencoderDetector-162"><span class="linenos">162</span></a><span class="sd">    This class implements an anomaly detector using an autoencoder</span>
</span><span id="AutoencoderDetector-163"><a href="#AutoencoderDetector-163"><span class="linenos">163</span></a><span class="sd">    for detecting anomalies in time series data.</span>
</span><span id="AutoencoderDetector-164"><a href="#AutoencoderDetector-164"><span class="linenos">164</span></a>
</span><span id="AutoencoderDetector-165"><a href="#AutoencoderDetector-165"><span class="linenos">165</span></a><span class="sd">    Args:</span>
</span><span id="AutoencoderDetector-166"><a href="#AutoencoderDetector-166"><span class="linenos">166</span></a><span class="sd">            - n_features (int): Dimension of input features</span>
</span><span id="AutoencoderDetector-167"><a href="#AutoencoderDetector-167"><span class="linenos">167</span></a>
</span><span id="AutoencoderDetector-168"><a href="#AutoencoderDetector-168"><span class="linenos">168</span></a><span class="sd">            - seq_len (int): Length of input sequence</span>
</span><span id="AutoencoderDetector-169"><a href="#AutoencoderDetector-169"><span class="linenos">169</span></a>
</span><span id="AutoencoderDetector-170"><a href="#AutoencoderDetector-170"><span class="linenos">170</span></a><span class="sd">            - latent_dim (int): Dimension of the latent space representation</span>
</span><span id="AutoencoderDetector-171"><a href="#AutoencoderDetector-171"><span class="linenos">171</span></a>
</span><span id="AutoencoderDetector-172"><a href="#AutoencoderDetector-172"><span class="linenos">172</span></a><span class="sd">            - learning_rate (float): Learning rate for training the model</span>
</span><span id="AutoencoderDetector-173"><a href="#AutoencoderDetector-173"><span class="linenos">173</span></a>
</span><span id="AutoencoderDetector-174"><a href="#AutoencoderDetector-174"><span class="linenos">174</span></a><span class="sd">            - batch_size (int): Number of samples per batch</span>
</span><span id="AutoencoderDetector-175"><a href="#AutoencoderDetector-175"><span class="linenos">175</span></a>
</span><span id="AutoencoderDetector-176"><a href="#AutoencoderDetector-176"><span class="linenos">176</span></a><span class="sd">            - epochs (int): Number of epochs for training the model</span>
</span><span id="AutoencoderDetector-177"><a href="#AutoencoderDetector-177"><span class="linenos">177</span></a>
</span><span id="AutoencoderDetector-178"><a href="#AutoencoderDetector-178"><span class="linenos">178</span></a><span class="sd">            - threshold_multiplier (float): Anomaly threshold multiplier</span>
</span><span id="AutoencoderDetector-179"><a href="#AutoencoderDetector-179"><span class="linenos">179</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector-180"><a href="#AutoencoderDetector-180"><span class="linenos">180</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">,</span> <span class="n">latent_dim</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> 
</span><span id="AutoencoderDetector-181"><a href="#AutoencoderDetector-181"><span class="linenos">181</span></a>                 <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> 
</span><span id="AutoencoderDetector-182"><a href="#AutoencoderDetector-182"><span class="linenos">182</span></a>                 <span class="n">threshold_multiplier</span><span class="o">=</span><span class="mf">3.0</span><span class="p">):</span>
</span><span id="AutoencoderDetector-183"><a href="#AutoencoderDetector-183"><span class="linenos">183</span></a>
</span><span id="AutoencoderDetector-184"><a href="#AutoencoderDetector-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_features</span> <span class="o">=</span> <span class="n">n_features</span>
</span><span id="AutoencoderDetector-185"><a href="#AutoencoderDetector-185"><span class="linenos">185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seq_len</span> <span class="o">=</span> <span class="n">seq_len</span>
</span><span id="AutoencoderDetector-186"><a href="#AutoencoderDetector-186"><span class="linenos">186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">latent_dim</span> <span class="o">=</span> <span class="n">latent_dim</span>
</span><span id="AutoencoderDetector-187"><a href="#AutoencoderDetector-187"><span class="linenos">187</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="n">learning_rate</span>
</span><span id="AutoencoderDetector-188"><a href="#AutoencoderDetector-188"><span class="linenos">188</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
</span><span id="AutoencoderDetector-189"><a href="#AutoencoderDetector-189"><span class="linenos">189</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span> <span class="o">=</span> <span class="n">epochs</span>
</span><span id="AutoencoderDetector-190"><a href="#AutoencoderDetector-190"><span class="linenos">190</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold_multiplier</span> <span class="o">=</span> <span class="n">threshold_multiplier</span>
</span><span id="AutoencoderDetector-191"><a href="#AutoencoderDetector-191"><span class="linenos">191</span></a>        
</span><span id="AutoencoderDetector-192"><a href="#AutoencoderDetector-192"><span class="linenos">192</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
</span><span id="AutoencoderDetector-193"><a href="#AutoencoderDetector-193"><span class="linenos">193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">Autoencoder</span><span class="p">(</span><span class="n">n_features</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">)</span>
</span><span id="AutoencoderDetector-194"><a href="#AutoencoderDetector-194"><span class="linenos">194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">)</span>
</span><span id="AutoencoderDetector-195"><a href="#AutoencoderDetector-195"><span class="linenos">195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>
</span><span id="AutoencoderDetector-196"><a href="#AutoencoderDetector-196"><span class="linenos">196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
</span><span id="AutoencoderDetector-197"><a href="#AutoencoderDetector-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AutoencoderDetector-198"><a href="#AutoencoderDetector-198"><span class="linenos">198</span></a>        
</span><span id="AutoencoderDetector-199"><a href="#AutoencoderDetector-199"><span class="linenos">199</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">X_test</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="AutoencoderDetector-200"><a href="#AutoencoderDetector-200"><span class="linenos">200</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector-201"><a href="#AutoencoderDetector-201"><span class="linenos">201</span></a><span class="sd">        Fit the anomaly detector to the input data.</span>
</span><span id="AutoencoderDetector-202"><a href="#AutoencoderDetector-202"><span class="linenos">202</span></a><span class="sd">        </span>
</span><span id="AutoencoderDetector-203"><a href="#AutoencoderDetector-203"><span class="linenos">203</span></a><span class="sd">        Args:</span>
</span><span id="AutoencoderDetector-204"><a href="#AutoencoderDetector-204"><span class="linenos">204</span></a>
</span><span id="AutoencoderDetector-205"><a href="#AutoencoderDetector-205"><span class="linenos">205</span></a><span class="sd">            X (np.ndarray): Input data for training the model</span>
</span><span id="AutoencoderDetector-206"><a href="#AutoencoderDetector-206"><span class="linenos">206</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector-207"><a href="#AutoencoderDetector-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="AutoencoderDetector-208"><a href="#AutoencoderDetector-208"><span class="linenos">208</span></a>        <span class="n">X_scaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="AutoencoderDetector-209"><a href="#AutoencoderDetector-209"><span class="linenos">209</span></a>        <span class="n">X_scaled</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="AutoencoderDetector-210"><a href="#AutoencoderDetector-210"><span class="linenos">210</span></a>        <span class="n">X_test_scaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span> <span class="k">if</span> <span class="n">X_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="AutoencoderDetector-211"><a href="#AutoencoderDetector-211"><span class="linenos">211</span></a>        <span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="k">if</span> <span class="n">X_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="AutoencoderDetector-212"><a href="#AutoencoderDetector-212"><span class="linenos">212</span></a>        
</span><span id="AutoencoderDetector-213"><a href="#AutoencoderDetector-213"><span class="linenos">213</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="AutoencoderDetector-214"><a href="#AutoencoderDetector-214"><span class="linenos">214</span></a>        
</span><span id="AutoencoderDetector-215"><a href="#AutoencoderDetector-215"><span class="linenos">215</span></a>        <span class="n">best_loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
</span><span id="AutoencoderDetector-216"><a href="#AutoencoderDetector-216"><span class="linenos">216</span></a>        
</span><span id="AutoencoderDetector-217"><a href="#AutoencoderDetector-217"><span class="linenos">217</span></a>        <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="p">):</span>
</span><span id="AutoencoderDetector-218"><a href="#AutoencoderDetector-218"><span class="linenos">218</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</span><span id="AutoencoderDetector-219"><a href="#AutoencoderDetector-219"><span class="linenos">219</span></a>
</span><span id="AutoencoderDetector-220"><a href="#AutoencoderDetector-220"><span class="linenos">220</span></a>            <span class="n">train_losses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AutoencoderDetector-221"><a href="#AutoencoderDetector-221"><span class="linenos">221</span></a>            <span class="k">for</span> <span class="n">seq_true</span> <span class="ow">in</span> <span class="n">X_scaled</span><span class="p">:</span>
</span><span id="AutoencoderDetector-222"><a href="#AutoencoderDetector-222"><span class="linenos">222</span></a>                <span class="n">seq_true</span> <span class="o">=</span> <span class="n">seq_true</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="AutoencoderDetector-223"><a href="#AutoencoderDetector-223"><span class="linenos">223</span></a>                <span class="n">seq_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">seq_true</span><span class="p">)</span>
</span><span id="AutoencoderDetector-224"><a href="#AutoencoderDetector-224"><span class="linenos">224</span></a>                <span class="n">seq_pred</span> <span class="o">=</span> <span class="n">seq_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">seq_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],))</span>
</span><span id="AutoencoderDetector-225"><a href="#AutoencoderDetector-225"><span class="linenos">225</span></a>                <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criterion</span><span class="p">(</span><span class="n">seq_pred</span><span class="p">,</span> <span class="n">seq_true</span><span class="p">)</span>
</span><span id="AutoencoderDetector-226"><a href="#AutoencoderDetector-226"><span class="linenos">226</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
</span><span id="AutoencoderDetector-227"><a href="#AutoencoderDetector-227"><span class="linenos">227</span></a>                <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</span><span id="AutoencoderDetector-228"><a href="#AutoencoderDetector-228"><span class="linenos">228</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</span><span id="AutoencoderDetector-229"><a href="#AutoencoderDetector-229"><span class="linenos">229</span></a>
</span><span id="AutoencoderDetector-230"><a href="#AutoencoderDetector-230"><span class="linenos">230</span></a>                <span class="n">train_losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</span><span id="AutoencoderDetector-231"><a href="#AutoencoderDetector-231"><span class="linenos">231</span></a>
</span><span id="AutoencoderDetector-232"><a href="#AutoencoderDetector-232"><span class="linenos">232</span></a>            <span class="n">val_losses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AutoencoderDetector-233"><a href="#AutoencoderDetector-233"><span class="linenos">233</span></a>            <span class="k">if</span> <span class="n">X_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AutoencoderDetector-234"><a href="#AutoencoderDetector-234"><span class="linenos">234</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span><span id="AutoencoderDetector-235"><a href="#AutoencoderDetector-235"><span class="linenos">235</span></a>                <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span><span id="AutoencoderDetector-236"><a href="#AutoencoderDetector-236"><span class="linenos">236</span></a>                    <span class="k">for</span> <span class="n">seq_true</span> <span class="ow">in</span> <span class="n">X_test</span><span class="p">:</span>
</span><span id="AutoencoderDetector-237"><a href="#AutoencoderDetector-237"><span class="linenos">237</span></a>
</span><span id="AutoencoderDetector-238"><a href="#AutoencoderDetector-238"><span class="linenos">238</span></a>                        <span class="n">seq_true</span> <span class="o">=</span> <span class="n">seq_true</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="AutoencoderDetector-239"><a href="#AutoencoderDetector-239"><span class="linenos">239</span></a>                        <span class="n">seq_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">seq_true</span><span class="p">)</span>
</span><span id="AutoencoderDetector-240"><a href="#AutoencoderDetector-240"><span class="linenos">240</span></a>                        <span class="n">seq_pred</span> <span class="o">=</span> <span class="n">seq_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">seq_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],))</span>
</span><span id="AutoencoderDetector-241"><a href="#AutoencoderDetector-241"><span class="linenos">241</span></a>                        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criterion</span><span class="p">(</span><span class="n">seq_pred</span><span class="p">,</span> <span class="n">seq_true</span><span class="p">)</span>
</span><span id="AutoencoderDetector-242"><a href="#AutoencoderDetector-242"><span class="linenos">242</span></a>                        <span class="n">val_losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</span><span id="AutoencoderDetector-243"><a href="#AutoencoderDetector-243"><span class="linenos">243</span></a>                <span class="n">val_loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">val_losses</span><span class="p">)</span>
</span><span id="AutoencoderDetector-244"><a href="#AutoencoderDetector-244"><span class="linenos">244</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Epoch </span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s1">, Train Loss: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">train_losses</span><span class="p">)</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">, Val Loss: </span><span class="si">{</span><span class="n">val_loss</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="AutoencoderDetector-245"><a href="#AutoencoderDetector-245"><span class="linenos">245</span></a>            
</span><span id="AutoencoderDetector-246"><a href="#AutoencoderDetector-246"><span class="linenos">246</span></a>            <span class="n">train_loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">train_losses</span><span class="p">)</span>
</span><span id="AutoencoderDetector-247"><a href="#AutoencoderDetector-247"><span class="linenos">247</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Epoch </span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s1">, Train Loss: </span><span class="si">{</span><span class="n">train_loss</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="AutoencoderDetector-248"><a href="#AutoencoderDetector-248"><span class="linenos">248</span></a>
</span><span id="AutoencoderDetector-249"><a href="#AutoencoderDetector-249"><span class="linenos">249</span></a>            <span class="k">if</span> <span class="n">train_loss</span> <span class="o">&lt;</span> <span class="n">best_loss</span><span class="p">:</span>
</span><span id="AutoencoderDetector-250"><a href="#AutoencoderDetector-250"><span class="linenos">250</span></a>                <span class="n">best_loss</span> <span class="o">=</span> <span class="n">train_loss</span>
</span><span id="AutoencoderDetector-251"><a href="#AutoencoderDetector-251"><span class="linenos">251</span></a>                <span class="n">best_model_wts</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">())</span>
</span><span id="AutoencoderDetector-252"><a href="#AutoencoderDetector-252"><span class="linenos">252</span></a>        
</span><span id="AutoencoderDetector-253"><a href="#AutoencoderDetector-253"><span class="linenos">253</span></a>        <span class="k">return</span> <span class="n">best_model_wts</span>
</span><span id="AutoencoderDetector-254"><a href="#AutoencoderDetector-254"><span class="linenos">254</span></a>        
</span><span id="AutoencoderDetector-255"><a href="#AutoencoderDetector-255"><span class="linenos">255</span></a>    
</span><span id="AutoencoderDetector-256"><a href="#AutoencoderDetector-256"><span class="linenos">256</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_scaled</span><span class="p">):</span>
</span><span id="AutoencoderDetector-257"><a href="#AutoencoderDetector-257"><span class="linenos">257</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector-258"><a href="#AutoencoderDetector-258"><span class="linenos">258</span></a><span class="sd">        Calculate the anomaly threshold.</span>
</span><span id="AutoencoderDetector-259"><a href="#AutoencoderDetector-259"><span class="linenos">259</span></a><span class="sd">        </span>
</span><span id="AutoencoderDetector-260"><a href="#AutoencoderDetector-260"><span class="linenos">260</span></a><span class="sd">        Args:</span>
</span><span id="AutoencoderDetector-261"><a href="#AutoencoderDetector-261"><span class="linenos">261</span></a>
</span><span id="AutoencoderDetector-262"><a href="#AutoencoderDetector-262"><span class="linenos">262</span></a><span class="sd">            X_scaled (np.ndarray): Scaled input data</span>
</span><span id="AutoencoderDetector-263"><a href="#AutoencoderDetector-263"><span class="linenos">263</span></a><span class="sd">            </span>
</span><span id="AutoencoderDetector-264"><a href="#AutoencoderDetector-264"><span class="linenos">264</span></a><span class="sd">        Returns:</span>
</span><span id="AutoencoderDetector-265"><a href="#AutoencoderDetector-265"><span class="linenos">265</span></a>
</span><span id="AutoencoderDetector-266"><a href="#AutoencoderDetector-266"><span class="linenos">266</span></a><span class="sd">            float: Anomaly threshold</span>
</span><span id="AutoencoderDetector-267"><a href="#AutoencoderDetector-267"><span class="linenos">267</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector-268"><a href="#AutoencoderDetector-268"><span class="linenos">268</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span><span id="AutoencoderDetector-269"><a href="#AutoencoderDetector-269"><span class="linenos">269</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
</span><span id="AutoencoderDetector-270"><a href="#AutoencoderDetector-270"><span class="linenos">270</span></a>            <span class="n">X_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="AutoencoderDetector-271"><a href="#AutoencoderDetector-271"><span class="linenos">271</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AutoencoderDetector-272"><a href="#AutoencoderDetector-272"><span class="linenos">272</span></a>            <span class="n">X_tensor</span> <span class="o">=</span> <span class="n">X_scaled</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="AutoencoderDetector-273"><a href="#AutoencoderDetector-273"><span class="linenos">273</span></a>            
</span><span id="AutoencoderDetector-274"><a href="#AutoencoderDetector-274"><span class="linenos">274</span></a>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span><span id="AutoencoderDetector-275"><a href="#AutoencoderDetector-275"><span class="linenos">275</span></a>            <span class="n">X_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">X_tensor</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</span><span id="AutoencoderDetector-276"><a href="#AutoencoderDetector-276"><span class="linenos">276</span></a>        
</span><span id="AutoencoderDetector-277"><a href="#AutoencoderDetector-277"><span class="linenos">277</span></a>        <span class="n">X_numpy</span> <span class="o">=</span> <span class="n">X_scaled</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="k">else</span> <span class="n">X_scaled</span>
</span><span id="AutoencoderDetector-278"><a href="#AutoencoderDetector-278"><span class="linenos">278</span></a>        <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">X_numpy</span> <span class="o">-</span> <span class="n">X_pred</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AutoencoderDetector-279"><a href="#AutoencoderDetector-279"><span class="linenos">279</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold_multiplier</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
</span><span id="AutoencoderDetector-280"><a href="#AutoencoderDetector-280"><span class="linenos">280</span></a>        
</span><span id="AutoencoderDetector-281"><a href="#AutoencoderDetector-281"><span class="linenos">281</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span>
</span><span id="AutoencoderDetector-282"><a href="#AutoencoderDetector-282"><span class="linenos">282</span></a>        
</span><span id="AutoencoderDetector-283"><a href="#AutoencoderDetector-283"><span class="linenos">283</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="AutoencoderDetector-284"><a href="#AutoencoderDetector-284"><span class="linenos">284</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector-285"><a href="#AutoencoderDetector-285"><span class="linenos">285</span></a><span class="sd">        Predict anomalies in the input data.</span>
</span><span id="AutoencoderDetector-286"><a href="#AutoencoderDetector-286"><span class="linenos">286</span></a><span class="sd">        </span>
</span><span id="AutoencoderDetector-287"><a href="#AutoencoderDetector-287"><span class="linenos">287</span></a><span class="sd">        Args:</span>
</span><span id="AutoencoderDetector-288"><a href="#AutoencoderDetector-288"><span class="linenos">288</span></a>
</span><span id="AutoencoderDetector-289"><a href="#AutoencoderDetector-289"><span class="linenos">289</span></a><span class="sd">            X (np.ndarray): Input data for anomaly detection</span>
</span><span id="AutoencoderDetector-290"><a href="#AutoencoderDetector-290"><span class="linenos">290</span></a><span class="sd">            </span>
</span><span id="AutoencoderDetector-291"><a href="#AutoencoderDetector-291"><span class="linenos">291</span></a><span class="sd">        Returns:</span>
</span><span id="AutoencoderDetector-292"><a href="#AutoencoderDetector-292"><span class="linenos">292</span></a>
</span><span id="AutoencoderDetector-293"><a href="#AutoencoderDetector-293"><span class="linenos">293</span></a><span class="sd">            np.ndarray: Binary array where 1 indicates anomaly, 0 indicates normal</span>
</span><span id="AutoencoderDetector-294"><a href="#AutoencoderDetector-294"><span class="linenos">294</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector-295"><a href="#AutoencoderDetector-295"><span class="linenos">295</span></a>        <span class="n">X_scaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="AutoencoderDetector-296"><a href="#AutoencoderDetector-296"><span class="linenos">296</span></a>        <span class="n">X_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="AutoencoderDetector-297"><a href="#AutoencoderDetector-297"><span class="linenos">297</span></a>        
</span><span id="AutoencoderDetector-298"><a href="#AutoencoderDetector-298"><span class="linenos">298</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span><span id="AutoencoderDetector-299"><a href="#AutoencoderDetector-299"><span class="linenos">299</span></a>        
</span><span id="AutoencoderDetector-300"><a href="#AutoencoderDetector-300"><span class="linenos">300</span></a>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span><span id="AutoencoderDetector-301"><a href="#AutoencoderDetector-301"><span class="linenos">301</span></a>            <span class="n">X_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">X_tensor</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</span><span id="AutoencoderDetector-302"><a href="#AutoencoderDetector-302"><span class="linenos">302</span></a>        
</span><span id="AutoencoderDetector-303"><a href="#AutoencoderDetector-303"><span class="linenos">303</span></a>        <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">X_scaled</span> <span class="o">-</span> <span class="n">X_pred</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AutoencoderDetector-304"><a href="#AutoencoderDetector-304"><span class="linenos">304</span></a>        
</span><span id="AutoencoderDetector-305"><a href="#AutoencoderDetector-305"><span class="linenos">305</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AutoencoderDetector-306"><a href="#AutoencoderDetector-306"><span class="linenos">306</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_threshold</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">)</span>
</span><span id="AutoencoderDetector-307"><a href="#AutoencoderDetector-307"><span class="linenos">307</span></a>        
</span><span id="AutoencoderDetector-308"><a href="#AutoencoderDetector-308"><span class="linenos">308</span></a>        <span class="n">anomalies</span> <span class="o">=</span> <span class="p">(</span><span class="n">mse</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="AutoencoderDetector-309"><a href="#AutoencoderDetector-309"><span class="linenos">309</span></a>        
</span><span id="AutoencoderDetector-310"><a href="#AutoencoderDetector-310"><span class="linenos">310</span></a>        <span class="k">return</span> <span class="n">anomalies</span>
</span><span id="AutoencoderDetector-311"><a href="#AutoencoderDetector-311"><span class="linenos">311</span></a>    
</span><span id="AutoencoderDetector-312"><a href="#AutoencoderDetector-312"><span class="linenos">312</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">anomaly_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="AutoencoderDetector-313"><a href="#AutoencoderDetector-313"><span class="linenos">313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector-314"><a href="#AutoencoderDetector-314"><span class="linenos">314</span></a><span class="sd">        Calculate anomaly scores for the input data.</span>
</span><span id="AutoencoderDetector-315"><a href="#AutoencoderDetector-315"><span class="linenos">315</span></a><span class="sd">        </span>
</span><span id="AutoencoderDetector-316"><a href="#AutoencoderDetector-316"><span class="linenos">316</span></a><span class="sd">        Args:</span>
</span><span id="AutoencoderDetector-317"><a href="#AutoencoderDetector-317"><span class="linenos">317</span></a>
</span><span id="AutoencoderDetector-318"><a href="#AutoencoderDetector-318"><span class="linenos">318</span></a><span class="sd">            X (np.ndarray): Input data for anomaly detection</span>
</span><span id="AutoencoderDetector-319"><a href="#AutoencoderDetector-319"><span class="linenos">319</span></a><span class="sd">        </span>
</span><span id="AutoencoderDetector-320"><a href="#AutoencoderDetector-320"><span class="linenos">320</span></a><span class="sd">        Returns:</span>
</span><span id="AutoencoderDetector-321"><a href="#AutoencoderDetector-321"><span class="linenos">321</span></a>
</span><span id="AutoencoderDetector-322"><a href="#AutoencoderDetector-322"><span class="linenos">322</span></a><span class="sd">            np.ndarray: Anomaly scores</span>
</span><span id="AutoencoderDetector-323"><a href="#AutoencoderDetector-323"><span class="linenos">323</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector-324"><a href="#AutoencoderDetector-324"><span class="linenos">324</span></a>        <span class="n">X_scaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="AutoencoderDetector-325"><a href="#AutoencoderDetector-325"><span class="linenos">325</span></a>        <span class="n">X_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="AutoencoderDetector-326"><a href="#AutoencoderDetector-326"><span class="linenos">326</span></a>        
</span><span id="AutoencoderDetector-327"><a href="#AutoencoderDetector-327"><span class="linenos">327</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span><span id="AutoencoderDetector-328"><a href="#AutoencoderDetector-328"><span class="linenos">328</span></a>        
</span><span id="AutoencoderDetector-329"><a href="#AutoencoderDetector-329"><span class="linenos">329</span></a>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span><span id="AutoencoderDetector-330"><a href="#AutoencoderDetector-330"><span class="linenos">330</span></a>            <span class="n">X_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">X_tensor</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</span><span id="AutoencoderDetector-331"><a href="#AutoencoderDetector-331"><span class="linenos">331</span></a>        
</span><span id="AutoencoderDetector-332"><a href="#AutoencoderDetector-332"><span class="linenos">332</span></a>        <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">X_scaled</span> <span class="o">-</span> <span class="n">X_pred</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AutoencoderDetector-333"><a href="#AutoencoderDetector-333"><span class="linenos">333</span></a>        
</span><span id="AutoencoderDetector-334"><a href="#AutoencoderDetector-334"><span class="linenos">334</span></a>        <span class="k">return</span> <span class="n">mse</span>
</span><span id="AutoencoderDetector-335"><a href="#AutoencoderDetector-335"><span class="linenos">335</span></a>    
</span><span id="AutoencoderDetector-336"><a href="#AutoencoderDetector-336"><span class="linenos">336</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</span><span id="AutoencoderDetector-337"><a href="#AutoencoderDetector-337"><span class="linenos">337</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector-338"><a href="#AutoencoderDetector-338"><span class="linenos">338</span></a><span class="sd">        Save the model to disk.</span>
</span><span id="AutoencoderDetector-339"><a href="#AutoencoderDetector-339"><span class="linenos">339</span></a><span class="sd">        </span>
</span><span id="AutoencoderDetector-340"><a href="#AutoencoderDetector-340"><span class="linenos">340</span></a><span class="sd">        Args:</span>
</span><span id="AutoencoderDetector-341"><a href="#AutoencoderDetector-341"><span class="linenos">341</span></a>
</span><span id="AutoencoderDetector-342"><a href="#AutoencoderDetector-342"><span class="linenos">342</span></a><span class="sd">            path (str): File path to save the model</span>
</span><span id="AutoencoderDetector-343"><a href="#AutoencoderDetector-343"><span class="linenos">343</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector-344"><a href="#AutoencoderDetector-344"><span class="linenos">344</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AutoencoderDetector-345"><a href="#AutoencoderDetector-345"><span class="linenos">345</span></a>        <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">path</span><span class="p">)</span>
</span><span id="AutoencoderDetector-346"><a href="#AutoencoderDetector-346"><span class="linenos">346</span></a>        
</span><span id="AutoencoderDetector-347"><a href="#AutoencoderDetector-347"><span class="linenos">347</span></a>        
</span><span id="AutoencoderDetector-348"><a href="#AutoencoderDetector-348"><span class="linenos">348</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</span><span id="AutoencoderDetector-349"><a href="#AutoencoderDetector-349"><span class="linenos">349</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector-350"><a href="#AutoencoderDetector-350"><span class="linenos">350</span></a><span class="sd">        Load the model from disk.</span>
</span><span id="AutoencoderDetector-351"><a href="#AutoencoderDetector-351"><span class="linenos">351</span></a><span class="sd">        </span>
</span><span id="AutoencoderDetector-352"><a href="#AutoencoderDetector-352"><span class="linenos">352</span></a><span class="sd">        Args:</span>
</span><span id="AutoencoderDetector-353"><a href="#AutoencoderDetector-353"><span class="linenos">353</span></a><span class="sd">        </span>
</span><span id="AutoencoderDetector-354"><a href="#AutoencoderDetector-354"><span class="linenos">354</span></a><span class="sd">            path (str): File path to load the model</span>
</span><span id="AutoencoderDetector-355"><a href="#AutoencoderDetector-355"><span class="linenos">355</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector-356"><a href="#AutoencoderDetector-356"><span class="linenos">356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Autoencoder-based anomaly detector.</p>

<p>This class implements an anomaly detector using an autoencoder
for detecting anomalies in time series data.</p>

<p>Args:
        - n_features (int): Dimension of input features</p>

<pre><code>    - seq_len (int): Length of input sequence

    - latent_dim (int): Dimension of the latent space representation

    - learning_rate (float): Learning rate for training the model

    - batch_size (int): Number of samples per batch

    - epochs (int): Number of epochs for training the model

    - threshold_multiplier (float): Anomaly threshold multiplier
</code></pre>
</div>


                            <div id="AutoencoderDetector.fit" class="classattr">
                                        <input id="AutoencoderDetector.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">X_test</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AutoencoderDetector.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AutoencoderDetector.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AutoencoderDetector.fit-199"><a href="#AutoencoderDetector.fit-199"><span class="linenos">199</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">X_test</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="AutoencoderDetector.fit-200"><a href="#AutoencoderDetector.fit-200"><span class="linenos">200</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector.fit-201"><a href="#AutoencoderDetector.fit-201"><span class="linenos">201</span></a><span class="sd">        Fit the anomaly detector to the input data.</span>
</span><span id="AutoencoderDetector.fit-202"><a href="#AutoencoderDetector.fit-202"><span class="linenos">202</span></a><span class="sd">        </span>
</span><span id="AutoencoderDetector.fit-203"><a href="#AutoencoderDetector.fit-203"><span class="linenos">203</span></a><span class="sd">        Args:</span>
</span><span id="AutoencoderDetector.fit-204"><a href="#AutoencoderDetector.fit-204"><span class="linenos">204</span></a>
</span><span id="AutoencoderDetector.fit-205"><a href="#AutoencoderDetector.fit-205"><span class="linenos">205</span></a><span class="sd">            X (np.ndarray): Input data for training the model</span>
</span><span id="AutoencoderDetector.fit-206"><a href="#AutoencoderDetector.fit-206"><span class="linenos">206</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector.fit-207"><a href="#AutoencoderDetector.fit-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="AutoencoderDetector.fit-208"><a href="#AutoencoderDetector.fit-208"><span class="linenos">208</span></a>        <span class="n">X_scaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="AutoencoderDetector.fit-209"><a href="#AutoencoderDetector.fit-209"><span class="linenos">209</span></a>        <span class="n">X_scaled</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="AutoencoderDetector.fit-210"><a href="#AutoencoderDetector.fit-210"><span class="linenos">210</span></a>        <span class="n">X_test_scaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span> <span class="k">if</span> <span class="n">X_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="AutoencoderDetector.fit-211"><a href="#AutoencoderDetector.fit-211"><span class="linenos">211</span></a>        <span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="k">if</span> <span class="n">X_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="AutoencoderDetector.fit-212"><a href="#AutoencoderDetector.fit-212"><span class="linenos">212</span></a>        
</span><span id="AutoencoderDetector.fit-213"><a href="#AutoencoderDetector.fit-213"><span class="linenos">213</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="AutoencoderDetector.fit-214"><a href="#AutoencoderDetector.fit-214"><span class="linenos">214</span></a>        
</span><span id="AutoencoderDetector.fit-215"><a href="#AutoencoderDetector.fit-215"><span class="linenos">215</span></a>        <span class="n">best_loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
</span><span id="AutoencoderDetector.fit-216"><a href="#AutoencoderDetector.fit-216"><span class="linenos">216</span></a>        
</span><span id="AutoencoderDetector.fit-217"><a href="#AutoencoderDetector.fit-217"><span class="linenos">217</span></a>        <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="p">):</span>
</span><span id="AutoencoderDetector.fit-218"><a href="#AutoencoderDetector.fit-218"><span class="linenos">218</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</span><span id="AutoencoderDetector.fit-219"><a href="#AutoencoderDetector.fit-219"><span class="linenos">219</span></a>
</span><span id="AutoencoderDetector.fit-220"><a href="#AutoencoderDetector.fit-220"><span class="linenos">220</span></a>            <span class="n">train_losses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AutoencoderDetector.fit-221"><a href="#AutoencoderDetector.fit-221"><span class="linenos">221</span></a>            <span class="k">for</span> <span class="n">seq_true</span> <span class="ow">in</span> <span class="n">X_scaled</span><span class="p">:</span>
</span><span id="AutoencoderDetector.fit-222"><a href="#AutoencoderDetector.fit-222"><span class="linenos">222</span></a>                <span class="n">seq_true</span> <span class="o">=</span> <span class="n">seq_true</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="AutoencoderDetector.fit-223"><a href="#AutoencoderDetector.fit-223"><span class="linenos">223</span></a>                <span class="n">seq_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">seq_true</span><span class="p">)</span>
</span><span id="AutoencoderDetector.fit-224"><a href="#AutoencoderDetector.fit-224"><span class="linenos">224</span></a>                <span class="n">seq_pred</span> <span class="o">=</span> <span class="n">seq_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">seq_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],))</span>
</span><span id="AutoencoderDetector.fit-225"><a href="#AutoencoderDetector.fit-225"><span class="linenos">225</span></a>                <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criterion</span><span class="p">(</span><span class="n">seq_pred</span><span class="p">,</span> <span class="n">seq_true</span><span class="p">)</span>
</span><span id="AutoencoderDetector.fit-226"><a href="#AutoencoderDetector.fit-226"><span class="linenos">226</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
</span><span id="AutoencoderDetector.fit-227"><a href="#AutoencoderDetector.fit-227"><span class="linenos">227</span></a>                <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</span><span id="AutoencoderDetector.fit-228"><a href="#AutoencoderDetector.fit-228"><span class="linenos">228</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</span><span id="AutoencoderDetector.fit-229"><a href="#AutoencoderDetector.fit-229"><span class="linenos">229</span></a>
</span><span id="AutoencoderDetector.fit-230"><a href="#AutoencoderDetector.fit-230"><span class="linenos">230</span></a>                <span class="n">train_losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</span><span id="AutoencoderDetector.fit-231"><a href="#AutoencoderDetector.fit-231"><span class="linenos">231</span></a>
</span><span id="AutoencoderDetector.fit-232"><a href="#AutoencoderDetector.fit-232"><span class="linenos">232</span></a>            <span class="n">val_losses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AutoencoderDetector.fit-233"><a href="#AutoencoderDetector.fit-233"><span class="linenos">233</span></a>            <span class="k">if</span> <span class="n">X_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AutoencoderDetector.fit-234"><a href="#AutoencoderDetector.fit-234"><span class="linenos">234</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span><span id="AutoencoderDetector.fit-235"><a href="#AutoencoderDetector.fit-235"><span class="linenos">235</span></a>                <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span><span id="AutoencoderDetector.fit-236"><a href="#AutoencoderDetector.fit-236"><span class="linenos">236</span></a>                    <span class="k">for</span> <span class="n">seq_true</span> <span class="ow">in</span> <span class="n">X_test</span><span class="p">:</span>
</span><span id="AutoencoderDetector.fit-237"><a href="#AutoencoderDetector.fit-237"><span class="linenos">237</span></a>
</span><span id="AutoencoderDetector.fit-238"><a href="#AutoencoderDetector.fit-238"><span class="linenos">238</span></a>                        <span class="n">seq_true</span> <span class="o">=</span> <span class="n">seq_true</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="AutoencoderDetector.fit-239"><a href="#AutoencoderDetector.fit-239"><span class="linenos">239</span></a>                        <span class="n">seq_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">seq_true</span><span class="p">)</span>
</span><span id="AutoencoderDetector.fit-240"><a href="#AutoencoderDetector.fit-240"><span class="linenos">240</span></a>                        <span class="n">seq_pred</span> <span class="o">=</span> <span class="n">seq_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">seq_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],))</span>
</span><span id="AutoencoderDetector.fit-241"><a href="#AutoencoderDetector.fit-241"><span class="linenos">241</span></a>                        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criterion</span><span class="p">(</span><span class="n">seq_pred</span><span class="p">,</span> <span class="n">seq_true</span><span class="p">)</span>
</span><span id="AutoencoderDetector.fit-242"><a href="#AutoencoderDetector.fit-242"><span class="linenos">242</span></a>                        <span class="n">val_losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</span><span id="AutoencoderDetector.fit-243"><a href="#AutoencoderDetector.fit-243"><span class="linenos">243</span></a>                <span class="n">val_loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">val_losses</span><span class="p">)</span>
</span><span id="AutoencoderDetector.fit-244"><a href="#AutoencoderDetector.fit-244"><span class="linenos">244</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Epoch </span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s1">, Train Loss: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">train_losses</span><span class="p">)</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">, Val Loss: </span><span class="si">{</span><span class="n">val_loss</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="AutoencoderDetector.fit-245"><a href="#AutoencoderDetector.fit-245"><span class="linenos">245</span></a>            
</span><span id="AutoencoderDetector.fit-246"><a href="#AutoencoderDetector.fit-246"><span class="linenos">246</span></a>            <span class="n">train_loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">train_losses</span><span class="p">)</span>
</span><span id="AutoencoderDetector.fit-247"><a href="#AutoencoderDetector.fit-247"><span class="linenos">247</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Epoch </span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s1">, Train Loss: </span><span class="si">{</span><span class="n">train_loss</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="AutoencoderDetector.fit-248"><a href="#AutoencoderDetector.fit-248"><span class="linenos">248</span></a>
</span><span id="AutoencoderDetector.fit-249"><a href="#AutoencoderDetector.fit-249"><span class="linenos">249</span></a>            <span class="k">if</span> <span class="n">train_loss</span> <span class="o">&lt;</span> <span class="n">best_loss</span><span class="p">:</span>
</span><span id="AutoencoderDetector.fit-250"><a href="#AutoencoderDetector.fit-250"><span class="linenos">250</span></a>                <span class="n">best_loss</span> <span class="o">=</span> <span class="n">train_loss</span>
</span><span id="AutoencoderDetector.fit-251"><a href="#AutoencoderDetector.fit-251"><span class="linenos">251</span></a>                <span class="n">best_model_wts</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">())</span>
</span><span id="AutoencoderDetector.fit-252"><a href="#AutoencoderDetector.fit-252"><span class="linenos">252</span></a>        
</span><span id="AutoencoderDetector.fit-253"><a href="#AutoencoderDetector.fit-253"><span class="linenos">253</span></a>        <span class="k">return</span> <span class="n">best_model_wts</span>
</span></pre></div>


            <div class="docstring"><p>Fit the anomaly detector to the input data.</p>

<p>Args:</p>

<pre><code>X (np.ndarray): Input data for training the model
</code></pre>
</div>


                            </div>
                            <div id="AutoencoderDetector.predict" class="classattr">
                                        <input id="AutoencoderDetector.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AutoencoderDetector.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AutoencoderDetector.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AutoencoderDetector.predict-283"><a href="#AutoencoderDetector.predict-283"><span class="linenos">283</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="AutoencoderDetector.predict-284"><a href="#AutoencoderDetector.predict-284"><span class="linenos">284</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector.predict-285"><a href="#AutoencoderDetector.predict-285"><span class="linenos">285</span></a><span class="sd">        Predict anomalies in the input data.</span>
</span><span id="AutoencoderDetector.predict-286"><a href="#AutoencoderDetector.predict-286"><span class="linenos">286</span></a><span class="sd">        </span>
</span><span id="AutoencoderDetector.predict-287"><a href="#AutoencoderDetector.predict-287"><span class="linenos">287</span></a><span class="sd">        Args:</span>
</span><span id="AutoencoderDetector.predict-288"><a href="#AutoencoderDetector.predict-288"><span class="linenos">288</span></a>
</span><span id="AutoencoderDetector.predict-289"><a href="#AutoencoderDetector.predict-289"><span class="linenos">289</span></a><span class="sd">            X (np.ndarray): Input data for anomaly detection</span>
</span><span id="AutoencoderDetector.predict-290"><a href="#AutoencoderDetector.predict-290"><span class="linenos">290</span></a><span class="sd">            </span>
</span><span id="AutoencoderDetector.predict-291"><a href="#AutoencoderDetector.predict-291"><span class="linenos">291</span></a><span class="sd">        Returns:</span>
</span><span id="AutoencoderDetector.predict-292"><a href="#AutoencoderDetector.predict-292"><span class="linenos">292</span></a>
</span><span id="AutoencoderDetector.predict-293"><a href="#AutoencoderDetector.predict-293"><span class="linenos">293</span></a><span class="sd">            np.ndarray: Binary array where 1 indicates anomaly, 0 indicates normal</span>
</span><span id="AutoencoderDetector.predict-294"><a href="#AutoencoderDetector.predict-294"><span class="linenos">294</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector.predict-295"><a href="#AutoencoderDetector.predict-295"><span class="linenos">295</span></a>        <span class="n">X_scaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="AutoencoderDetector.predict-296"><a href="#AutoencoderDetector.predict-296"><span class="linenos">296</span></a>        <span class="n">X_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="AutoencoderDetector.predict-297"><a href="#AutoencoderDetector.predict-297"><span class="linenos">297</span></a>        
</span><span id="AutoencoderDetector.predict-298"><a href="#AutoencoderDetector.predict-298"><span class="linenos">298</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span><span id="AutoencoderDetector.predict-299"><a href="#AutoencoderDetector.predict-299"><span class="linenos">299</span></a>        
</span><span id="AutoencoderDetector.predict-300"><a href="#AutoencoderDetector.predict-300"><span class="linenos">300</span></a>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span><span id="AutoencoderDetector.predict-301"><a href="#AutoencoderDetector.predict-301"><span class="linenos">301</span></a>            <span class="n">X_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">X_tensor</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</span><span id="AutoencoderDetector.predict-302"><a href="#AutoencoderDetector.predict-302"><span class="linenos">302</span></a>        
</span><span id="AutoencoderDetector.predict-303"><a href="#AutoencoderDetector.predict-303"><span class="linenos">303</span></a>        <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">X_scaled</span> <span class="o">-</span> <span class="n">X_pred</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AutoencoderDetector.predict-304"><a href="#AutoencoderDetector.predict-304"><span class="linenos">304</span></a>        
</span><span id="AutoencoderDetector.predict-305"><a href="#AutoencoderDetector.predict-305"><span class="linenos">305</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AutoencoderDetector.predict-306"><a href="#AutoencoderDetector.predict-306"><span class="linenos">306</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_threshold</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">)</span>
</span><span id="AutoencoderDetector.predict-307"><a href="#AutoencoderDetector.predict-307"><span class="linenos">307</span></a>        
</span><span id="AutoencoderDetector.predict-308"><a href="#AutoencoderDetector.predict-308"><span class="linenos">308</span></a>        <span class="n">anomalies</span> <span class="o">=</span> <span class="p">(</span><span class="n">mse</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="AutoencoderDetector.predict-309"><a href="#AutoencoderDetector.predict-309"><span class="linenos">309</span></a>        
</span><span id="AutoencoderDetector.predict-310"><a href="#AutoencoderDetector.predict-310"><span class="linenos">310</span></a>        <span class="k">return</span> <span class="n">anomalies</span>
</span></pre></div>


            <div class="docstring"><p>Predict anomalies in the input data.</p>

<p>Args:</p>

<pre><code>X (np.ndarray): Input data for anomaly detection
</code></pre>

<p>Returns:</p>

<pre><code>np.ndarray: Binary array where 1 indicates anomaly, 0 indicates normal
</code></pre>
</div>


                            </div>
                            <div id="AutoencoderDetector.anomaly_score" class="classattr">
                                        <input id="AutoencoderDetector.anomaly_score-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">anomaly_score</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AutoencoderDetector.anomaly_score-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AutoencoderDetector.anomaly_score"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AutoencoderDetector.anomaly_score-312"><a href="#AutoencoderDetector.anomaly_score-312"><span class="linenos">312</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">anomaly_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="AutoencoderDetector.anomaly_score-313"><a href="#AutoencoderDetector.anomaly_score-313"><span class="linenos">313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector.anomaly_score-314"><a href="#AutoencoderDetector.anomaly_score-314"><span class="linenos">314</span></a><span class="sd">        Calculate anomaly scores for the input data.</span>
</span><span id="AutoencoderDetector.anomaly_score-315"><a href="#AutoencoderDetector.anomaly_score-315"><span class="linenos">315</span></a><span class="sd">        </span>
</span><span id="AutoencoderDetector.anomaly_score-316"><a href="#AutoencoderDetector.anomaly_score-316"><span class="linenos">316</span></a><span class="sd">        Args:</span>
</span><span id="AutoencoderDetector.anomaly_score-317"><a href="#AutoencoderDetector.anomaly_score-317"><span class="linenos">317</span></a>
</span><span id="AutoencoderDetector.anomaly_score-318"><a href="#AutoencoderDetector.anomaly_score-318"><span class="linenos">318</span></a><span class="sd">            X (np.ndarray): Input data for anomaly detection</span>
</span><span id="AutoencoderDetector.anomaly_score-319"><a href="#AutoencoderDetector.anomaly_score-319"><span class="linenos">319</span></a><span class="sd">        </span>
</span><span id="AutoencoderDetector.anomaly_score-320"><a href="#AutoencoderDetector.anomaly_score-320"><span class="linenos">320</span></a><span class="sd">        Returns:</span>
</span><span id="AutoencoderDetector.anomaly_score-321"><a href="#AutoencoderDetector.anomaly_score-321"><span class="linenos">321</span></a>
</span><span id="AutoencoderDetector.anomaly_score-322"><a href="#AutoencoderDetector.anomaly_score-322"><span class="linenos">322</span></a><span class="sd">            np.ndarray: Anomaly scores</span>
</span><span id="AutoencoderDetector.anomaly_score-323"><a href="#AutoencoderDetector.anomaly_score-323"><span class="linenos">323</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector.anomaly_score-324"><a href="#AutoencoderDetector.anomaly_score-324"><span class="linenos">324</span></a>        <span class="n">X_scaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="AutoencoderDetector.anomaly_score-325"><a href="#AutoencoderDetector.anomaly_score-325"><span class="linenos">325</span></a>        <span class="n">X_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="AutoencoderDetector.anomaly_score-326"><a href="#AutoencoderDetector.anomaly_score-326"><span class="linenos">326</span></a>        
</span><span id="AutoencoderDetector.anomaly_score-327"><a href="#AutoencoderDetector.anomaly_score-327"><span class="linenos">327</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span><span id="AutoencoderDetector.anomaly_score-328"><a href="#AutoencoderDetector.anomaly_score-328"><span class="linenos">328</span></a>        
</span><span id="AutoencoderDetector.anomaly_score-329"><a href="#AutoencoderDetector.anomaly_score-329"><span class="linenos">329</span></a>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span><span id="AutoencoderDetector.anomaly_score-330"><a href="#AutoencoderDetector.anomaly_score-330"><span class="linenos">330</span></a>            <span class="n">X_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">X_tensor</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</span><span id="AutoencoderDetector.anomaly_score-331"><a href="#AutoencoderDetector.anomaly_score-331"><span class="linenos">331</span></a>        
</span><span id="AutoencoderDetector.anomaly_score-332"><a href="#AutoencoderDetector.anomaly_score-332"><span class="linenos">332</span></a>        <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">X_scaled</span> <span class="o">-</span> <span class="n">X_pred</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AutoencoderDetector.anomaly_score-333"><a href="#AutoencoderDetector.anomaly_score-333"><span class="linenos">333</span></a>        
</span><span id="AutoencoderDetector.anomaly_score-334"><a href="#AutoencoderDetector.anomaly_score-334"><span class="linenos">334</span></a>        <span class="k">return</span> <span class="n">mse</span>
</span></pre></div>


            <div class="docstring"><p>Calculate anomaly scores for the input data.</p>

<p>Args:</p>

<pre><code>X (np.ndarray): Input data for anomaly detection
</code></pre>

<p>Returns:</p>

<pre><code>np.ndarray: Anomaly scores
</code></pre>
</div>


                            </div>
                            <div id="AutoencoderDetector.save_model" class="classattr">
                                        <input id="AutoencoderDetector.save_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">path</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AutoencoderDetector.save_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AutoencoderDetector.save_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AutoencoderDetector.save_model-336"><a href="#AutoencoderDetector.save_model-336"><span class="linenos">336</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</span><span id="AutoencoderDetector.save_model-337"><a href="#AutoencoderDetector.save_model-337"><span class="linenos">337</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector.save_model-338"><a href="#AutoencoderDetector.save_model-338"><span class="linenos">338</span></a><span class="sd">        Save the model to disk.</span>
</span><span id="AutoencoderDetector.save_model-339"><a href="#AutoencoderDetector.save_model-339"><span class="linenos">339</span></a><span class="sd">        </span>
</span><span id="AutoencoderDetector.save_model-340"><a href="#AutoencoderDetector.save_model-340"><span class="linenos">340</span></a><span class="sd">        Args:</span>
</span><span id="AutoencoderDetector.save_model-341"><a href="#AutoencoderDetector.save_model-341"><span class="linenos">341</span></a>
</span><span id="AutoencoderDetector.save_model-342"><a href="#AutoencoderDetector.save_model-342"><span class="linenos">342</span></a><span class="sd">            path (str): File path to save the model</span>
</span><span id="AutoencoderDetector.save_model-343"><a href="#AutoencoderDetector.save_model-343"><span class="linenos">343</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector.save_model-344"><a href="#AutoencoderDetector.save_model-344"><span class="linenos">344</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AutoencoderDetector.save_model-345"><a href="#AutoencoderDetector.save_model-345"><span class="linenos">345</span></a>        <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">path</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Save the model to disk.</p>

<p>Args:</p>

<pre><code>path (str): File path to save the model
</code></pre>
</div>


                            </div>
                            <div id="AutoencoderDetector.load_model" class="classattr">
                                        <input id="AutoencoderDetector.load_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">path</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AutoencoderDetector.load_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AutoencoderDetector.load_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AutoencoderDetector.load_model-348"><a href="#AutoencoderDetector.load_model-348"><span class="linenos">348</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</span><span id="AutoencoderDetector.load_model-349"><a href="#AutoencoderDetector.load_model-349"><span class="linenos">349</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector.load_model-350"><a href="#AutoencoderDetector.load_model-350"><span class="linenos">350</span></a><span class="sd">        Load the model from disk.</span>
</span><span id="AutoencoderDetector.load_model-351"><a href="#AutoencoderDetector.load_model-351"><span class="linenos">351</span></a><span class="sd">        </span>
</span><span id="AutoencoderDetector.load_model-352"><a href="#AutoencoderDetector.load_model-352"><span class="linenos">352</span></a><span class="sd">        Args:</span>
</span><span id="AutoencoderDetector.load_model-353"><a href="#AutoencoderDetector.load_model-353"><span class="linenos">353</span></a><span class="sd">        </span>
</span><span id="AutoencoderDetector.load_model-354"><a href="#AutoencoderDetector.load_model-354"><span class="linenos">354</span></a><span class="sd">            path (str): File path to load the model</span>
</span><span id="AutoencoderDetector.load_model-355"><a href="#AutoencoderDetector.load_model-355"><span class="linenos">355</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AutoencoderDetector.load_model-356"><a href="#AutoencoderDetector.load_model-356"><span class="linenos">356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Load the model from disk.</p>

<p>Args:</p>

<pre><code>path (str): File path to load the model
</code></pre>
</div>


                            </div>
                </section>
                <section id="IsolationForestDetector">
                            <input id="IsolationForestDetector-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">IsolationForestDetector</span><wbr>(<span class="base">sklearn.base.BaseEstimator</span>):

                <label class="view-source-button" for="IsolationForestDetector-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IsolationForestDetector"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IsolationForestDetector-6"><a href="#IsolationForestDetector-6"><span class="linenos">  6</span></a><span class="k">class</span><span class="w"> </span><span class="nc">IsolationForestDetector</span><span class="p">(</span><span class="n">BaseEstimator</span><span class="p">):</span>
</span><span id="IsolationForestDetector-7"><a href="#IsolationForestDetector-7"><span class="linenos">  7</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector-8"><a href="#IsolationForestDetector-8"><span class="linenos">  8</span></a><span class="sd">    A detector for identifying anomalies using the Isolation Forest algorithm.</span>
</span><span id="IsolationForestDetector-9"><a href="#IsolationForestDetector-9"><span class="linenos">  9</span></a>
</span><span id="IsolationForestDetector-10"><a href="#IsolationForestDetector-10"><span class="linenos"> 10</span></a><span class="sd">    Args:</span>
</span><span id="IsolationForestDetector-11"><a href="#IsolationForestDetector-11"><span class="linenos"> 11</span></a><span class="sd">    </span>
</span><span id="IsolationForestDetector-12"><a href="#IsolationForestDetector-12"><span class="linenos"> 12</span></a><span class="sd">        - n_estimators : int, optional (default=100)</span>
</span><span id="IsolationForestDetector-13"><a href="#IsolationForestDetector-13"><span class="linenos"> 13</span></a><span class="sd">            The number of base estimators in the ensemble.</span>
</span><span id="IsolationForestDetector-14"><a href="#IsolationForestDetector-14"><span class="linenos"> 14</span></a>
</span><span id="IsolationForestDetector-15"><a href="#IsolationForestDetector-15"><span class="linenos"> 15</span></a><span class="sd">        - max_samples : int or float, optional (default=&#39;auto&#39;)</span>
</span><span id="IsolationForestDetector-16"><a href="#IsolationForestDetector-16"><span class="linenos"> 16</span></a><span class="sd">            The number of samples to draw from X to train each base estimator.</span>
</span><span id="IsolationForestDetector-17"><a href="#IsolationForestDetector-17"><span class="linenos"> 17</span></a><span class="sd">            If &#39;auto&#39;, then max_samples=min(256, n_samples).</span>
</span><span id="IsolationForestDetector-18"><a href="#IsolationForestDetector-18"><span class="linenos"> 18</span></a>
</span><span id="IsolationForestDetector-19"><a href="#IsolationForestDetector-19"><span class="linenos"> 19</span></a><span class="sd">        - contamination : &#39;auto&#39; or float, optional (default=&#39;auto&#39;)</span>
</span><span id="IsolationForestDetector-20"><a href="#IsolationForestDetector-20"><span class="linenos"> 20</span></a><span class="sd">            The amount of contamination of the data set, i.e., the proportion of outliers in the data set.</span>
</span><span id="IsolationForestDetector-21"><a href="#IsolationForestDetector-21"><span class="linenos"> 21</span></a><span class="sd">            Used when fitting to define the threshold on the decision function.</span>
</span><span id="IsolationForestDetector-22"><a href="#IsolationForestDetector-22"><span class="linenos"> 22</span></a><span class="sd">            If &#39;auto&#39;, the threshold is determined as in the original paper.</span>
</span><span id="IsolationForestDetector-23"><a href="#IsolationForestDetector-23"><span class="linenos"> 23</span></a>
</span><span id="IsolationForestDetector-24"><a href="#IsolationForestDetector-24"><span class="linenos"> 24</span></a><span class="sd">        - random_state : int, RandomState instance or None, optional (default=None)</span>
</span><span id="IsolationForestDetector-25"><a href="#IsolationForestDetector-25"><span class="linenos"> 25</span></a><span class="sd">            Controls the pseudo-randomness of the selection of the feature and split values for each branching step and each tree in the forest.</span>
</span><span id="IsolationForestDetector-26"><a href="#IsolationForestDetector-26"><span class="linenos"> 26</span></a><span class="sd">            Pass an int for reproducible results across multiple function calls..</span>
</span><span id="IsolationForestDetector-27"><a href="#IsolationForestDetector-27"><span class="linenos"> 27</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector-28"><a href="#IsolationForestDetector-28"><span class="linenos"> 28</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_samples</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">contamination</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="IsolationForestDetector-29"><a href="#IsolationForestDetector-29"><span class="linenos"> 29</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="n">n_estimators</span>
</span><span id="IsolationForestDetector-30"><a href="#IsolationForestDetector-30"><span class="linenos"> 30</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_samples</span> <span class="o">=</span> <span class="n">max_samples</span>
</span><span id="IsolationForestDetector-31"><a href="#IsolationForestDetector-31"><span class="linenos"> 31</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">contamination</span> <span class="o">=</span> <span class="n">contamination</span>
</span><span id="IsolationForestDetector-32"><a href="#IsolationForestDetector-32"><span class="linenos"> 32</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="IsolationForestDetector-33"><a href="#IsolationForestDetector-33"><span class="linenos"> 33</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">IsolationForest</span><span class="p">(</span>
</span><span id="IsolationForestDetector-34"><a href="#IsolationForestDetector-34"><span class="linenos"> 34</span></a>            <span class="n">n_estimators</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">,</span>
</span><span id="IsolationForestDetector-35"><a href="#IsolationForestDetector-35"><span class="linenos"> 35</span></a>            <span class="n">max_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_samples</span><span class="p">,</span>
</span><span id="IsolationForestDetector-36"><a href="#IsolationForestDetector-36"><span class="linenos"> 36</span></a>            <span class="n">contamination</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">contamination</span><span class="p">,</span>
</span><span id="IsolationForestDetector-37"><a href="#IsolationForestDetector-37"><span class="linenos"> 37</span></a>            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span>
</span><span id="IsolationForestDetector-38"><a href="#IsolationForestDetector-38"><span class="linenos"> 38</span></a>        <span class="p">)</span>
</span><span id="IsolationForestDetector-39"><a href="#IsolationForestDetector-39"><span class="linenos"> 39</span></a>
</span><span id="IsolationForestDetector-40"><a href="#IsolationForestDetector-40"><span class="linenos"> 40</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="IsolationForestDetector-41"><a href="#IsolationForestDetector-41"><span class="linenos"> 41</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector-42"><a href="#IsolationForestDetector-42"><span class="linenos"> 42</span></a><span class="sd">        Fits the Isolation Forest model to the provided data.</span>
</span><span id="IsolationForestDetector-43"><a href="#IsolationForestDetector-43"><span class="linenos"> 43</span></a>
</span><span id="IsolationForestDetector-44"><a href="#IsolationForestDetector-44"><span class="linenos"> 44</span></a><span class="sd">        Args:</span>
</span><span id="IsolationForestDetector-45"><a href="#IsolationForestDetector-45"><span class="linenos"> 45</span></a><span class="sd">        </span>
</span><span id="IsolationForestDetector-46"><a href="#IsolationForestDetector-46"><span class="linenos"> 46</span></a><span class="sd">            - X (array-like or sparse matrix): The input data to fit the model. </span>
</span><span id="IsolationForestDetector-47"><a href="#IsolationForestDetector-47"><span class="linenos"> 47</span></a><span class="sd">                It should be of shape (n_samples, n_features).</span>
</span><span id="IsolationForestDetector-48"><a href="#IsolationForestDetector-48"><span class="linenos"> 48</span></a>
</span><span id="IsolationForestDetector-49"><a href="#IsolationForestDetector-49"><span class="linenos"> 49</span></a><span class="sd">            - y (ignored): Not used, present here for API consistency by convention.</span>
</span><span id="IsolationForestDetector-50"><a href="#IsolationForestDetector-50"><span class="linenos"> 50</span></a>
</span><span id="IsolationForestDetector-51"><a href="#IsolationForestDetector-51"><span class="linenos"> 51</span></a><span class="sd">        Returns:</span>
</span><span id="IsolationForestDetector-52"><a href="#IsolationForestDetector-52"><span class="linenos"> 52</span></a>
</span><span id="IsolationForestDetector-53"><a href="#IsolationForestDetector-53"><span class="linenos"> 53</span></a><span class="sd">            self: Returns the instance of the detector after fitting the model.</span>
</span><span id="IsolationForestDetector-54"><a href="#IsolationForestDetector-54"><span class="linenos"> 54</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector-55"><a href="#IsolationForestDetector-55"><span class="linenos"> 55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="IsolationForestDetector-56"><a href="#IsolationForestDetector-56"><span class="linenos"> 56</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="IsolationForestDetector-57"><a href="#IsolationForestDetector-57"><span class="linenos"> 57</span></a>        
</span><span id="IsolationForestDetector-58"><a href="#IsolationForestDetector-58"><span class="linenos"> 58</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="IsolationForestDetector-59"><a href="#IsolationForestDetector-59"><span class="linenos"> 59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector-60"><a href="#IsolationForestDetector-60"><span class="linenos"> 60</span></a><span class="sd">        Predicts the anomaly labels for the given input data using the Isolation Forest model.</span>
</span><span id="IsolationForestDetector-61"><a href="#IsolationForestDetector-61"><span class="linenos"> 61</span></a>
</span><span id="IsolationForestDetector-62"><a href="#IsolationForestDetector-62"><span class="linenos"> 62</span></a><span class="sd">        Args:</span>
</span><span id="IsolationForestDetector-63"><a href="#IsolationForestDetector-63"><span class="linenos"> 63</span></a>
</span><span id="IsolationForestDetector-64"><a href="#IsolationForestDetector-64"><span class="linenos"> 64</span></a><span class="sd">             X (array-like or sparse matrix): The input data to predict. It should have the same </span>
</span><span id="IsolationForestDetector-65"><a href="#IsolationForestDetector-65"><span class="linenos"> 65</span></a><span class="sd">                                             number of features as the data used for training the model.</span>
</span><span id="IsolationForestDetector-66"><a href="#IsolationForestDetector-66"><span class="linenos"> 66</span></a>
</span><span id="IsolationForestDetector-67"><a href="#IsolationForestDetector-67"><span class="linenos"> 67</span></a><span class="sd">        Returns:</span>
</span><span id="IsolationForestDetector-68"><a href="#IsolationForestDetector-68"><span class="linenos"> 68</span></a>
</span><span id="IsolationForestDetector-69"><a href="#IsolationForestDetector-69"><span class="linenos"> 69</span></a><span class="sd">            array: An array of anomaly labels for each data point in X. The output is -1 for anomalies </span>
</span><span id="IsolationForestDetector-70"><a href="#IsolationForestDetector-70"><span class="linenos"> 70</span></a><span class="sd">                   and 1 for normal points.</span>
</span><span id="IsolationForestDetector-71"><a href="#IsolationForestDetector-71"><span class="linenos"> 71</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector-72"><a href="#IsolationForestDetector-72"><span class="linenos"> 72</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="IsolationForestDetector-73"><a href="#IsolationForestDetector-73"><span class="linenos"> 73</span></a>        
</span><span id="IsolationForestDetector-74"><a href="#IsolationForestDetector-74"><span class="linenos"> 74</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">decision_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="IsolationForestDetector-75"><a href="#IsolationForestDetector-75"><span class="linenos"> 75</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector-76"><a href="#IsolationForestDetector-76"><span class="linenos"> 76</span></a><span class="sd">        Compute the anomaly score for the input data.</span>
</span><span id="IsolationForestDetector-77"><a href="#IsolationForestDetector-77"><span class="linenos"> 77</span></a>
</span><span id="IsolationForestDetector-78"><a href="#IsolationForestDetector-78"><span class="linenos"> 78</span></a><span class="sd">        Args:</span>
</span><span id="IsolationForestDetector-79"><a href="#IsolationForestDetector-79"><span class="linenos"> 79</span></a>
</span><span id="IsolationForestDetector-80"><a href="#IsolationForestDetector-80"><span class="linenos"> 80</span></a><span class="sd">            X (array-like or sparse matrix): The input samples to evaluate.</span>
</span><span id="IsolationForestDetector-81"><a href="#IsolationForestDetector-81"><span class="linenos"> 81</span></a>
</span><span id="IsolationForestDetector-82"><a href="#IsolationForestDetector-82"><span class="linenos"> 82</span></a><span class="sd">        Returns:</span>
</span><span id="IsolationForestDetector-83"><a href="#IsolationForestDetector-83"><span class="linenos"> 83</span></a>
</span><span id="IsolationForestDetector-84"><a href="#IsolationForestDetector-84"><span class="linenos"> 84</span></a><span class="sd">            numpy.ndarray: The anomaly scores for each input sample. Lower scores</span>
</span><span id="IsolationForestDetector-85"><a href="#IsolationForestDetector-85"><span class="linenos"> 85</span></a><span class="sd">            indicate more anomalous samples.</span>
</span><span id="IsolationForestDetector-86"><a href="#IsolationForestDetector-86"><span class="linenos"> 86</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector-87"><a href="#IsolationForestDetector-87"><span class="linenos"> 87</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">decision_function</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="IsolationForestDetector-88"><a href="#IsolationForestDetector-88"><span class="linenos"> 88</span></a>        
</span><span id="IsolationForestDetector-89"><a href="#IsolationForestDetector-89"><span class="linenos"> 89</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="IsolationForestDetector-90"><a href="#IsolationForestDetector-90"><span class="linenos"> 90</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector-91"><a href="#IsolationForestDetector-91"><span class="linenos"> 91</span></a><span class="sd">        Fits the Isolation Forest model to the data and predicts anomalies.</span>
</span><span id="IsolationForestDetector-92"><a href="#IsolationForestDetector-92"><span class="linenos"> 92</span></a>
</span><span id="IsolationForestDetector-93"><a href="#IsolationForestDetector-93"><span class="linenos"> 93</span></a><span class="sd">        Args:</span>
</span><span id="IsolationForestDetector-94"><a href="#IsolationForestDetector-94"><span class="linenos"> 94</span></a>
</span><span id="IsolationForestDetector-95"><a href="#IsolationForestDetector-95"><span class="linenos"> 95</span></a><span class="sd">            - X (array-like or sparse matrix): The input data to fit and predict. </span>
</span><span id="IsolationForestDetector-96"><a href="#IsolationForestDetector-96"><span class="linenos"> 96</span></a><span class="sd">                It should be of shape (n_samples, n_features).</span>
</span><span id="IsolationForestDetector-97"><a href="#IsolationForestDetector-97"><span class="linenos"> 97</span></a>
</span><span id="IsolationForestDetector-98"><a href="#IsolationForestDetector-98"><span class="linenos"> 98</span></a><span class="sd">            - y (ignored): Not used, present for API consistency by convention.</span>
</span><span id="IsolationForestDetector-99"><a href="#IsolationForestDetector-99"><span class="linenos"> 99</span></a>
</span><span id="IsolationForestDetector-100"><a href="#IsolationForestDetector-100"><span class="linenos">100</span></a><span class="sd">        Returns:</span>
</span><span id="IsolationForestDetector-101"><a href="#IsolationForestDetector-101"><span class="linenos">101</span></a>
</span><span id="IsolationForestDetector-102"><a href="#IsolationForestDetector-102"><span class="linenos">102</span></a><span class="sd">            array: The anomaly scores for each sample. </span>
</span><span id="IsolationForestDetector-103"><a href="#IsolationForestDetector-103"><span class="linenos">103</span></a><span class="sd">                -1 indicates an anomaly, and 1 indicates normal data.</span>
</span><span id="IsolationForestDetector-104"><a href="#IsolationForestDetector-104"><span class="linenos">104</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector-105"><a href="#IsolationForestDetector-105"><span class="linenos">105</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="IsolationForestDetector-106"><a href="#IsolationForestDetector-106"><span class="linenos">106</span></a>        
</span><span id="IsolationForestDetector-107"><a href="#IsolationForestDetector-107"><span class="linenos">107</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_anomalies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="IsolationForestDetector-108"><a href="#IsolationForestDetector-108"><span class="linenos">108</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector-109"><a href="#IsolationForestDetector-109"><span class="linenos">109</span></a><span class="sd">        Get the anomalies in the dataset X.</span>
</span><span id="IsolationForestDetector-110"><a href="#IsolationForestDetector-110"><span class="linenos">110</span></a><span class="sd">        </span>
</span><span id="IsolationForestDetector-111"><a href="#IsolationForestDetector-111"><span class="linenos">111</span></a><span class="sd">        Args</span>
</span><span id="IsolationForestDetector-112"><a href="#IsolationForestDetector-112"><span class="linenos">112</span></a><span class="sd">        </span>
</span><span id="IsolationForestDetector-113"><a href="#IsolationForestDetector-113"><span class="linenos">113</span></a><span class="sd">            X : array-like of shape (n_samples, n_features)</span>
</span><span id="IsolationForestDetector-114"><a href="#IsolationForestDetector-114"><span class="linenos">114</span></a><span class="sd">            The input samples.</span>
</span><span id="IsolationForestDetector-115"><a href="#IsolationForestDetector-115"><span class="linenos">115</span></a><span class="sd">            </span>
</span><span id="IsolationForestDetector-116"><a href="#IsolationForestDetector-116"><span class="linenos">116</span></a><span class="sd">        Returns</span>
</span><span id="IsolationForestDetector-117"><a href="#IsolationForestDetector-117"><span class="linenos">117</span></a><span class="sd">        </span>
</span><span id="IsolationForestDetector-118"><a href="#IsolationForestDetector-118"><span class="linenos">118</span></a><span class="sd">            anomalies : array-like of shape (n_anomalies, n_features)</span>
</span><span id="IsolationForestDetector-119"><a href="#IsolationForestDetector-119"><span class="linenos">119</span></a><span class="sd">            The anomalies found in the dataset.</span>
</span><span id="IsolationForestDetector-120"><a href="#IsolationForestDetector-120"><span class="linenos">120</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector-121"><a href="#IsolationForestDetector-121"><span class="linenos">121</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="IsolationForestDetector-122"><a href="#IsolationForestDetector-122"><span class="linenos">122</span></a>        <span class="n">anomalies</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">predictions</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="IsolationForestDetector-123"><a href="#IsolationForestDetector-123"><span class="linenos">123</span></a>        <span class="k">return</span> <span class="n">anomalies</span>
</span><span id="IsolationForestDetector-124"><a href="#IsolationForestDetector-124"><span class="linenos">124</span></a>    
</span><span id="IsolationForestDetector-125"><a href="#IsolationForestDetector-125"><span class="linenos">125</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="IsolationForestDetector-126"><a href="#IsolationForestDetector-126"><span class="linenos">126</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector-127"><a href="#IsolationForestDetector-127"><span class="linenos">127</span></a><span class="sd">        Predict the probability of each sample being an anomaly.</span>
</span><span id="IsolationForestDetector-128"><a href="#IsolationForestDetector-128"><span class="linenos">128</span></a>
</span><span id="IsolationForestDetector-129"><a href="#IsolationForestDetector-129"><span class="linenos">129</span></a><span class="sd">        Args</span>
</span><span id="IsolationForestDetector-130"><a href="#IsolationForestDetector-130"><span class="linenos">130</span></a><span class="sd">        </span>
</span><span id="IsolationForestDetector-131"><a href="#IsolationForestDetector-131"><span class="linenos">131</span></a><span class="sd">            X : array-like of shape (n_samples, n_features)</span>
</span><span id="IsolationForestDetector-132"><a href="#IsolationForestDetector-132"><span class="linenos">132</span></a><span class="sd">                The input samples.</span>
</span><span id="IsolationForestDetector-133"><a href="#IsolationForestDetector-133"><span class="linenos">133</span></a>
</span><span id="IsolationForestDetector-134"><a href="#IsolationForestDetector-134"><span class="linenos">134</span></a><span class="sd">        Returns</span>
</span><span id="IsolationForestDetector-135"><a href="#IsolationForestDetector-135"><span class="linenos">135</span></a><span class="sd">        </span>
</span><span id="IsolationForestDetector-136"><a href="#IsolationForestDetector-136"><span class="linenos">136</span></a><span class="sd">            proba : array-like of shape (n_samples,)</span>
</span><span id="IsolationForestDetector-137"><a href="#IsolationForestDetector-137"><span class="linenos">137</span></a><span class="sd">                The probability of each sample being an anomaly.</span>
</span><span id="IsolationForestDetector-138"><a href="#IsolationForestDetector-138"><span class="linenos">138</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector-139"><a href="#IsolationForestDetector-139"><span class="linenos">139</span></a>        <span class="n">decision_scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">decision_function</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="IsolationForestDetector-140"><a href="#IsolationForestDetector-140"><span class="linenos">140</span></a>        <span class="n">proba</span> <span class="o">=</span> <span class="p">(</span><span class="n">decision_scores</span> <span class="o">-</span> <span class="n">decision_scores</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span><span class="n">decision_scores</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">decision_scores</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</span><span id="IsolationForestDetector-141"><a href="#IsolationForestDetector-141"><span class="linenos">141</span></a>        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">proba</span>
</span></pre></div>


            <div class="docstring"><p>A detector for identifying anomalies using the Isolation Forest algorithm.</p>

<p>Args:</p>

<pre><code>- n_estimators : int, optional (default=100)
    The number of base estimators in the ensemble.

- max_samples : int or float, optional (default='auto')
    The number of samples to draw from X to train each base estimator.
    If 'auto', then max_samples=min(256, n_samples).

- contamination : 'auto' or float, optional (default='auto')
    The amount of contamination of the data set, i.e., the proportion of outliers in the data set.
    Used when fitting to define the threshold on the decision function.
    If 'auto', the threshold is determined as in the original paper.

- random_state : int, RandomState instance or None, optional (default=None)
    Controls the pseudo-randomness of the selection of the feature and split values for each branching step and each tree in the forest.
    Pass an int for reproducible results across multiple function calls..
</code></pre>
</div>


                            <div id="IsolationForestDetector.fit" class="classattr">
                                        <input id="IsolationForestDetector.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="IsolationForestDetector.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IsolationForestDetector.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IsolationForestDetector.fit-40"><a href="#IsolationForestDetector.fit-40"><span class="linenos">40</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="IsolationForestDetector.fit-41"><a href="#IsolationForestDetector.fit-41"><span class="linenos">41</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector.fit-42"><a href="#IsolationForestDetector.fit-42"><span class="linenos">42</span></a><span class="sd">        Fits the Isolation Forest model to the provided data.</span>
</span><span id="IsolationForestDetector.fit-43"><a href="#IsolationForestDetector.fit-43"><span class="linenos">43</span></a>
</span><span id="IsolationForestDetector.fit-44"><a href="#IsolationForestDetector.fit-44"><span class="linenos">44</span></a><span class="sd">        Args:</span>
</span><span id="IsolationForestDetector.fit-45"><a href="#IsolationForestDetector.fit-45"><span class="linenos">45</span></a><span class="sd">        </span>
</span><span id="IsolationForestDetector.fit-46"><a href="#IsolationForestDetector.fit-46"><span class="linenos">46</span></a><span class="sd">            - X (array-like or sparse matrix): The input data to fit the model. </span>
</span><span id="IsolationForestDetector.fit-47"><a href="#IsolationForestDetector.fit-47"><span class="linenos">47</span></a><span class="sd">                It should be of shape (n_samples, n_features).</span>
</span><span id="IsolationForestDetector.fit-48"><a href="#IsolationForestDetector.fit-48"><span class="linenos">48</span></a>
</span><span id="IsolationForestDetector.fit-49"><a href="#IsolationForestDetector.fit-49"><span class="linenos">49</span></a><span class="sd">            - y (ignored): Not used, present here for API consistency by convention.</span>
</span><span id="IsolationForestDetector.fit-50"><a href="#IsolationForestDetector.fit-50"><span class="linenos">50</span></a>
</span><span id="IsolationForestDetector.fit-51"><a href="#IsolationForestDetector.fit-51"><span class="linenos">51</span></a><span class="sd">        Returns:</span>
</span><span id="IsolationForestDetector.fit-52"><a href="#IsolationForestDetector.fit-52"><span class="linenos">52</span></a>
</span><span id="IsolationForestDetector.fit-53"><a href="#IsolationForestDetector.fit-53"><span class="linenos">53</span></a><span class="sd">            self: Returns the instance of the detector after fitting the model.</span>
</span><span id="IsolationForestDetector.fit-54"><a href="#IsolationForestDetector.fit-54"><span class="linenos">54</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector.fit-55"><a href="#IsolationForestDetector.fit-55"><span class="linenos">55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="IsolationForestDetector.fit-56"><a href="#IsolationForestDetector.fit-56"><span class="linenos">56</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fits the Isolation Forest model to the provided data.</p>

<p>Args:</p>

<pre><code>- X (array-like or sparse matrix): The input data to fit the model. 
    It should be of shape (n_samples, n_features).

- y (ignored): Not used, present here for API consistency by convention.
</code></pre>

<p>Returns:</p>

<pre><code>self: Returns the instance of the detector after fitting the model.
</code></pre>
</div>


                            </div>
                            <div id="IsolationForestDetector.predict" class="classattr">
                                        <input id="IsolationForestDetector.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="IsolationForestDetector.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IsolationForestDetector.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IsolationForestDetector.predict-58"><a href="#IsolationForestDetector.predict-58"><span class="linenos">58</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="IsolationForestDetector.predict-59"><a href="#IsolationForestDetector.predict-59"><span class="linenos">59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector.predict-60"><a href="#IsolationForestDetector.predict-60"><span class="linenos">60</span></a><span class="sd">        Predicts the anomaly labels for the given input data using the Isolation Forest model.</span>
</span><span id="IsolationForestDetector.predict-61"><a href="#IsolationForestDetector.predict-61"><span class="linenos">61</span></a>
</span><span id="IsolationForestDetector.predict-62"><a href="#IsolationForestDetector.predict-62"><span class="linenos">62</span></a><span class="sd">        Args:</span>
</span><span id="IsolationForestDetector.predict-63"><a href="#IsolationForestDetector.predict-63"><span class="linenos">63</span></a>
</span><span id="IsolationForestDetector.predict-64"><a href="#IsolationForestDetector.predict-64"><span class="linenos">64</span></a><span class="sd">             X (array-like or sparse matrix): The input data to predict. It should have the same </span>
</span><span id="IsolationForestDetector.predict-65"><a href="#IsolationForestDetector.predict-65"><span class="linenos">65</span></a><span class="sd">                                             number of features as the data used for training the model.</span>
</span><span id="IsolationForestDetector.predict-66"><a href="#IsolationForestDetector.predict-66"><span class="linenos">66</span></a>
</span><span id="IsolationForestDetector.predict-67"><a href="#IsolationForestDetector.predict-67"><span class="linenos">67</span></a><span class="sd">        Returns:</span>
</span><span id="IsolationForestDetector.predict-68"><a href="#IsolationForestDetector.predict-68"><span class="linenos">68</span></a>
</span><span id="IsolationForestDetector.predict-69"><a href="#IsolationForestDetector.predict-69"><span class="linenos">69</span></a><span class="sd">            array: An array of anomaly labels for each data point in X. The output is -1 for anomalies </span>
</span><span id="IsolationForestDetector.predict-70"><a href="#IsolationForestDetector.predict-70"><span class="linenos">70</span></a><span class="sd">                   and 1 for normal points.</span>
</span><span id="IsolationForestDetector.predict-71"><a href="#IsolationForestDetector.predict-71"><span class="linenos">71</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector.predict-72"><a href="#IsolationForestDetector.predict-72"><span class="linenos">72</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predicts the anomaly labels for the given input data using the Isolation Forest model.</p>

<p>Args:</p>

<pre><code> X (array-like or sparse matrix): The input data to predict. It should have the same 
                                 number of features as the data used for training the model.
</code></pre>

<p>Returns:</p>

<pre><code>array: An array of anomaly labels for each data point in X. The output is -1 for anomalies 
       and 1 for normal points.
</code></pre>
</div>


                            </div>
                            <div id="IsolationForestDetector.decision_function" class="classattr">
                                        <input id="IsolationForestDetector.decision_function-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">decision_function</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="IsolationForestDetector.decision_function-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IsolationForestDetector.decision_function"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IsolationForestDetector.decision_function-74"><a href="#IsolationForestDetector.decision_function-74"><span class="linenos">74</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">decision_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="IsolationForestDetector.decision_function-75"><a href="#IsolationForestDetector.decision_function-75"><span class="linenos">75</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector.decision_function-76"><a href="#IsolationForestDetector.decision_function-76"><span class="linenos">76</span></a><span class="sd">        Compute the anomaly score for the input data.</span>
</span><span id="IsolationForestDetector.decision_function-77"><a href="#IsolationForestDetector.decision_function-77"><span class="linenos">77</span></a>
</span><span id="IsolationForestDetector.decision_function-78"><a href="#IsolationForestDetector.decision_function-78"><span class="linenos">78</span></a><span class="sd">        Args:</span>
</span><span id="IsolationForestDetector.decision_function-79"><a href="#IsolationForestDetector.decision_function-79"><span class="linenos">79</span></a>
</span><span id="IsolationForestDetector.decision_function-80"><a href="#IsolationForestDetector.decision_function-80"><span class="linenos">80</span></a><span class="sd">            X (array-like or sparse matrix): The input samples to evaluate.</span>
</span><span id="IsolationForestDetector.decision_function-81"><a href="#IsolationForestDetector.decision_function-81"><span class="linenos">81</span></a>
</span><span id="IsolationForestDetector.decision_function-82"><a href="#IsolationForestDetector.decision_function-82"><span class="linenos">82</span></a><span class="sd">        Returns:</span>
</span><span id="IsolationForestDetector.decision_function-83"><a href="#IsolationForestDetector.decision_function-83"><span class="linenos">83</span></a>
</span><span id="IsolationForestDetector.decision_function-84"><a href="#IsolationForestDetector.decision_function-84"><span class="linenos">84</span></a><span class="sd">            numpy.ndarray: The anomaly scores for each input sample. Lower scores</span>
</span><span id="IsolationForestDetector.decision_function-85"><a href="#IsolationForestDetector.decision_function-85"><span class="linenos">85</span></a><span class="sd">            indicate more anomalous samples.</span>
</span><span id="IsolationForestDetector.decision_function-86"><a href="#IsolationForestDetector.decision_function-86"><span class="linenos">86</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector.decision_function-87"><a href="#IsolationForestDetector.decision_function-87"><span class="linenos">87</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">decision_function</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Compute the anomaly score for the input data.</p>

<p>Args:</p>

<pre><code>X (array-like or sparse matrix): The input samples to evaluate.
</code></pre>

<p>Returns:</p>

<pre><code>numpy.ndarray: The anomaly scores for each input sample. Lower scores
indicate more anomalous samples.
</code></pre>
</div>


                            </div>
                            <div id="IsolationForestDetector.fit_predict" class="classattr">
                                        <input id="IsolationForestDetector.fit_predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit_predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="IsolationForestDetector.fit_predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IsolationForestDetector.fit_predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IsolationForestDetector.fit_predict-89"><a href="#IsolationForestDetector.fit_predict-89"><span class="linenos"> 89</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="IsolationForestDetector.fit_predict-90"><a href="#IsolationForestDetector.fit_predict-90"><span class="linenos"> 90</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector.fit_predict-91"><a href="#IsolationForestDetector.fit_predict-91"><span class="linenos"> 91</span></a><span class="sd">        Fits the Isolation Forest model to the data and predicts anomalies.</span>
</span><span id="IsolationForestDetector.fit_predict-92"><a href="#IsolationForestDetector.fit_predict-92"><span class="linenos"> 92</span></a>
</span><span id="IsolationForestDetector.fit_predict-93"><a href="#IsolationForestDetector.fit_predict-93"><span class="linenos"> 93</span></a><span class="sd">        Args:</span>
</span><span id="IsolationForestDetector.fit_predict-94"><a href="#IsolationForestDetector.fit_predict-94"><span class="linenos"> 94</span></a>
</span><span id="IsolationForestDetector.fit_predict-95"><a href="#IsolationForestDetector.fit_predict-95"><span class="linenos"> 95</span></a><span class="sd">            - X (array-like or sparse matrix): The input data to fit and predict. </span>
</span><span id="IsolationForestDetector.fit_predict-96"><a href="#IsolationForestDetector.fit_predict-96"><span class="linenos"> 96</span></a><span class="sd">                It should be of shape (n_samples, n_features).</span>
</span><span id="IsolationForestDetector.fit_predict-97"><a href="#IsolationForestDetector.fit_predict-97"><span class="linenos"> 97</span></a>
</span><span id="IsolationForestDetector.fit_predict-98"><a href="#IsolationForestDetector.fit_predict-98"><span class="linenos"> 98</span></a><span class="sd">            - y (ignored): Not used, present for API consistency by convention.</span>
</span><span id="IsolationForestDetector.fit_predict-99"><a href="#IsolationForestDetector.fit_predict-99"><span class="linenos"> 99</span></a>
</span><span id="IsolationForestDetector.fit_predict-100"><a href="#IsolationForestDetector.fit_predict-100"><span class="linenos">100</span></a><span class="sd">        Returns:</span>
</span><span id="IsolationForestDetector.fit_predict-101"><a href="#IsolationForestDetector.fit_predict-101"><span class="linenos">101</span></a>
</span><span id="IsolationForestDetector.fit_predict-102"><a href="#IsolationForestDetector.fit_predict-102"><span class="linenos">102</span></a><span class="sd">            array: The anomaly scores for each sample. </span>
</span><span id="IsolationForestDetector.fit_predict-103"><a href="#IsolationForestDetector.fit_predict-103"><span class="linenos">103</span></a><span class="sd">                -1 indicates an anomaly, and 1 indicates normal data.</span>
</span><span id="IsolationForestDetector.fit_predict-104"><a href="#IsolationForestDetector.fit_predict-104"><span class="linenos">104</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector.fit_predict-105"><a href="#IsolationForestDetector.fit_predict-105"><span class="linenos">105</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Fits the Isolation Forest model to the data and predicts anomalies.</p>

<p>Args:</p>

<pre><code>- X (array-like or sparse matrix): The input data to fit and predict. 
    It should be of shape (n_samples, n_features).

- y (ignored): Not used, present for API consistency by convention.
</code></pre>

<p>Returns:</p>

<pre><code>array: The anomaly scores for each sample. 
    -1 indicates an anomaly, and 1 indicates normal data.
</code></pre>
</div>


                            </div>
                            <div id="IsolationForestDetector.get_anomalies" class="classattr">
                                        <input id="IsolationForestDetector.get_anomalies-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_anomalies</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="IsolationForestDetector.get_anomalies-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IsolationForestDetector.get_anomalies"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IsolationForestDetector.get_anomalies-107"><a href="#IsolationForestDetector.get_anomalies-107"><span class="linenos">107</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_anomalies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="IsolationForestDetector.get_anomalies-108"><a href="#IsolationForestDetector.get_anomalies-108"><span class="linenos">108</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector.get_anomalies-109"><a href="#IsolationForestDetector.get_anomalies-109"><span class="linenos">109</span></a><span class="sd">        Get the anomalies in the dataset X.</span>
</span><span id="IsolationForestDetector.get_anomalies-110"><a href="#IsolationForestDetector.get_anomalies-110"><span class="linenos">110</span></a><span class="sd">        </span>
</span><span id="IsolationForestDetector.get_anomalies-111"><a href="#IsolationForestDetector.get_anomalies-111"><span class="linenos">111</span></a><span class="sd">        Args</span>
</span><span id="IsolationForestDetector.get_anomalies-112"><a href="#IsolationForestDetector.get_anomalies-112"><span class="linenos">112</span></a><span class="sd">        </span>
</span><span id="IsolationForestDetector.get_anomalies-113"><a href="#IsolationForestDetector.get_anomalies-113"><span class="linenos">113</span></a><span class="sd">            X : array-like of shape (n_samples, n_features)</span>
</span><span id="IsolationForestDetector.get_anomalies-114"><a href="#IsolationForestDetector.get_anomalies-114"><span class="linenos">114</span></a><span class="sd">            The input samples.</span>
</span><span id="IsolationForestDetector.get_anomalies-115"><a href="#IsolationForestDetector.get_anomalies-115"><span class="linenos">115</span></a><span class="sd">            </span>
</span><span id="IsolationForestDetector.get_anomalies-116"><a href="#IsolationForestDetector.get_anomalies-116"><span class="linenos">116</span></a><span class="sd">        Returns</span>
</span><span id="IsolationForestDetector.get_anomalies-117"><a href="#IsolationForestDetector.get_anomalies-117"><span class="linenos">117</span></a><span class="sd">        </span>
</span><span id="IsolationForestDetector.get_anomalies-118"><a href="#IsolationForestDetector.get_anomalies-118"><span class="linenos">118</span></a><span class="sd">            anomalies : array-like of shape (n_anomalies, n_features)</span>
</span><span id="IsolationForestDetector.get_anomalies-119"><a href="#IsolationForestDetector.get_anomalies-119"><span class="linenos">119</span></a><span class="sd">            The anomalies found in the dataset.</span>
</span><span id="IsolationForestDetector.get_anomalies-120"><a href="#IsolationForestDetector.get_anomalies-120"><span class="linenos">120</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector.get_anomalies-121"><a href="#IsolationForestDetector.get_anomalies-121"><span class="linenos">121</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="IsolationForestDetector.get_anomalies-122"><a href="#IsolationForestDetector.get_anomalies-122"><span class="linenos">122</span></a>        <span class="n">anomalies</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">predictions</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="IsolationForestDetector.get_anomalies-123"><a href="#IsolationForestDetector.get_anomalies-123"><span class="linenos">123</span></a>        <span class="k">return</span> <span class="n">anomalies</span>
</span></pre></div>


            <div class="docstring"><p>Get the anomalies in the dataset X.</p>

<p>Args</p>

<pre><code>X : array-like of shape (n_samples, n_features)
The input samples.
</code></pre>

<p>Returns</p>

<pre><code>anomalies : array-like of shape (n_anomalies, n_features)
The anomalies found in the dataset.
</code></pre>
</div>


                            </div>
                            <div id="IsolationForestDetector.predict_proba" class="classattr">
                                        <input id="IsolationForestDetector.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="IsolationForestDetector.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IsolationForestDetector.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IsolationForestDetector.predict_proba-125"><a href="#IsolationForestDetector.predict_proba-125"><span class="linenos">125</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="IsolationForestDetector.predict_proba-126"><a href="#IsolationForestDetector.predict_proba-126"><span class="linenos">126</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector.predict_proba-127"><a href="#IsolationForestDetector.predict_proba-127"><span class="linenos">127</span></a><span class="sd">        Predict the probability of each sample being an anomaly.</span>
</span><span id="IsolationForestDetector.predict_proba-128"><a href="#IsolationForestDetector.predict_proba-128"><span class="linenos">128</span></a>
</span><span id="IsolationForestDetector.predict_proba-129"><a href="#IsolationForestDetector.predict_proba-129"><span class="linenos">129</span></a><span class="sd">        Args</span>
</span><span id="IsolationForestDetector.predict_proba-130"><a href="#IsolationForestDetector.predict_proba-130"><span class="linenos">130</span></a><span class="sd">        </span>
</span><span id="IsolationForestDetector.predict_proba-131"><a href="#IsolationForestDetector.predict_proba-131"><span class="linenos">131</span></a><span class="sd">            X : array-like of shape (n_samples, n_features)</span>
</span><span id="IsolationForestDetector.predict_proba-132"><a href="#IsolationForestDetector.predict_proba-132"><span class="linenos">132</span></a><span class="sd">                The input samples.</span>
</span><span id="IsolationForestDetector.predict_proba-133"><a href="#IsolationForestDetector.predict_proba-133"><span class="linenos">133</span></a>
</span><span id="IsolationForestDetector.predict_proba-134"><a href="#IsolationForestDetector.predict_proba-134"><span class="linenos">134</span></a><span class="sd">        Returns</span>
</span><span id="IsolationForestDetector.predict_proba-135"><a href="#IsolationForestDetector.predict_proba-135"><span class="linenos">135</span></a><span class="sd">        </span>
</span><span id="IsolationForestDetector.predict_proba-136"><a href="#IsolationForestDetector.predict_proba-136"><span class="linenos">136</span></a><span class="sd">            proba : array-like of shape (n_samples,)</span>
</span><span id="IsolationForestDetector.predict_proba-137"><a href="#IsolationForestDetector.predict_proba-137"><span class="linenos">137</span></a><span class="sd">                The probability of each sample being an anomaly.</span>
</span><span id="IsolationForestDetector.predict_proba-138"><a href="#IsolationForestDetector.predict_proba-138"><span class="linenos">138</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="IsolationForestDetector.predict_proba-139"><a href="#IsolationForestDetector.predict_proba-139"><span class="linenos">139</span></a>        <span class="n">decision_scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">decision_function</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="IsolationForestDetector.predict_proba-140"><a href="#IsolationForestDetector.predict_proba-140"><span class="linenos">140</span></a>        <span class="n">proba</span> <span class="o">=</span> <span class="p">(</span><span class="n">decision_scores</span> <span class="o">-</span> <span class="n">decision_scores</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span><span class="n">decision_scores</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">decision_scores</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</span><span id="IsolationForestDetector.predict_proba-141"><a href="#IsolationForestDetector.predict_proba-141"><span class="linenos">141</span></a>        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">proba</span>
</span></pre></div>


            <div class="docstring"><p>Predict the probability of each sample being an anomaly.</p>

<p>Args</p>

<pre><code>X : array-like of shape (n_samples, n_features)
    The input samples.
</code></pre>

<p>Returns</p>

<pre><code>proba : array-like of shape (n_samples,)
    The probability of each sample being an anomaly.
</code></pre>
</div>


                            </div>
                </section>
                <section id="RRCFDetector">
                            <input id="RRCFDetector-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">RRCFDetector</span><wbr>(<span class="base">sklearn.base.BaseEstimator</span>):

                <label class="view-source-button" for="RRCFDetector-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RRCFDetector"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RRCFDetector-9"><a href="#RRCFDetector-9"><span class="linenos">  9</span></a><span class="k">class</span><span class="w"> </span><span class="nc">RRCFDetector</span><span class="p">(</span><span class="n">BaseEstimator</span><span class="p">):</span>
</span><span id="RRCFDetector-10"><a href="#RRCFDetector-10"><span class="linenos"> 10</span></a>
</span><span id="RRCFDetector-11"><a href="#RRCFDetector-11"><span class="linenos"> 11</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;    RRCFDetector: Robust Random Cut Forest anomaly detector.</span>
</span><span id="RRCFDetector-12"><a href="#RRCFDetector-12"><span class="linenos"> 12</span></a>
</span><span id="RRCFDetector-13"><a href="#RRCFDetector-13"><span class="linenos"> 13</span></a><span class="sd">    This class implements anomaly detection using the Robust Random Cut Forest </span>
</span><span id="RRCFDetector-14"><a href="#RRCFDetector-14"><span class="linenos"> 14</span></a><span class="sd">    algorithm for streaming anomaly detection.</span>
</span><span id="RRCFDetector-15"><a href="#RRCFDetector-15"><span class="linenos"> 15</span></a>
</span><span id="RRCFDetector-16"><a href="#RRCFDetector-16"><span class="linenos"> 16</span></a><span class="sd">    Args:</span>
</span><span id="RRCFDetector-17"><a href="#RRCFDetector-17"><span class="linenos"> 17</span></a>
</span><span id="RRCFDetector-18"><a href="#RRCFDetector-18"><span class="linenos"> 18</span></a><span class="sd">        - shingle_size: Size of the shingling window.</span>
</span><span id="RRCFDetector-19"><a href="#RRCFDetector-19"><span class="linenos"> 19</span></a>
</span><span id="RRCFDetector-20"><a href="#RRCFDetector-20"><span class="linenos"> 20</span></a><span class="sd">        - num_trees: Number of trees in the random forest.</span>
</span><span id="RRCFDetector-21"><a href="#RRCFDetector-21"><span class="linenos"> 21</span></a>
</span><span id="RRCFDetector-22"><a href="#RRCFDetector-22"><span class="linenos"> 22</span></a><span class="sd">        - tree_size: Maximum size of each tree in the forest.</span>
</span><span id="RRCFDetector-23"><a href="#RRCFDetector-23"><span class="linenos"> 23</span></a>
</span><span id="RRCFDetector-24"><a href="#RRCFDetector-24"><span class="linenos"> 24</span></a><span class="sd">    </span>
</span><span id="RRCFDetector-25"><a href="#RRCFDetector-25"><span class="linenos"> 25</span></a><span class="sd">    Attributes:</span>
</span><span id="RRCFDetector-26"><a href="#RRCFDetector-26"><span class="linenos"> 26</span></a>
</span><span id="RRCFDetector-27"><a href="#RRCFDetector-27"><span class="linenos"> 27</span></a><span class="sd">        - shingle_size : int</span>
</span><span id="RRCFDetector-28"><a href="#RRCFDetector-28"><span class="linenos"> 28</span></a><span class="sd">            Size of the shingling window.</span>
</span><span id="RRCFDetector-29"><a href="#RRCFDetector-29"><span class="linenos"> 29</span></a>
</span><span id="RRCFDetector-30"><a href="#RRCFDetector-30"><span class="linenos"> 30</span></a><span class="sd">        - num_trees : int</span>
</span><span id="RRCFDetector-31"><a href="#RRCFDetector-31"><span class="linenos"> 31</span></a><span class="sd">            Number of trees in the random forest.</span>
</span><span id="RRCFDetector-32"><a href="#RRCFDetector-32"><span class="linenos"> 32</span></a>
</span><span id="RRCFDetector-33"><a href="#RRCFDetector-33"><span class="linenos"> 33</span></a><span class="sd">        - tree_size : int</span>
</span><span id="RRCFDetector-34"><a href="#RRCFDetector-34"><span class="linenos"> 34</span></a><span class="sd">            Maximum size of each tree in the forest.</span>
</span><span id="RRCFDetector-35"><a href="#RRCFDetector-35"><span class="linenos"> 35</span></a>
</span><span id="RRCFDetector-36"><a href="#RRCFDetector-36"><span class="linenos"> 36</span></a><span class="sd">        - forest : list</span>
</span><span id="RRCFDetector-37"><a href="#RRCFDetector-37"><span class="linenos"> 37</span></a><span class="sd">            List of RCTree objects representing the forest.</span>
</span><span id="RRCFDetector-38"><a href="#RRCFDetector-38"><span class="linenos"> 38</span></a>
</span><span id="RRCFDetector-39"><a href="#RRCFDetector-39"><span class="linenos"> 39</span></a><span class="sd">        - index : None or int</span>
</span><span id="RRCFDetector-40"><a href="#RRCFDetector-40"><span class="linenos"> 40</span></a><span class="sd">            Index used for tracking data points (if applicable).</span>
</span><span id="RRCFDetector-41"><a href="#RRCFDetector-41"><span class="linenos"> 41</span></a>
</span><span id="RRCFDetector-42"><a href="#RRCFDetector-42"><span class="linenos"> 42</span></a><span class="sd">        - anomaly_scores : None or pd.Series</span>
</span><span id="RRCFDetector-43"><a href="#RRCFDetector-43"><span class="linenos"> 43</span></a><span class="sd">            Series containing anomaly scores for the input data.</span>
</span><span id="RRCFDetector-44"><a href="#RRCFDetector-44"><span class="linenos"> 44</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="RRCFDetector-45"><a href="#RRCFDetector-45"><span class="linenos"> 45</span></a>
</span><span id="RRCFDetector-46"><a href="#RRCFDetector-46"><span class="linenos"> 46</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shingle_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">num_trees</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">tree_size</span><span class="o">=</span><span class="mi">500</span><span class="p">):</span>
</span><span id="RRCFDetector-47"><a href="#RRCFDetector-47"><span class="linenos"> 47</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shingle_size</span> <span class="o">=</span> <span class="n">shingle_size</span>
</span><span id="RRCFDetector-48"><a href="#RRCFDetector-48"><span class="linenos"> 48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">num_trees</span> <span class="o">=</span> <span class="n">num_trees</span>
</span><span id="RRCFDetector-49"><a href="#RRCFDetector-49"><span class="linenos"> 49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tree_size</span> <span class="o">=</span> <span class="n">tree_size</span>
</span><span id="RRCFDetector-50"><a href="#RRCFDetector-50"><span class="linenos"> 50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">forest</span> <span class="o">=</span> <span class="p">[</span><span class="n">rrcf</span><span class="o">.</span><span class="n">RCTree</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_trees</span><span class="p">)]</span>
</span><span id="RRCFDetector-51"><a href="#RRCFDetector-51"><span class="linenos"> 51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="RRCFDetector-52"><a href="#RRCFDetector-52"><span class="linenos"> 52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_scores</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="RRCFDetector-53"><a href="#RRCFDetector-53"><span class="linenos"> 53</span></a>
</span><span id="RRCFDetector-54"><a href="#RRCFDetector-54"><span class="linenos"> 54</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="RRCFDetector-55"><a href="#RRCFDetector-55"><span class="linenos"> 55</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit the model to the input data.</span>
</span><span id="RRCFDetector-56"><a href="#RRCFDetector-56"><span class="linenos"> 56</span></a>
</span><span id="RRCFDetector-57"><a href="#RRCFDetector-57"><span class="linenos"> 57</span></a><span class="sd">        Args</span>
</span><span id="RRCFDetector-58"><a href="#RRCFDetector-58"><span class="linenos"> 58</span></a><span class="sd">        </span>
</span><span id="RRCFDetector-59"><a href="#RRCFDetector-59"><span class="linenos"> 59</span></a><span class="sd">            X : array-like of shape (n_samples,)</span>
</span><span id="RRCFDetector-60"><a href="#RRCFDetector-60"><span class="linenos"> 60</span></a><span class="sd">                Input time series data.</span>
</span><span id="RRCFDetector-61"><a href="#RRCFDetector-61"><span class="linenos"> 61</span></a>
</span><span id="RRCFDetector-62"><a href="#RRCFDetector-62"><span class="linenos"> 62</span></a><span class="sd">        Returns</span>
</span><span id="RRCFDetector-63"><a href="#RRCFDetector-63"><span class="linenos"> 63</span></a><span class="sd">        </span>
</span><span id="RRCFDetector-64"><a href="#RRCFDetector-64"><span class="linenos"> 64</span></a><span class="sd">            self : object</span>
</span><span id="RRCFDetector-65"><a href="#RRCFDetector-65"><span class="linenos"> 65</span></a><span class="sd">                Returns self.</span>
</span><span id="RRCFDetector-66"><a href="#RRCFDetector-66"><span class="linenos"> 66</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RRCFDetector-67"><a href="#RRCFDetector-67"><span class="linenos"> 67</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="RRCFDetector-68"><a href="#RRCFDetector-68"><span class="linenos"> 68</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span><span id="RRCFDetector-69"><a href="#RRCFDetector-69"><span class="linenos"> 69</span></a>        
</span><span id="RRCFDetector-70"><a href="#RRCFDetector-70"><span class="linenos"> 70</span></a>        <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">forest</span><span class="p">:</span>
</span><span id="RRCFDetector-71"><a href="#RRCFDetector-71"><span class="linenos"> 71</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="RRCFDetector-72"><a href="#RRCFDetector-72"><span class="linenos"> 72</span></a>                <span class="n">point</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="RRCFDetector-73"><a href="#RRCFDetector-73"><span class="linenos"> 73</span></a>                <span class="n">unique_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">tree</span><span class="p">))</span>
</span><span id="RRCFDetector-74"><a href="#RRCFDetector-74"><span class="linenos"> 74</span></a>                <span class="n">tree</span><span class="o">.</span><span class="n">insert_point</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">unique_index</span><span class="p">)</span>
</span><span id="RRCFDetector-75"><a href="#RRCFDetector-75"><span class="linenos"> 75</span></a>                
</span><span id="RRCFDetector-76"><a href="#RRCFDetector-76"><span class="linenos"> 76</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">leaves</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree_size</span><span class="p">:</span>
</span><span id="RRCFDetector-77"><a href="#RRCFDetector-77"><span class="linenos"> 77</span></a>                    <span class="n">old_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree_size</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">tree</span><span class="p">))</span>
</span><span id="RRCFDetector-78"><a href="#RRCFDetector-78"><span class="linenos"> 78</span></a>                    <span class="k">if</span> <span class="n">old_index</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">leaves</span><span class="p">:</span>
</span><span id="RRCFDetector-79"><a href="#RRCFDetector-79"><span class="linenos"> 79</span></a>                        <span class="n">tree</span><span class="o">.</span><span class="n">forget_point</span><span class="p">(</span><span class="n">old_index</span><span class="p">)</span>
</span><span id="RRCFDetector-80"><a href="#RRCFDetector-80"><span class="linenos"> 80</span></a>        
</span><span id="RRCFDetector-81"><a href="#RRCFDetector-81"><span class="linenos"> 81</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="RRCFDetector-82"><a href="#RRCFDetector-82"><span class="linenos"> 82</span></a>
</span><span id="RRCFDetector-83"><a href="#RRCFDetector-83"><span class="linenos"> 83</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="RRCFDetector-84"><a href="#RRCFDetector-84"><span class="linenos"> 84</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate anomaly scores for input data.</span>
</span><span id="RRCFDetector-85"><a href="#RRCFDetector-85"><span class="linenos"> 85</span></a>
</span><span id="RRCFDetector-86"><a href="#RRCFDetector-86"><span class="linenos"> 86</span></a><span class="sd">        Args</span>
</span><span id="RRCFDetector-87"><a href="#RRCFDetector-87"><span class="linenos"> 87</span></a><span class="sd">        </span>
</span><span id="RRCFDetector-88"><a href="#RRCFDetector-88"><span class="linenos"> 88</span></a><span class="sd">            X : array-like of shape (n_samples,)</span>
</span><span id="RRCFDetector-89"><a href="#RRCFDetector-89"><span class="linenos"> 89</span></a><span class="sd">                Input time series data.</span>
</span><span id="RRCFDetector-90"><a href="#RRCFDetector-90"><span class="linenos"> 90</span></a>
</span><span id="RRCFDetector-91"><a href="#RRCFDetector-91"><span class="linenos"> 91</span></a><span class="sd">        Returns</span>
</span><span id="RRCFDetector-92"><a href="#RRCFDetector-92"><span class="linenos"> 92</span></a><span class="sd">        </span>
</span><span id="RRCFDetector-93"><a href="#RRCFDetector-93"><span class="linenos"> 93</span></a><span class="sd">            scores : ndarray of shape (n_samples,)</span>
</span><span id="RRCFDetector-94"><a href="#RRCFDetector-94"><span class="linenos"> 94</span></a><span class="sd">                Anomaly scores for each input sample.</span>
</span><span id="RRCFDetector-95"><a href="#RRCFDetector-95"><span class="linenos"> 95</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RRCFDetector-96"><a href="#RRCFDetector-96"><span class="linenos"> 96</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</span><span id="RRCFDetector-97"><a href="#RRCFDetector-97"><span class="linenos"> 97</span></a>        
</span><span id="RRCFDetector-98"><a href="#RRCFDetector-98"><span class="linenos"> 98</span></a>        <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">forest</span><span class="p">:</span>
</span><span id="RRCFDetector-99"><a href="#RRCFDetector-99"><span class="linenos"> 99</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
</span><span id="RRCFDetector-100"><a href="#RRCFDetector-100"><span class="linenos">100</span></a>                <span class="n">point</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="RRCFDetector-101"><a href="#RRCFDetector-101"><span class="linenos">101</span></a>                <span class="n">unique_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">tree</span><span class="p">))</span>
</span><span id="RRCFDetector-102"><a href="#RRCFDetector-102"><span class="linenos">102</span></a>                
</span><span id="RRCFDetector-103"><a href="#RRCFDetector-103"><span class="linenos">103</span></a>                <span class="k">if</span> <span class="n">unique_index</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">leaves</span><span class="p">:</span>
</span><span id="RRCFDetector-104"><a href="#RRCFDetector-104"><span class="linenos">104</span></a>                    <span class="n">leaf</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">leaves</span><span class="p">[</span><span class="n">unique_index</span><span class="p">]</span>
</span><span id="RRCFDetector-105"><a href="#RRCFDetector-105"><span class="linenos">105</span></a>                    <span class="n">score</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">codisp</span><span class="p">(</span><span class="n">leaf</span><span class="p">)</span>
</span><span id="RRCFDetector-106"><a href="#RRCFDetector-106"><span class="linenos">106</span></a>                    <span class="n">scores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">score</span>
</span><span id="RRCFDetector-107"><a href="#RRCFDetector-107"><span class="linenos">107</span></a>        
</span><span id="RRCFDetector-108"><a href="#RRCFDetector-108"><span class="linenos">108</span></a>        <span class="k">return</span> <span class="n">scores</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_trees</span>  <span class="c1"># Normalize by number of trees</span>
</span><span id="RRCFDetector-109"><a href="#RRCFDetector-109"><span class="linenos">109</span></a>
</span><span id="RRCFDetector-110"><a href="#RRCFDetector-110"><span class="linenos">110</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="RRCFDetector-111"><a href="#RRCFDetector-111"><span class="linenos">111</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit the model and calculate anomaly scores.</span>
</span><span id="RRCFDetector-112"><a href="#RRCFDetector-112"><span class="linenos">112</span></a>
</span><span id="RRCFDetector-113"><a href="#RRCFDetector-113"><span class="linenos">113</span></a><span class="sd">        Args</span>
</span><span id="RRCFDetector-114"><a href="#RRCFDetector-114"><span class="linenos">114</span></a><span class="sd">        </span>
</span><span id="RRCFDetector-115"><a href="#RRCFDetector-115"><span class="linenos">115</span></a><span class="sd">            X : array-like of shape (n_samples,)</span>
</span><span id="RRCFDetector-116"><a href="#RRCFDetector-116"><span class="linenos">116</span></a><span class="sd">                Input time series data.</span>
</span><span id="RRCFDetector-117"><a href="#RRCFDetector-117"><span class="linenos">117</span></a>
</span><span id="RRCFDetector-118"><a href="#RRCFDetector-118"><span class="linenos">118</span></a><span class="sd">        Returns</span>
</span><span id="RRCFDetector-119"><a href="#RRCFDetector-119"><span class="linenos">119</span></a><span class="sd">        </span>
</span><span id="RRCFDetector-120"><a href="#RRCFDetector-120"><span class="linenos">120</span></a><span class="sd">            anomaly_scores : Series of shape (n_samples,)</span>
</span><span id="RRCFDetector-121"><a href="#RRCFDetector-121"><span class="linenos">121</span></a><span class="sd">                Anomaly scores for each input sample.</span>
</span><span id="RRCFDetector-122"><a href="#RRCFDetector-122"><span class="linenos">122</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RRCFDetector-123"><a href="#RRCFDetector-123"><span class="linenos">123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="RRCFDetector-124"><a href="#RRCFDetector-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)))</span>
</span><span id="RRCFDetector-125"><a href="#RRCFDetector-125"><span class="linenos">125</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_scores</span>
</span><span id="RRCFDetector-126"><a href="#RRCFDetector-126"><span class="linenos">126</span></a>
</span><span id="RRCFDetector-127"><a href="#RRCFDetector-127"><span class="linenos">127</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_anomalies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
</span><span id="RRCFDetector-128"><a href="#RRCFDetector-128"><span class="linenos">128</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Identify anomalies based on a threshold.</span>
</span><span id="RRCFDetector-129"><a href="#RRCFDetector-129"><span class="linenos">129</span></a>
</span><span id="RRCFDetector-130"><a href="#RRCFDetector-130"><span class="linenos">130</span></a><span class="sd">        Args</span>
</span><span id="RRCFDetector-131"><a href="#RRCFDetector-131"><span class="linenos">131</span></a><span class="sd">        </span>
</span><span id="RRCFDetector-132"><a href="#RRCFDetector-132"><span class="linenos">132</span></a><span class="sd">            threshold : float</span>
</span><span id="RRCFDetector-133"><a href="#RRCFDetector-133"><span class="linenos">133</span></a><span class="sd">                Threshold value for anomaly detection.</span>
</span><span id="RRCFDetector-134"><a href="#RRCFDetector-134"><span class="linenos">134</span></a>
</span><span id="RRCFDetector-135"><a href="#RRCFDetector-135"><span class="linenos">135</span></a><span class="sd">        Returns</span>
</span><span id="RRCFDetector-136"><a href="#RRCFDetector-136"><span class="linenos">136</span></a><span class="sd">        </span>
</span><span id="RRCFDetector-137"><a href="#RRCFDetector-137"><span class="linenos">137</span></a><span class="sd">            anomalies : Series</span>
</span><span id="RRCFDetector-138"><a href="#RRCFDetector-138"><span class="linenos">138</span></a><span class="sd">                Series containing anomaly scores above the threshold.</span>
</span><span id="RRCFDetector-139"><a href="#RRCFDetector-139"><span class="linenos">139</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RRCFDetector-140"><a href="#RRCFDetector-140"><span class="linenos">140</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_scores</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="RRCFDetector-141"><a href="#RRCFDetector-141"><span class="linenos">141</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Model must be fit before getting anomalies.&quot;</span><span class="p">)</span>
</span><span id="RRCFDetector-142"><a href="#RRCFDetector-142"><span class="linenos">142</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">anomaly_scores</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">]</span>
</span><span id="RRCFDetector-143"><a href="#RRCFDetector-143"><span class="linenos">143</span></a>
</span><span id="RRCFDetector-144"><a href="#RRCFDetector-144"><span class="linenos">144</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="RRCFDetector-145"><a href="#RRCFDetector-145"><span class="linenos">145</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate normalized probability-like anomaly scores.</span>
</span><span id="RRCFDetector-146"><a href="#RRCFDetector-146"><span class="linenos">146</span></a>
</span><span id="RRCFDetector-147"><a href="#RRCFDetector-147"><span class="linenos">147</span></a><span class="sd">        Args</span>
</span><span id="RRCFDetector-148"><a href="#RRCFDetector-148"><span class="linenos">148</span></a><span class="sd">        </span>
</span><span id="RRCFDetector-149"><a href="#RRCFDetector-149"><span class="linenos">149</span></a><span class="sd">            X : array-like of shape (n_samples,)</span>
</span><span id="RRCFDetector-150"><a href="#RRCFDetector-150"><span class="linenos">150</span></a><span class="sd">                Input time series data.</span>
</span><span id="RRCFDetector-151"><a href="#RRCFDetector-151"><span class="linenos">151</span></a>
</span><span id="RRCFDetector-152"><a href="#RRCFDetector-152"><span class="linenos">152</span></a><span class="sd">        Returns</span>
</span><span id="RRCFDetector-153"><a href="#RRCFDetector-153"><span class="linenos">153</span></a><span class="sd">        </span>
</span><span id="RRCFDetector-154"><a href="#RRCFDetector-154"><span class="linenos">154</span></a><span class="sd">            proba : ndarray of shape (n_samples,)</span>
</span><span id="RRCFDetector-155"><a href="#RRCFDetector-155"><span class="linenos">155</span></a><span class="sd">                Normalized anomaly scores.</span>
</span><span id="RRCFDetector-156"><a href="#RRCFDetector-156"><span class="linenos">156</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RRCFDetector-157"><a href="#RRCFDetector-157"><span class="linenos">157</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="RRCFDetector-158"><a href="#RRCFDetector-158"><span class="linenos">158</span></a>        <span class="n">max_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span><span id="RRCFDetector-159"><a href="#RRCFDetector-159"><span class="linenos">159</span></a>        
</span><span id="RRCFDetector-160"><a href="#RRCFDetector-160"><span class="linenos">160</span></a>        <span class="c1"># Avoid division by zero</span>
</span><span id="RRCFDetector-161"><a href="#RRCFDetector-161"><span class="linenos">161</span></a>        <span class="k">if</span> <span class="n">max_score</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="RRCFDetector-162"><a href="#RRCFDetector-162"><span class="linenos">162</span></a>            <span class="k">return</span> <span class="n">scores</span> <span class="o">/</span> <span class="n">max_score</span>
</span><span id="RRCFDetector-163"><a href="#RRCFDetector-163"><span class="linenos">163</span></a>        <span class="k">return</span> <span class="n">scores</span>
</span></pre></div>


            <div class="docstring"><p>RRCFDetector: Robust Random Cut Forest anomaly detector.</p>

<p>This class implements anomaly detection using the Robust Random Cut Forest 
algorithm for streaming anomaly detection.</p>

<p>Args:</p>

<pre><code>- shingle_size: Size of the shingling window.

- num_trees: Number of trees in the random forest.

- tree_size: Maximum size of each tree in the forest.
</code></pre>

<p>Attributes:</p>

<pre><code>- shingle_size : int
    Size of the shingling window.

- num_trees : int
    Number of trees in the random forest.

- tree_size : int
    Maximum size of each tree in the forest.

- forest : list
    List of RCTree objects representing the forest.

- index : None or int
    Index used for tracking data points (if applicable).

- anomaly_scores : None or pd.Series
    Series containing anomaly scores for the input data.
</code></pre>
</div>


                            <div id="RRCFDetector.fit" class="classattr">
                                        <input id="RRCFDetector.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="RRCFDetector.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RRCFDetector.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RRCFDetector.fit-54"><a href="#RRCFDetector.fit-54"><span class="linenos">54</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="RRCFDetector.fit-55"><a href="#RRCFDetector.fit-55"><span class="linenos">55</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit the model to the input data.</span>
</span><span id="RRCFDetector.fit-56"><a href="#RRCFDetector.fit-56"><span class="linenos">56</span></a>
</span><span id="RRCFDetector.fit-57"><a href="#RRCFDetector.fit-57"><span class="linenos">57</span></a><span class="sd">        Args</span>
</span><span id="RRCFDetector.fit-58"><a href="#RRCFDetector.fit-58"><span class="linenos">58</span></a><span class="sd">        </span>
</span><span id="RRCFDetector.fit-59"><a href="#RRCFDetector.fit-59"><span class="linenos">59</span></a><span class="sd">            X : array-like of shape (n_samples,)</span>
</span><span id="RRCFDetector.fit-60"><a href="#RRCFDetector.fit-60"><span class="linenos">60</span></a><span class="sd">                Input time series data.</span>
</span><span id="RRCFDetector.fit-61"><a href="#RRCFDetector.fit-61"><span class="linenos">61</span></a>
</span><span id="RRCFDetector.fit-62"><a href="#RRCFDetector.fit-62"><span class="linenos">62</span></a><span class="sd">        Returns</span>
</span><span id="RRCFDetector.fit-63"><a href="#RRCFDetector.fit-63"><span class="linenos">63</span></a><span class="sd">        </span>
</span><span id="RRCFDetector.fit-64"><a href="#RRCFDetector.fit-64"><span class="linenos">64</span></a><span class="sd">            self : object</span>
</span><span id="RRCFDetector.fit-65"><a href="#RRCFDetector.fit-65"><span class="linenos">65</span></a><span class="sd">                Returns self.</span>
</span><span id="RRCFDetector.fit-66"><a href="#RRCFDetector.fit-66"><span class="linenos">66</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RRCFDetector.fit-67"><a href="#RRCFDetector.fit-67"><span class="linenos">67</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="RRCFDetector.fit-68"><a href="#RRCFDetector.fit-68"><span class="linenos">68</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span><span id="RRCFDetector.fit-69"><a href="#RRCFDetector.fit-69"><span class="linenos">69</span></a>        
</span><span id="RRCFDetector.fit-70"><a href="#RRCFDetector.fit-70"><span class="linenos">70</span></a>        <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">forest</span><span class="p">:</span>
</span><span id="RRCFDetector.fit-71"><a href="#RRCFDetector.fit-71"><span class="linenos">71</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="RRCFDetector.fit-72"><a href="#RRCFDetector.fit-72"><span class="linenos">72</span></a>                <span class="n">point</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="RRCFDetector.fit-73"><a href="#RRCFDetector.fit-73"><span class="linenos">73</span></a>                <span class="n">unique_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">tree</span><span class="p">))</span>
</span><span id="RRCFDetector.fit-74"><a href="#RRCFDetector.fit-74"><span class="linenos">74</span></a>                <span class="n">tree</span><span class="o">.</span><span class="n">insert_point</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">unique_index</span><span class="p">)</span>
</span><span id="RRCFDetector.fit-75"><a href="#RRCFDetector.fit-75"><span class="linenos">75</span></a>                
</span><span id="RRCFDetector.fit-76"><a href="#RRCFDetector.fit-76"><span class="linenos">76</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">leaves</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree_size</span><span class="p">:</span>
</span><span id="RRCFDetector.fit-77"><a href="#RRCFDetector.fit-77"><span class="linenos">77</span></a>                    <span class="n">old_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree_size</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">tree</span><span class="p">))</span>
</span><span id="RRCFDetector.fit-78"><a href="#RRCFDetector.fit-78"><span class="linenos">78</span></a>                    <span class="k">if</span> <span class="n">old_index</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">leaves</span><span class="p">:</span>
</span><span id="RRCFDetector.fit-79"><a href="#RRCFDetector.fit-79"><span class="linenos">79</span></a>                        <span class="n">tree</span><span class="o">.</span><span class="n">forget_point</span><span class="p">(</span><span class="n">old_index</span><span class="p">)</span>
</span><span id="RRCFDetector.fit-80"><a href="#RRCFDetector.fit-80"><span class="linenos">80</span></a>        
</span><span id="RRCFDetector.fit-81"><a href="#RRCFDetector.fit-81"><span class="linenos">81</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit the model to the input data.</p>

<p>Args</p>

<pre><code>X : array-like of shape (n_samples,)
    Input time series data.
</code></pre>

<p>Returns</p>

<pre><code>self : object
    Returns self.
</code></pre>
</div>


                            </div>
                            <div id="RRCFDetector.predict" class="classattr">
                                        <input id="RRCFDetector.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="RRCFDetector.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RRCFDetector.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RRCFDetector.predict-83"><a href="#RRCFDetector.predict-83"><span class="linenos"> 83</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="RRCFDetector.predict-84"><a href="#RRCFDetector.predict-84"><span class="linenos"> 84</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate anomaly scores for input data.</span>
</span><span id="RRCFDetector.predict-85"><a href="#RRCFDetector.predict-85"><span class="linenos"> 85</span></a>
</span><span id="RRCFDetector.predict-86"><a href="#RRCFDetector.predict-86"><span class="linenos"> 86</span></a><span class="sd">        Args</span>
</span><span id="RRCFDetector.predict-87"><a href="#RRCFDetector.predict-87"><span class="linenos"> 87</span></a><span class="sd">        </span>
</span><span id="RRCFDetector.predict-88"><a href="#RRCFDetector.predict-88"><span class="linenos"> 88</span></a><span class="sd">            X : array-like of shape (n_samples,)</span>
</span><span id="RRCFDetector.predict-89"><a href="#RRCFDetector.predict-89"><span class="linenos"> 89</span></a><span class="sd">                Input time series data.</span>
</span><span id="RRCFDetector.predict-90"><a href="#RRCFDetector.predict-90"><span class="linenos"> 90</span></a>
</span><span id="RRCFDetector.predict-91"><a href="#RRCFDetector.predict-91"><span class="linenos"> 91</span></a><span class="sd">        Returns</span>
</span><span id="RRCFDetector.predict-92"><a href="#RRCFDetector.predict-92"><span class="linenos"> 92</span></a><span class="sd">        </span>
</span><span id="RRCFDetector.predict-93"><a href="#RRCFDetector.predict-93"><span class="linenos"> 93</span></a><span class="sd">            scores : ndarray of shape (n_samples,)</span>
</span><span id="RRCFDetector.predict-94"><a href="#RRCFDetector.predict-94"><span class="linenos"> 94</span></a><span class="sd">                Anomaly scores for each input sample.</span>
</span><span id="RRCFDetector.predict-95"><a href="#RRCFDetector.predict-95"><span class="linenos"> 95</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RRCFDetector.predict-96"><a href="#RRCFDetector.predict-96"><span class="linenos"> 96</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</span><span id="RRCFDetector.predict-97"><a href="#RRCFDetector.predict-97"><span class="linenos"> 97</span></a>        
</span><span id="RRCFDetector.predict-98"><a href="#RRCFDetector.predict-98"><span class="linenos"> 98</span></a>        <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">forest</span><span class="p">:</span>
</span><span id="RRCFDetector.predict-99"><a href="#RRCFDetector.predict-99"><span class="linenos"> 99</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
</span><span id="RRCFDetector.predict-100"><a href="#RRCFDetector.predict-100"><span class="linenos">100</span></a>                <span class="n">point</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="RRCFDetector.predict-101"><a href="#RRCFDetector.predict-101"><span class="linenos">101</span></a>                <span class="n">unique_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="n">tree</span><span class="p">))</span>
</span><span id="RRCFDetector.predict-102"><a href="#RRCFDetector.predict-102"><span class="linenos">102</span></a>                
</span><span id="RRCFDetector.predict-103"><a href="#RRCFDetector.predict-103"><span class="linenos">103</span></a>                <span class="k">if</span> <span class="n">unique_index</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">leaves</span><span class="p">:</span>
</span><span id="RRCFDetector.predict-104"><a href="#RRCFDetector.predict-104"><span class="linenos">104</span></a>                    <span class="n">leaf</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">leaves</span><span class="p">[</span><span class="n">unique_index</span><span class="p">]</span>
</span><span id="RRCFDetector.predict-105"><a href="#RRCFDetector.predict-105"><span class="linenos">105</span></a>                    <span class="n">score</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">codisp</span><span class="p">(</span><span class="n">leaf</span><span class="p">)</span>
</span><span id="RRCFDetector.predict-106"><a href="#RRCFDetector.predict-106"><span class="linenos">106</span></a>                    <span class="n">scores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">score</span>
</span><span id="RRCFDetector.predict-107"><a href="#RRCFDetector.predict-107"><span class="linenos">107</span></a>        
</span><span id="RRCFDetector.predict-108"><a href="#RRCFDetector.predict-108"><span class="linenos">108</span></a>        <span class="k">return</span> <span class="n">scores</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_trees</span>  <span class="c1"># Normalize by number of trees</span>
</span></pre></div>


            <div class="docstring"><p>Calculate anomaly scores for input data.</p>

<p>Args</p>

<pre><code>X : array-like of shape (n_samples,)
    Input time series data.
</code></pre>

<p>Returns</p>

<pre><code>scores : ndarray of shape (n_samples,)
    Anomaly scores for each input sample.
</code></pre>
</div>


                            </div>
                            <div id="RRCFDetector.fit_predict" class="classattr">
                                        <input id="RRCFDetector.fit_predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit_predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="RRCFDetector.fit_predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RRCFDetector.fit_predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RRCFDetector.fit_predict-110"><a href="#RRCFDetector.fit_predict-110"><span class="linenos">110</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="RRCFDetector.fit_predict-111"><a href="#RRCFDetector.fit_predict-111"><span class="linenos">111</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit the model and calculate anomaly scores.</span>
</span><span id="RRCFDetector.fit_predict-112"><a href="#RRCFDetector.fit_predict-112"><span class="linenos">112</span></a>
</span><span id="RRCFDetector.fit_predict-113"><a href="#RRCFDetector.fit_predict-113"><span class="linenos">113</span></a><span class="sd">        Args</span>
</span><span id="RRCFDetector.fit_predict-114"><a href="#RRCFDetector.fit_predict-114"><span class="linenos">114</span></a><span class="sd">        </span>
</span><span id="RRCFDetector.fit_predict-115"><a href="#RRCFDetector.fit_predict-115"><span class="linenos">115</span></a><span class="sd">            X : array-like of shape (n_samples,)</span>
</span><span id="RRCFDetector.fit_predict-116"><a href="#RRCFDetector.fit_predict-116"><span class="linenos">116</span></a><span class="sd">                Input time series data.</span>
</span><span id="RRCFDetector.fit_predict-117"><a href="#RRCFDetector.fit_predict-117"><span class="linenos">117</span></a>
</span><span id="RRCFDetector.fit_predict-118"><a href="#RRCFDetector.fit_predict-118"><span class="linenos">118</span></a><span class="sd">        Returns</span>
</span><span id="RRCFDetector.fit_predict-119"><a href="#RRCFDetector.fit_predict-119"><span class="linenos">119</span></a><span class="sd">        </span>
</span><span id="RRCFDetector.fit_predict-120"><a href="#RRCFDetector.fit_predict-120"><span class="linenos">120</span></a><span class="sd">            anomaly_scores : Series of shape (n_samples,)</span>
</span><span id="RRCFDetector.fit_predict-121"><a href="#RRCFDetector.fit_predict-121"><span class="linenos">121</span></a><span class="sd">                Anomaly scores for each input sample.</span>
</span><span id="RRCFDetector.fit_predict-122"><a href="#RRCFDetector.fit_predict-122"><span class="linenos">122</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RRCFDetector.fit_predict-123"><a href="#RRCFDetector.fit_predict-123"><span class="linenos">123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="RRCFDetector.fit_predict-124"><a href="#RRCFDetector.fit_predict-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)))</span>
</span><span id="RRCFDetector.fit_predict-125"><a href="#RRCFDetector.fit_predict-125"><span class="linenos">125</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_scores</span>
</span></pre></div>


            <div class="docstring"><p>Fit the model and calculate anomaly scores.</p>

<p>Args</p>

<pre><code>X : array-like of shape (n_samples,)
    Input time series data.
</code></pre>

<p>Returns</p>

<pre><code>anomaly_scores : Series of shape (n_samples,)
    Anomaly scores for each input sample.
</code></pre>
</div>


                            </div>
                            <div id="RRCFDetector.get_anomalies" class="classattr">
                                        <input id="RRCFDetector.get_anomalies-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_anomalies</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">threshold</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="RRCFDetector.get_anomalies-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RRCFDetector.get_anomalies"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RRCFDetector.get_anomalies-127"><a href="#RRCFDetector.get_anomalies-127"><span class="linenos">127</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_anomalies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
</span><span id="RRCFDetector.get_anomalies-128"><a href="#RRCFDetector.get_anomalies-128"><span class="linenos">128</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Identify anomalies based on a threshold.</span>
</span><span id="RRCFDetector.get_anomalies-129"><a href="#RRCFDetector.get_anomalies-129"><span class="linenos">129</span></a>
</span><span id="RRCFDetector.get_anomalies-130"><a href="#RRCFDetector.get_anomalies-130"><span class="linenos">130</span></a><span class="sd">        Args</span>
</span><span id="RRCFDetector.get_anomalies-131"><a href="#RRCFDetector.get_anomalies-131"><span class="linenos">131</span></a><span class="sd">        </span>
</span><span id="RRCFDetector.get_anomalies-132"><a href="#RRCFDetector.get_anomalies-132"><span class="linenos">132</span></a><span class="sd">            threshold : float</span>
</span><span id="RRCFDetector.get_anomalies-133"><a href="#RRCFDetector.get_anomalies-133"><span class="linenos">133</span></a><span class="sd">                Threshold value for anomaly detection.</span>
</span><span id="RRCFDetector.get_anomalies-134"><a href="#RRCFDetector.get_anomalies-134"><span class="linenos">134</span></a>
</span><span id="RRCFDetector.get_anomalies-135"><a href="#RRCFDetector.get_anomalies-135"><span class="linenos">135</span></a><span class="sd">        Returns</span>
</span><span id="RRCFDetector.get_anomalies-136"><a href="#RRCFDetector.get_anomalies-136"><span class="linenos">136</span></a><span class="sd">        </span>
</span><span id="RRCFDetector.get_anomalies-137"><a href="#RRCFDetector.get_anomalies-137"><span class="linenos">137</span></a><span class="sd">            anomalies : Series</span>
</span><span id="RRCFDetector.get_anomalies-138"><a href="#RRCFDetector.get_anomalies-138"><span class="linenos">138</span></a><span class="sd">                Series containing anomaly scores above the threshold.</span>
</span><span id="RRCFDetector.get_anomalies-139"><a href="#RRCFDetector.get_anomalies-139"><span class="linenos">139</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RRCFDetector.get_anomalies-140"><a href="#RRCFDetector.get_anomalies-140"><span class="linenos">140</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_scores</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="RRCFDetector.get_anomalies-141"><a href="#RRCFDetector.get_anomalies-141"><span class="linenos">141</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Model must be fit before getting anomalies.&quot;</span><span class="p">)</span>
</span><span id="RRCFDetector.get_anomalies-142"><a href="#RRCFDetector.get_anomalies-142"><span class="linenos">142</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly_scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">anomaly_scores</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Identify anomalies based on a threshold.</p>

<p>Args</p>

<pre><code>threshold : float
    Threshold value for anomaly detection.
</code></pre>

<p>Returns</p>

<pre><code>anomalies : Series
    Series containing anomaly scores above the threshold.
</code></pre>
</div>


                            </div>
                            <div id="RRCFDetector.predict_proba" class="classattr">
                                        <input id="RRCFDetector.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="RRCFDetector.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RRCFDetector.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RRCFDetector.predict_proba-144"><a href="#RRCFDetector.predict_proba-144"><span class="linenos">144</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="RRCFDetector.predict_proba-145"><a href="#RRCFDetector.predict_proba-145"><span class="linenos">145</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate normalized probability-like anomaly scores.</span>
</span><span id="RRCFDetector.predict_proba-146"><a href="#RRCFDetector.predict_proba-146"><span class="linenos">146</span></a>
</span><span id="RRCFDetector.predict_proba-147"><a href="#RRCFDetector.predict_proba-147"><span class="linenos">147</span></a><span class="sd">        Args</span>
</span><span id="RRCFDetector.predict_proba-148"><a href="#RRCFDetector.predict_proba-148"><span class="linenos">148</span></a><span class="sd">        </span>
</span><span id="RRCFDetector.predict_proba-149"><a href="#RRCFDetector.predict_proba-149"><span class="linenos">149</span></a><span class="sd">            X : array-like of shape (n_samples,)</span>
</span><span id="RRCFDetector.predict_proba-150"><a href="#RRCFDetector.predict_proba-150"><span class="linenos">150</span></a><span class="sd">                Input time series data.</span>
</span><span id="RRCFDetector.predict_proba-151"><a href="#RRCFDetector.predict_proba-151"><span class="linenos">151</span></a>
</span><span id="RRCFDetector.predict_proba-152"><a href="#RRCFDetector.predict_proba-152"><span class="linenos">152</span></a><span class="sd">        Returns</span>
</span><span id="RRCFDetector.predict_proba-153"><a href="#RRCFDetector.predict_proba-153"><span class="linenos">153</span></a><span class="sd">        </span>
</span><span id="RRCFDetector.predict_proba-154"><a href="#RRCFDetector.predict_proba-154"><span class="linenos">154</span></a><span class="sd">            proba : ndarray of shape (n_samples,)</span>
</span><span id="RRCFDetector.predict_proba-155"><a href="#RRCFDetector.predict_proba-155"><span class="linenos">155</span></a><span class="sd">                Normalized anomaly scores.</span>
</span><span id="RRCFDetector.predict_proba-156"><a href="#RRCFDetector.predict_proba-156"><span class="linenos">156</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RRCFDetector.predict_proba-157"><a href="#RRCFDetector.predict_proba-157"><span class="linenos">157</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="RRCFDetector.predict_proba-158"><a href="#RRCFDetector.predict_proba-158"><span class="linenos">158</span></a>        <span class="n">max_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span><span id="RRCFDetector.predict_proba-159"><a href="#RRCFDetector.predict_proba-159"><span class="linenos">159</span></a>        
</span><span id="RRCFDetector.predict_proba-160"><a href="#RRCFDetector.predict_proba-160"><span class="linenos">160</span></a>        <span class="c1"># Avoid division by zero</span>
</span><span id="RRCFDetector.predict_proba-161"><a href="#RRCFDetector.predict_proba-161"><span class="linenos">161</span></a>        <span class="k">if</span> <span class="n">max_score</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="RRCFDetector.predict_proba-162"><a href="#RRCFDetector.predict_proba-162"><span class="linenos">162</span></a>            <span class="k">return</span> <span class="n">scores</span> <span class="o">/</span> <span class="n">max_score</span>
</span><span id="RRCFDetector.predict_proba-163"><a href="#RRCFDetector.predict_proba-163"><span class="linenos">163</span></a>        <span class="k">return</span> <span class="n">scores</span>
</span></pre></div>


            <div class="docstring"><p>Calculate normalized probability-like anomaly scores.</p>

<p>Args</p>

<pre><code>X : array-like of shape (n_samples,)
    Input time series data.
</code></pre>

<p>Returns</p>

<pre><code>proba : ndarray of shape (n_samples,)
    Normalized anomaly scores.
</code></pre>
</div>


                            </div>
                </section>
                <section id="LNNDetector">
                            <input id="LNNDetector-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LNNDetector</span>:

                <label class="view-source-button" for="LNNDetector-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LNNDetector"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LNNDetector-161"><a href="#LNNDetector-161"><span class="linenos">161</span></a><span class="k">class</span><span class="w"> </span><span class="nc">LNNDetector</span><span class="p">:</span>
</span><span id="LNNDetector-162"><a href="#LNNDetector-162"><span class="linenos">162</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LNNDetector-163"><a href="#LNNDetector-163"><span class="linenos">163</span></a><span class="sd">    LNN-based autoencoder anomaly detector.</span>
</span><span id="LNNDetector-164"><a href="#LNNDetector-164"><span class="linenos">164</span></a><span class="sd">    </span>
</span><span id="LNNDetector-165"><a href="#LNNDetector-165"><span class="linenos">165</span></a><span class="sd">    This class implements an anomaly detector using a Liquid Neural Network-based</span>
</span><span id="LNNDetector-166"><a href="#LNNDetector-166"><span class="linenos">166</span></a><span class="sd">    autoencoder for detecting anomalies in time series data, offering improved </span>
</span><span id="LNNDetector-167"><a href="#LNNDetector-167"><span class="linenos">167</span></a><span class="sd">    capability for handling complex temporal dynamics.</span>
</span><span id="LNNDetector-168"><a href="#LNNDetector-168"><span class="linenos">168</span></a>
</span><span id="LNNDetector-169"><a href="#LNNDetector-169"><span class="linenos">169</span></a><span class="sd">    Args:</span>
</span><span id="LNNDetector-170"><a href="#LNNDetector-170"><span class="linenos">170</span></a><span class="sd">            - n_features (int): Dimension of input features</span>
</span><span id="LNNDetector-171"><a href="#LNNDetector-171"><span class="linenos">171</span></a>
</span><span id="LNNDetector-172"><a href="#LNNDetector-172"><span class="linenos">172</span></a><span class="sd">            - seq_len (int): Length of input sequence</span>
</span><span id="LNNDetector-173"><a href="#LNNDetector-173"><span class="linenos">173</span></a>
</span><span id="LNNDetector-174"><a href="#LNNDetector-174"><span class="linenos">174</span></a><span class="sd">            - latent_dim (int): Dimension of the latent space representation</span>
</span><span id="LNNDetector-175"><a href="#LNNDetector-175"><span class="linenos">175</span></a>
</span><span id="LNNDetector-176"><a href="#LNNDetector-176"><span class="linenos">176</span></a><span class="sd">            - learning_rate (float): Learning rate for training the model</span>
</span><span id="LNNDetector-177"><a href="#LNNDetector-177"><span class="linenos">177</span></a>
</span><span id="LNNDetector-178"><a href="#LNNDetector-178"><span class="linenos">178</span></a><span class="sd">            - epochs (int): Number of epochs for training the model</span>
</span><span id="LNNDetector-179"><a href="#LNNDetector-179"><span class="linenos">179</span></a>
</span><span id="LNNDetector-180"><a href="#LNNDetector-180"><span class="linenos">180</span></a><span class="sd">            - threshold_multiplier (float): Anomaly threshold multiplier</span>
</span><span id="LNNDetector-181"><a href="#LNNDetector-181"><span class="linenos">181</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="LNNDetector-182"><a href="#LNNDetector-182"><span class="linenos">182</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">,</span> <span class="n">latent_dim</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> 
</span><span id="LNNDetector-183"><a href="#LNNDetector-183"><span class="linenos">183</span></a>                 <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> 
</span><span id="LNNDetector-184"><a href="#LNNDetector-184"><span class="linenos">184</span></a>                 <span class="n">threshold_multiplier</span><span class="o">=</span><span class="mf">3.0</span><span class="p">):</span>
</span><span id="LNNDetector-185"><a href="#LNNDetector-185"><span class="linenos">185</span></a>
</span><span id="LNNDetector-186"><a href="#LNNDetector-186"><span class="linenos">186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_features</span> <span class="o">=</span> <span class="n">n_features</span>
</span><span id="LNNDetector-187"><a href="#LNNDetector-187"><span class="linenos">187</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seq_len</span> <span class="o">=</span> <span class="n">seq_len</span>
</span><span id="LNNDetector-188"><a href="#LNNDetector-188"><span class="linenos">188</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">latent_dim</span> <span class="o">=</span> <span class="n">latent_dim</span>
</span><span id="LNNDetector-189"><a href="#LNNDetector-189"><span class="linenos">189</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="n">learning_rate</span>
</span><span id="LNNDetector-190"><a href="#LNNDetector-190"><span class="linenos">190</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span> <span class="o">=</span> <span class="n">epochs</span>
</span><span id="LNNDetector-191"><a href="#LNNDetector-191"><span class="linenos">191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold_multiplier</span> <span class="o">=</span> <span class="n">threshold_multiplier</span>
</span><span id="LNNDetector-192"><a href="#LNNDetector-192"><span class="linenos">192</span></a>        
</span><span id="LNNDetector-193"><a href="#LNNDetector-193"><span class="linenos">193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
</span><span id="LNNDetector-194"><a href="#LNNDetector-194"><span class="linenos">194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">LNNAutoencoder</span><span class="p">(</span><span class="n">n_features</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="LNNDetector-195"><a href="#LNNDetector-195"><span class="linenos">195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">)</span>
</span><span id="LNNDetector-196"><a href="#LNNDetector-196"><span class="linenos">196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">L1Loss</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>  <span class="c1"># Using L1Loss as in the notebook example</span>
</span><span id="LNNDetector-197"><a href="#LNNDetector-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
</span><span id="LNNDetector-198"><a href="#LNNDetector-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LNNDetector-199"><a href="#LNNDetector-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;train&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;val&#39;</span><span class="p">:</span> <span class="p">[]}</span>
</span><span id="LNNDetector-200"><a href="#LNNDetector-200"><span class="linenos">200</span></a>        
</span><span id="LNNDetector-201"><a href="#LNNDetector-201"><span class="linenos">201</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">X_test</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="LNNDetector-202"><a href="#LNNDetector-202"><span class="linenos">202</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LNNDetector-203"><a href="#LNNDetector-203"><span class="linenos">203</span></a><span class="sd">        Fit the LNN-based anomaly detector to the input data.</span>
</span><span id="LNNDetector-204"><a href="#LNNDetector-204"><span class="linenos">204</span></a><span class="sd">        </span>
</span><span id="LNNDetector-205"><a href="#LNNDetector-205"><span class="linenos">205</span></a><span class="sd">        Args:</span>
</span><span id="LNNDetector-206"><a href="#LNNDetector-206"><span class="linenos">206</span></a>
</span><span id="LNNDetector-207"><a href="#LNNDetector-207"><span class="linenos">207</span></a><span class="sd">            - X (np.ndarray): Input data for training the model</span>
</span><span id="LNNDetector-208"><a href="#LNNDetector-208"><span class="linenos">208</span></a>
</span><span id="LNNDetector-209"><a href="#LNNDetector-209"><span class="linenos">209</span></a><span class="sd">            - X_test (np.ndarray, optional): Test data for validation</span>
</span><span id="LNNDetector-210"><a href="#LNNDetector-210"><span class="linenos">210</span></a><span class="sd">            verbose (bool): Whether to print training progress</span>
</span><span id="LNNDetector-211"><a href="#LNNDetector-211"><span class="linenos">211</span></a><span class="sd">        </span>
</span><span id="LNNDetector-212"><a href="#LNNDetector-212"><span class="linenos">212</span></a><span class="sd">        Returns:</span>
</span><span id="LNNDetector-213"><a href="#LNNDetector-213"><span class="linenos">213</span></a>
</span><span id="LNNDetector-214"><a href="#LNNDetector-214"><span class="linenos">214</span></a><span class="sd">            dict: Training history</span>
</span><span id="LNNDetector-215"><a href="#LNNDetector-215"><span class="linenos">215</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LNNDetector-216"><a href="#LNNDetector-216"><span class="linenos">216</span></a>        <span class="c1"># Use input data directly without scaling</span>
</span><span id="LNNDetector-217"><a href="#LNNDetector-217"><span class="linenos">217</span></a>        <span class="n">X_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LNNDetector-218"><a href="#LNNDetector-218"><span class="linenos">218</span></a>        
</span><span id="LNNDetector-219"><a href="#LNNDetector-219"><span class="linenos">219</span></a>        <span class="k">if</span> <span class="n">X_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LNNDetector-220"><a href="#LNNDetector-220"><span class="linenos">220</span></a>            <span class="n">X_test_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LNNDetector-221"><a href="#LNNDetector-221"><span class="linenos">221</span></a>        
</span><span id="LNNDetector-222"><a href="#LNNDetector-222"><span class="linenos">222</span></a>        <span class="n">best_loss</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
</span><span id="LNNDetector-223"><a href="#LNNDetector-223"><span class="linenos">223</span></a>        <span class="n">best_model_wts</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">())</span>
</span><span id="LNNDetector-224"><a href="#LNNDetector-224"><span class="linenos">224</span></a>        
</span><span id="LNNDetector-225"><a href="#LNNDetector-225"><span class="linenos">225</span></a>        <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="p">):</span>
</span><span id="LNNDetector-226"><a href="#LNNDetector-226"><span class="linenos">226</span></a>            <span class="c1"># Training phase</span>
</span><span id="LNNDetector-227"><a href="#LNNDetector-227"><span class="linenos">227</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</span><span id="LNNDetector-228"><a href="#LNNDetector-228"><span class="linenos">228</span></a>            <span class="n">train_losses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LNNDetector-229"><a href="#LNNDetector-229"><span class="linenos">229</span></a>            
</span><span id="LNNDetector-230"><a href="#LNNDetector-230"><span class="linenos">230</span></a>            <span class="k">for</span> <span class="n">seq_true</span> <span class="ow">in</span> <span class="n">X_tensor</span><span class="p">:</span>
</span><span id="LNNDetector-231"><a href="#LNNDetector-231"><span class="linenos">231</span></a>                <span class="n">seq_true</span> <span class="o">=</span> <span class="n">seq_true</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="LNNDetector-232"><a href="#LNNDetector-232"><span class="linenos">232</span></a>                <span class="n">seq_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">seq_true</span><span class="p">)</span>
</span><span id="LNNDetector-233"><a href="#LNNDetector-233"><span class="linenos">233</span></a>                <span class="n">seq_pred</span> <span class="o">=</span> <span class="n">seq_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">seq_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],))</span>
</span><span id="LNNDetector-234"><a href="#LNNDetector-234"><span class="linenos">234</span></a>                <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criterion</span><span class="p">(</span><span class="n">seq_pred</span><span class="p">,</span> <span class="n">seq_true</span><span class="p">)</span>
</span><span id="LNNDetector-235"><a href="#LNNDetector-235"><span class="linenos">235</span></a>                
</span><span id="LNNDetector-236"><a href="#LNNDetector-236"><span class="linenos">236</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
</span><span id="LNNDetector-237"><a href="#LNNDetector-237"><span class="linenos">237</span></a>                <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</span><span id="LNNDetector-238"><a href="#LNNDetector-238"><span class="linenos">238</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</span><span id="LNNDetector-239"><a href="#LNNDetector-239"><span class="linenos">239</span></a>                
</span><span id="LNNDetector-240"><a href="#LNNDetector-240"><span class="linenos">240</span></a>                <span class="n">train_losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</span><span id="LNNDetector-241"><a href="#LNNDetector-241"><span class="linenos">241</span></a>            
</span><span id="LNNDetector-242"><a href="#LNNDetector-242"><span class="linenos">242</span></a>            <span class="n">train_loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">train_losses</span><span class="p">)</span>
</span><span id="LNNDetector-243"><a href="#LNNDetector-243"><span class="linenos">243</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_loss</span><span class="p">)</span>
</span><span id="LNNDetector-244"><a href="#LNNDetector-244"><span class="linenos">244</span></a>            
</span><span id="LNNDetector-245"><a href="#LNNDetector-245"><span class="linenos">245</span></a>            <span class="c1"># Validation phase</span>
</span><span id="LNNDetector-246"><a href="#LNNDetector-246"><span class="linenos">246</span></a>            <span class="n">val_loss</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LNNDetector-247"><a href="#LNNDetector-247"><span class="linenos">247</span></a>            <span class="k">if</span> <span class="n">X_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LNNDetector-248"><a href="#LNNDetector-248"><span class="linenos">248</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span><span id="LNNDetector-249"><a href="#LNNDetector-249"><span class="linenos">249</span></a>                <span class="n">val_losses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LNNDetector-250"><a href="#LNNDetector-250"><span class="linenos">250</span></a>                
</span><span id="LNNDetector-251"><a href="#LNNDetector-251"><span class="linenos">251</span></a>                <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span><span id="LNNDetector-252"><a href="#LNNDetector-252"><span class="linenos">252</span></a>                    <span class="k">for</span> <span class="n">seq_true</span> <span class="ow">in</span> <span class="n">X_test_tensor</span><span class="p">:</span>
</span><span id="LNNDetector-253"><a href="#LNNDetector-253"><span class="linenos">253</span></a>                        <span class="n">seq_true</span> <span class="o">=</span> <span class="n">seq_true</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="LNNDetector-254"><a href="#LNNDetector-254"><span class="linenos">254</span></a>                        <span class="n">seq_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">seq_true</span><span class="p">)</span>
</span><span id="LNNDetector-255"><a href="#LNNDetector-255"><span class="linenos">255</span></a>                        <span class="n">seq_pred</span> <span class="o">=</span> <span class="n">seq_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">seq_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],))</span>
</span><span id="LNNDetector-256"><a href="#LNNDetector-256"><span class="linenos">256</span></a>                        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criterion</span><span class="p">(</span><span class="n">seq_pred</span><span class="p">,</span> <span class="n">seq_true</span><span class="p">)</span>
</span><span id="LNNDetector-257"><a href="#LNNDetector-257"><span class="linenos">257</span></a>                        <span class="n">val_losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</span><span id="LNNDetector-258"><a href="#LNNDetector-258"><span class="linenos">258</span></a>                
</span><span id="LNNDetector-259"><a href="#LNNDetector-259"><span class="linenos">259</span></a>                <span class="n">val_loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">val_losses</span><span class="p">)</span>
</span><span id="LNNDetector-260"><a href="#LNNDetector-260"><span class="linenos">260</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val_loss</span><span class="p">)</span>
</span><span id="LNNDetector-261"><a href="#LNNDetector-261"><span class="linenos">261</span></a>                
</span><span id="LNNDetector-262"><a href="#LNNDetector-262"><span class="linenos">262</span></a>                <span class="k">if</span> <span class="n">val_loss</span> <span class="o">&lt;</span> <span class="n">best_loss</span><span class="p">:</span>
</span><span id="LNNDetector-263"><a href="#LNNDetector-263"><span class="linenos">263</span></a>                    <span class="n">best_loss</span> <span class="o">=</span> <span class="n">val_loss</span>
</span><span id="LNNDetector-264"><a href="#LNNDetector-264"><span class="linenos">264</span></a>                    <span class="n">best_model_wts</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">())</span>
</span><span id="LNNDetector-265"><a href="#LNNDetector-265"><span class="linenos">265</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="LNNDetector-266"><a href="#LNNDetector-266"><span class="linenos">266</span></a>                <span class="k">if</span> <span class="n">train_loss</span> <span class="o">&lt;</span> <span class="n">best_loss</span><span class="p">:</span>
</span><span id="LNNDetector-267"><a href="#LNNDetector-267"><span class="linenos">267</span></a>                    <span class="n">best_loss</span> <span class="o">=</span> <span class="n">train_loss</span>
</span><span id="LNNDetector-268"><a href="#LNNDetector-268"><span class="linenos">268</span></a>                    <span class="n">best_model_wts</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">())</span>
</span><span id="LNNDetector-269"><a href="#LNNDetector-269"><span class="linenos">269</span></a>            
</span><span id="LNNDetector-270"><a href="#LNNDetector-270"><span class="linenos">270</span></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="LNNDetector-271"><a href="#LNNDetector-271"><span class="linenos">271</span></a>                <span class="n">log_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Epoch </span><span class="si">{</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="si">}</span><span class="s1">, Train Loss: </span><span class="si">{</span><span class="n">train_loss</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="LNNDetector-272"><a href="#LNNDetector-272"><span class="linenos">272</span></a>                <span class="k">if</span> <span class="n">val_loss</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LNNDetector-273"><a href="#LNNDetector-273"><span class="linenos">273</span></a>                    <span class="n">log_message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;, Val Loss: </span><span class="si">{</span><span class="n">val_loss</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="LNNDetector-274"><a href="#LNNDetector-274"><span class="linenos">274</span></a>                <span class="nb">print</span><span class="p">(</span><span class="n">log_message</span><span class="p">)</span>
</span><span id="LNNDetector-275"><a href="#LNNDetector-275"><span class="linenos">275</span></a>        
</span><span id="LNNDetector-276"><a href="#LNNDetector-276"><span class="linenos">276</span></a>        <span class="c1"># Load the best model</span>
</span><span id="LNNDetector-277"><a href="#LNNDetector-277"><span class="linenos">277</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">best_model_wts</span><span class="p">)</span>
</span><span id="LNNDetector-278"><a href="#LNNDetector-278"><span class="linenos">278</span></a>        
</span><span id="LNNDetector-279"><a href="#LNNDetector-279"><span class="linenos">279</span></a>        <span class="c1"># Calculate threshold based on training data</span>
</span><span id="LNNDetector-280"><a href="#LNNDetector-280"><span class="linenos">280</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_threshold</span><span class="p">(</span><span class="n">X_tensor</span><span class="p">)</span>
</span><span id="LNNDetector-281"><a href="#LNNDetector-281"><span class="linenos">281</span></a>        
</span><span id="LNNDetector-282"><a href="#LNNDetector-282"><span class="linenos">282</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">history</span>
</span><span id="LNNDetector-283"><a href="#LNNDetector-283"><span class="linenos">283</span></a>        
</span><span id="LNNDetector-284"><a href="#LNNDetector-284"><span class="linenos">284</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_scaled</span><span class="p">):</span>
</span><span id="LNNDetector-285"><a href="#LNNDetector-285"><span class="linenos">285</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LNNDetector-286"><a href="#LNNDetector-286"><span class="linenos">286</span></a><span class="sd">        Calculate the anomaly threshold based on reconstruction errors.</span>
</span><span id="LNNDetector-287"><a href="#LNNDetector-287"><span class="linenos">287</span></a><span class="sd">        </span>
</span><span id="LNNDetector-288"><a href="#LNNDetector-288"><span class="linenos">288</span></a><span class="sd">        Args:</span>
</span><span id="LNNDetector-289"><a href="#LNNDetector-289"><span class="linenos">289</span></a>
</span><span id="LNNDetector-290"><a href="#LNNDetector-290"><span class="linenos">290</span></a><span class="sd">            X_scaled (torch.Tensor): Scaled input data</span>
</span><span id="LNNDetector-291"><a href="#LNNDetector-291"><span class="linenos">291</span></a><span class="sd">            </span>
</span><span id="LNNDetector-292"><a href="#LNNDetector-292"><span class="linenos">292</span></a><span class="sd">        Returns:</span>
</span><span id="LNNDetector-293"><a href="#LNNDetector-293"><span class="linenos">293</span></a>
</span><span id="LNNDetector-294"><a href="#LNNDetector-294"><span class="linenos">294</span></a><span class="sd">            float: Anomaly threshold</span>
</span><span id="LNNDetector-295"><a href="#LNNDetector-295"><span class="linenos">295</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LNNDetector-296"><a href="#LNNDetector-296"><span class="linenos">296</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span><span id="LNNDetector-297"><a href="#LNNDetector-297"><span class="linenos">297</span></a>        <span class="n">reconstruction_errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LNNDetector-298"><a href="#LNNDetector-298"><span class="linenos">298</span></a>        
</span><span id="LNNDetector-299"><a href="#LNNDetector-299"><span class="linenos">299</span></a>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span><span id="LNNDetector-300"><a href="#LNNDetector-300"><span class="linenos">300</span></a>            <span class="k">for</span> <span class="n">seq_true</span> <span class="ow">in</span> <span class="n">X_scaled</span><span class="p">:</span>
</span><span id="LNNDetector-301"><a href="#LNNDetector-301"><span class="linenos">301</span></a>                <span class="n">seq_true</span> <span class="o">=</span> <span class="n">seq_true</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="LNNDetector-302"><a href="#LNNDetector-302"><span class="linenos">302</span></a>                <span class="n">seq_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">seq_true</span><span class="p">)</span>
</span><span id="LNNDetector-303"><a href="#LNNDetector-303"><span class="linenos">303</span></a>                <span class="n">seq_pred</span> <span class="o">=</span> <span class="n">seq_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">seq_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],))</span>
</span><span id="LNNDetector-304"><a href="#LNNDetector-304"><span class="linenos">304</span></a>                
</span><span id="LNNDetector-305"><a href="#LNNDetector-305"><span class="linenos">305</span></a>                <span class="c1"># Calculate L1 distance (reconstruction error)</span>
</span><span id="LNNDetector-306"><a href="#LNNDetector-306"><span class="linenos">306</span></a>                <span class="n">error</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">seq_pred</span> <span class="o">-</span> <span class="n">seq_true</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span><span id="LNNDetector-307"><a href="#LNNDetector-307"><span class="linenos">307</span></a>                <span class="n">reconstruction_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</span><span id="LNNDetector-308"><a href="#LNNDetector-308"><span class="linenos">308</span></a>        
</span><span id="LNNDetector-309"><a href="#LNNDetector-309"><span class="linenos">309</span></a>        <span class="c1"># Set threshold based on distribution of reconstruction errors</span>
</span><span id="LNNDetector-310"><a href="#LNNDetector-310"><span class="linenos">310</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">reconstruction_errors</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold_multiplier</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">reconstruction_errors</span><span class="p">)</span>
</span><span id="LNNDetector-311"><a href="#LNNDetector-311"><span class="linenos">311</span></a>        
</span><span id="LNNDetector-312"><a href="#LNNDetector-312"><span class="linenos">312</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span>
</span><span id="LNNDetector-313"><a href="#LNNDetector-313"><span class="linenos">313</span></a>        
</span><span id="LNNDetector-314"><a href="#LNNDetector-314"><span class="linenos">314</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="LNNDetector-315"><a href="#LNNDetector-315"><span class="linenos">315</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LNNDetector-316"><a href="#LNNDetector-316"><span class="linenos">316</span></a><span class="sd">        Predict anomalies in the input data.</span>
</span><span id="LNNDetector-317"><a href="#LNNDetector-317"><span class="linenos">317</span></a><span class="sd">        </span>
</span><span id="LNNDetector-318"><a href="#LNNDetector-318"><span class="linenos">318</span></a><span class="sd">        Args:</span>
</span><span id="LNNDetector-319"><a href="#LNNDetector-319"><span class="linenos">319</span></a>
</span><span id="LNNDetector-320"><a href="#LNNDetector-320"><span class="linenos">320</span></a><span class="sd">            X (np.ndarray): Input data for anomaly detection</span>
</span><span id="LNNDetector-321"><a href="#LNNDetector-321"><span class="linenos">321</span></a><span class="sd">            </span>
</span><span id="LNNDetector-322"><a href="#LNNDetector-322"><span class="linenos">322</span></a><span class="sd">        Returns:</span>
</span><span id="LNNDetector-323"><a href="#LNNDetector-323"><span class="linenos">323</span></a>
</span><span id="LNNDetector-324"><a href="#LNNDetector-324"><span class="linenos">324</span></a><span class="sd">            np.ndarray: Binary array where 1 indicates anomaly, 0 indicates normal</span>
</span><span id="LNNDetector-325"><a href="#LNNDetector-325"><span class="linenos">325</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LNNDetector-326"><a href="#LNNDetector-326"><span class="linenos">326</span></a>        <span class="n">X_scaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="LNNDetector-327"><a href="#LNNDetector-327"><span class="linenos">327</span></a>        <span class="n">X_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LNNDetector-328"><a href="#LNNDetector-328"><span class="linenos">328</span></a>        
</span><span id="LNNDetector-329"><a href="#LNNDetector-329"><span class="linenos">329</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span><span id="LNNDetector-330"><a href="#LNNDetector-330"><span class="linenos">330</span></a>        <span class="n">anomalies</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LNNDetector-331"><a href="#LNNDetector-331"><span class="linenos">331</span></a>        
</span><span id="LNNDetector-332"><a href="#LNNDetector-332"><span class="linenos">332</span></a>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span><span id="LNNDetector-333"><a href="#LNNDetector-333"><span class="linenos">333</span></a>            <span class="k">for</span> <span class="n">seq_true</span> <span class="ow">in</span> <span class="n">X_tensor</span><span class="p">:</span>
</span><span id="LNNDetector-334"><a href="#LNNDetector-334"><span class="linenos">334</span></a>                <span class="n">seq_true</span> <span class="o">=</span> <span class="n">seq_true</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="LNNDetector-335"><a href="#LNNDetector-335"><span class="linenos">335</span></a>                <span class="n">seq_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">seq_true</span><span class="p">)</span>
</span><span id="LNNDetector-336"><a href="#LNNDetector-336"><span class="linenos">336</span></a>                <span class="n">seq_pred</span> <span class="o">=</span> <span class="n">seq_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">seq_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],))</span>
</span><span id="LNNDetector-337"><a href="#LNNDetector-337"><span class="linenos">337</span></a>                
</span><span id="LNNDetector-338"><a href="#LNNDetector-338"><span class="linenos">338</span></a>                <span class="c1"># Calculate L1 distance (reconstruction error)</span>
</span><span id="LNNDetector-339"><a href="#LNNDetector-339"><span class="linenos">339</span></a>                <span class="n">error</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">seq_pred</span> <span class="o">-</span> <span class="n">seq_true</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span><span id="LNNDetector-340"><a href="#LNNDetector-340"><span class="linenos">340</span></a>                <span class="n">anomalies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">error</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="LNNDetector-341"><a href="#LNNDetector-341"><span class="linenos">341</span></a>        
</span><span id="LNNDetector-342"><a href="#LNNDetector-342"><span class="linenos">342</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">anomalies</span><span class="p">)</span>
</span><span id="LNNDetector-343"><a href="#LNNDetector-343"><span class="linenos">343</span></a>    
</span><span id="LNNDetector-344"><a href="#LNNDetector-344"><span class="linenos">344</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">anomaly_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="LNNDetector-345"><a href="#LNNDetector-345"><span class="linenos">345</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LNNDetector-346"><a href="#LNNDetector-346"><span class="linenos">346</span></a><span class="sd">        Calculate anomaly scores for the input data.</span>
</span><span id="LNNDetector-347"><a href="#LNNDetector-347"><span class="linenos">347</span></a><span class="sd">        </span>
</span><span id="LNNDetector-348"><a href="#LNNDetector-348"><span class="linenos">348</span></a><span class="sd">        Args:</span>
</span><span id="LNNDetector-349"><a href="#LNNDetector-349"><span class="linenos">349</span></a>
</span><span id="LNNDetector-350"><a href="#LNNDetector-350"><span class="linenos">350</span></a><span class="sd">            X (np.ndarray): Input data for anomaly detection</span>
</span><span id="LNNDetector-351"><a href="#LNNDetector-351"><span class="linenos">351</span></a><span class="sd">        </span>
</span><span id="LNNDetector-352"><a href="#LNNDetector-352"><span class="linenos">352</span></a><span class="sd">        Returns:</span>
</span><span id="LNNDetector-353"><a href="#LNNDetector-353"><span class="linenos">353</span></a>
</span><span id="LNNDetector-354"><a href="#LNNDetector-354"><span class="linenos">354</span></a><span class="sd">            np.ndarray: Anomaly scores (reconstruction errors)</span>
</span><span id="LNNDetector-355"><a href="#LNNDetector-355"><span class="linenos">355</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LNNDetector-356"><a href="#LNNDetector-356"><span class="linenos">356</span></a>        <span class="n">X_scaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="LNNDetector-357"><a href="#LNNDetector-357"><span class="linenos">357</span></a>        <span class="n">X_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LNNDetector-358"><a href="#LNNDetector-358"><span class="linenos">358</span></a>        
</span><span id="LNNDetector-359"><a href="#LNNDetector-359"><span class="linenos">359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span><span id="LNNDetector-360"><a href="#LNNDetector-360"><span class="linenos">360</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LNNDetector-361"><a href="#LNNDetector-361"><span class="linenos">361</span></a>        
</span><span id="LNNDetector-362"><a href="#LNNDetector-362"><span class="linenos">362</span></a>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span><span id="LNNDetector-363"><a href="#LNNDetector-363"><span class="linenos">363</span></a>            <span class="k">for</span> <span class="n">seq_true</span> <span class="ow">in</span> <span class="n">X_tensor</span><span class="p">:</span>
</span><span id="LNNDetector-364"><a href="#LNNDetector-364"><span class="linenos">364</span></a>                <span class="n">seq_true</span> <span class="o">=</span> <span class="n">seq_true</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="LNNDetector-365"><a href="#LNNDetector-365"><span class="linenos">365</span></a>                <span class="n">seq_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">seq_true</span><span class="p">)</span>
</span><span id="LNNDetector-366"><a href="#LNNDetector-366"><span class="linenos">366</span></a>                <span class="n">seq_pred</span> <span class="o">=</span> <span class="n">seq_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">seq_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],))</span>
</span><span id="LNNDetector-367"><a href="#LNNDetector-367"><span class="linenos">367</span></a>                
</span><span id="LNNDetector-368"><a href="#LNNDetector-368"><span class="linenos">368</span></a>                <span class="c1"># Calculate L1 distance (reconstruction error)</span>
</span><span id="LNNDetector-369"><a href="#LNNDetector-369"><span class="linenos">369</span></a>                <span class="n">error</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">seq_pred</span> <span class="o">-</span> <span class="n">seq_true</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span><span id="LNNDetector-370"><a href="#LNNDetector-370"><span class="linenos">370</span></a>                <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</span><span id="LNNDetector-371"><a href="#LNNDetector-371"><span class="linenos">371</span></a>        
</span><span id="LNNDetector-372"><a href="#LNNDetector-372"><span class="linenos">372</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span><span id="LNNDetector-373"><a href="#LNNDetector-373"><span class="linenos">373</span></a>    
</span><span id="LNNDetector-374"><a href="#LNNDetector-374"><span class="linenos">374</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</span><span id="LNNDetector-375"><a href="#LNNDetector-375"><span class="linenos">375</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LNNDetector-376"><a href="#LNNDetector-376"><span class="linenos">376</span></a><span class="sd">        Save the model to disk.</span>
</span><span id="LNNDetector-377"><a href="#LNNDetector-377"><span class="linenos">377</span></a><span class="sd">        </span>
</span><span id="LNNDetector-378"><a href="#LNNDetector-378"><span class="linenos">378</span></a><span class="sd">        Args:</span>
</span><span id="LNNDetector-379"><a href="#LNNDetector-379"><span class="linenos">379</span></a>
</span><span id="LNNDetector-380"><a href="#LNNDetector-380"><span class="linenos">380</span></a><span class="sd">            path (str): File path to save the model</span>
</span><span id="LNNDetector-381"><a href="#LNNDetector-381"><span class="linenos">381</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LNNDetector-382"><a href="#LNNDetector-382"><span class="linenos">382</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="LNNDetector-383"><a href="#LNNDetector-383"><span class="linenos">383</span></a>        <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">({</span>
</span><span id="LNNDetector-384"><a href="#LNNDetector-384"><span class="linenos">384</span></a>            <span class="s1">&#39;model_state_dict&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
</span><span id="LNNDetector-385"><a href="#LNNDetector-385"><span class="linenos">385</span></a>            <span class="s1">&#39;optimizer_state_dict&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
</span><span id="LNNDetector-386"><a href="#LNNDetector-386"><span class="linenos">386</span></a>            <span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span>
</span><span id="LNNDetector-387"><a href="#LNNDetector-387"><span class="linenos">387</span></a>            <span class="s1">&#39;scaler&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span>
</span><span id="LNNDetector-388"><a href="#LNNDetector-388"><span class="linenos">388</span></a>        <span class="p">},</span> <span class="n">path</span><span class="p">)</span>
</span><span id="LNNDetector-389"><a href="#LNNDetector-389"><span class="linenos">389</span></a>        
</span><span id="LNNDetector-390"><a href="#LNNDetector-390"><span class="linenos">390</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</span><span id="LNNDetector-391"><a href="#LNNDetector-391"><span class="linenos">391</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LNNDetector-392"><a href="#LNNDetector-392"><span class="linenos">392</span></a><span class="sd">        Load the model from disk.</span>
</span><span id="LNNDetector-393"><a href="#LNNDetector-393"><span class="linenos">393</span></a><span class="sd">        </span>
</span><span id="LNNDetector-394"><a href="#LNNDetector-394"><span class="linenos">394</span></a><span class="sd">        Args:</span>
</span><span id="LNNDetector-395"><a href="#LNNDetector-395"><span class="linenos">395</span></a><span class="sd">        </span>
</span><span id="LNNDetector-396"><a href="#LNNDetector-396"><span class="linenos">396</span></a><span class="sd">            path (str): File path to load the model</span>
</span><span id="LNNDetector-397"><a href="#LNNDetector-397"><span class="linenos">397</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LNNDetector-398"><a href="#LNNDetector-398"><span class="linenos">398</span></a>        <span class="n">checkpoint</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="LNNDetector-399"><a href="#LNNDetector-399"><span class="linenos">399</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">&#39;model_state_dict&#39;</span><span class="p">])</span>
</span><span id="LNNDetector-400"><a href="#LNNDetector-400"><span class="linenos">400</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">&#39;optimizer_state_dict&#39;</span><span class="p">])</span>
</span><span id="LNNDetector-401"><a href="#LNNDetector-401"><span class="linenos">401</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">checkpoint</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span>
</span><span id="LNNDetector-402"><a href="#LNNDetector-402"><span class="linenos">402</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span> <span class="o">=</span> <span class="n">checkpoint</span><span class="p">[</span><span class="s1">&#39;scaler&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>LNN-based autoencoder anomaly detector.</p>

<p>This class implements an anomaly detector using a Liquid Neural Network-based
autoencoder for detecting anomalies in time series data, offering improved 
capability for handling complex temporal dynamics.</p>

<p>Args:
        - n_features (int): Dimension of input features</p>

<pre><code>    - seq_len (int): Length of input sequence

    - latent_dim (int): Dimension of the latent space representation

    - learning_rate (float): Learning rate for training the model

    - epochs (int): Number of epochs for training the model

    - threshold_multiplier (float): Anomaly threshold multiplier
</code></pre>
</div>


                            <div id="LNNDetector.fit" class="classattr">
                                        <input id="LNNDetector.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">X_test</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LNNDetector.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LNNDetector.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LNNDetector.fit-201"><a href="#LNNDetector.fit-201"><span class="linenos">201</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">X_test</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="LNNDetector.fit-202"><a href="#LNNDetector.fit-202"><span class="linenos">202</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LNNDetector.fit-203"><a href="#LNNDetector.fit-203"><span class="linenos">203</span></a><span class="sd">        Fit the LNN-based anomaly detector to the input data.</span>
</span><span id="LNNDetector.fit-204"><a href="#LNNDetector.fit-204"><span class="linenos">204</span></a><span class="sd">        </span>
</span><span id="LNNDetector.fit-205"><a href="#LNNDetector.fit-205"><span class="linenos">205</span></a><span class="sd">        Args:</span>
</span><span id="LNNDetector.fit-206"><a href="#LNNDetector.fit-206"><span class="linenos">206</span></a>
</span><span id="LNNDetector.fit-207"><a href="#LNNDetector.fit-207"><span class="linenos">207</span></a><span class="sd">            - X (np.ndarray): Input data for training the model</span>
</span><span id="LNNDetector.fit-208"><a href="#LNNDetector.fit-208"><span class="linenos">208</span></a>
</span><span id="LNNDetector.fit-209"><a href="#LNNDetector.fit-209"><span class="linenos">209</span></a><span class="sd">            - X_test (np.ndarray, optional): Test data for validation</span>
</span><span id="LNNDetector.fit-210"><a href="#LNNDetector.fit-210"><span class="linenos">210</span></a><span class="sd">            verbose (bool): Whether to print training progress</span>
</span><span id="LNNDetector.fit-211"><a href="#LNNDetector.fit-211"><span class="linenos">211</span></a><span class="sd">        </span>
</span><span id="LNNDetector.fit-212"><a href="#LNNDetector.fit-212"><span class="linenos">212</span></a><span class="sd">        Returns:</span>
</span><span id="LNNDetector.fit-213"><a href="#LNNDetector.fit-213"><span class="linenos">213</span></a>
</span><span id="LNNDetector.fit-214"><a href="#LNNDetector.fit-214"><span class="linenos">214</span></a><span class="sd">            dict: Training history</span>
</span><span id="LNNDetector.fit-215"><a href="#LNNDetector.fit-215"><span class="linenos">215</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LNNDetector.fit-216"><a href="#LNNDetector.fit-216"><span class="linenos">216</span></a>        <span class="c1"># Use input data directly without scaling</span>
</span><span id="LNNDetector.fit-217"><a href="#LNNDetector.fit-217"><span class="linenos">217</span></a>        <span class="n">X_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LNNDetector.fit-218"><a href="#LNNDetector.fit-218"><span class="linenos">218</span></a>        
</span><span id="LNNDetector.fit-219"><a href="#LNNDetector.fit-219"><span class="linenos">219</span></a>        <span class="k">if</span> <span class="n">X_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LNNDetector.fit-220"><a href="#LNNDetector.fit-220"><span class="linenos">220</span></a>            <span class="n">X_test_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LNNDetector.fit-221"><a href="#LNNDetector.fit-221"><span class="linenos">221</span></a>        
</span><span id="LNNDetector.fit-222"><a href="#LNNDetector.fit-222"><span class="linenos">222</span></a>        <span class="n">best_loss</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
</span><span id="LNNDetector.fit-223"><a href="#LNNDetector.fit-223"><span class="linenos">223</span></a>        <span class="n">best_model_wts</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">())</span>
</span><span id="LNNDetector.fit-224"><a href="#LNNDetector.fit-224"><span class="linenos">224</span></a>        
</span><span id="LNNDetector.fit-225"><a href="#LNNDetector.fit-225"><span class="linenos">225</span></a>        <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="p">):</span>
</span><span id="LNNDetector.fit-226"><a href="#LNNDetector.fit-226"><span class="linenos">226</span></a>            <span class="c1"># Training phase</span>
</span><span id="LNNDetector.fit-227"><a href="#LNNDetector.fit-227"><span class="linenos">227</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</span><span id="LNNDetector.fit-228"><a href="#LNNDetector.fit-228"><span class="linenos">228</span></a>            <span class="n">train_losses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LNNDetector.fit-229"><a href="#LNNDetector.fit-229"><span class="linenos">229</span></a>            
</span><span id="LNNDetector.fit-230"><a href="#LNNDetector.fit-230"><span class="linenos">230</span></a>            <span class="k">for</span> <span class="n">seq_true</span> <span class="ow">in</span> <span class="n">X_tensor</span><span class="p">:</span>
</span><span id="LNNDetector.fit-231"><a href="#LNNDetector.fit-231"><span class="linenos">231</span></a>                <span class="n">seq_true</span> <span class="o">=</span> <span class="n">seq_true</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="LNNDetector.fit-232"><a href="#LNNDetector.fit-232"><span class="linenos">232</span></a>                <span class="n">seq_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">seq_true</span><span class="p">)</span>
</span><span id="LNNDetector.fit-233"><a href="#LNNDetector.fit-233"><span class="linenos">233</span></a>                <span class="n">seq_pred</span> <span class="o">=</span> <span class="n">seq_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">seq_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],))</span>
</span><span id="LNNDetector.fit-234"><a href="#LNNDetector.fit-234"><span class="linenos">234</span></a>                <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criterion</span><span class="p">(</span><span class="n">seq_pred</span><span class="p">,</span> <span class="n">seq_true</span><span class="p">)</span>
</span><span id="LNNDetector.fit-235"><a href="#LNNDetector.fit-235"><span class="linenos">235</span></a>                
</span><span id="LNNDetector.fit-236"><a href="#LNNDetector.fit-236"><span class="linenos">236</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
</span><span id="LNNDetector.fit-237"><a href="#LNNDetector.fit-237"><span class="linenos">237</span></a>                <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</span><span id="LNNDetector.fit-238"><a href="#LNNDetector.fit-238"><span class="linenos">238</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</span><span id="LNNDetector.fit-239"><a href="#LNNDetector.fit-239"><span class="linenos">239</span></a>                
</span><span id="LNNDetector.fit-240"><a href="#LNNDetector.fit-240"><span class="linenos">240</span></a>                <span class="n">train_losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</span><span id="LNNDetector.fit-241"><a href="#LNNDetector.fit-241"><span class="linenos">241</span></a>            
</span><span id="LNNDetector.fit-242"><a href="#LNNDetector.fit-242"><span class="linenos">242</span></a>            <span class="n">train_loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">train_losses</span><span class="p">)</span>
</span><span id="LNNDetector.fit-243"><a href="#LNNDetector.fit-243"><span class="linenos">243</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_loss</span><span class="p">)</span>
</span><span id="LNNDetector.fit-244"><a href="#LNNDetector.fit-244"><span class="linenos">244</span></a>            
</span><span id="LNNDetector.fit-245"><a href="#LNNDetector.fit-245"><span class="linenos">245</span></a>            <span class="c1"># Validation phase</span>
</span><span id="LNNDetector.fit-246"><a href="#LNNDetector.fit-246"><span class="linenos">246</span></a>            <span class="n">val_loss</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LNNDetector.fit-247"><a href="#LNNDetector.fit-247"><span class="linenos">247</span></a>            <span class="k">if</span> <span class="n">X_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LNNDetector.fit-248"><a href="#LNNDetector.fit-248"><span class="linenos">248</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span><span id="LNNDetector.fit-249"><a href="#LNNDetector.fit-249"><span class="linenos">249</span></a>                <span class="n">val_losses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LNNDetector.fit-250"><a href="#LNNDetector.fit-250"><span class="linenos">250</span></a>                
</span><span id="LNNDetector.fit-251"><a href="#LNNDetector.fit-251"><span class="linenos">251</span></a>                <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span><span id="LNNDetector.fit-252"><a href="#LNNDetector.fit-252"><span class="linenos">252</span></a>                    <span class="k">for</span> <span class="n">seq_true</span> <span class="ow">in</span> <span class="n">X_test_tensor</span><span class="p">:</span>
</span><span id="LNNDetector.fit-253"><a href="#LNNDetector.fit-253"><span class="linenos">253</span></a>                        <span class="n">seq_true</span> <span class="o">=</span> <span class="n">seq_true</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="LNNDetector.fit-254"><a href="#LNNDetector.fit-254"><span class="linenos">254</span></a>                        <span class="n">seq_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">seq_true</span><span class="p">)</span>
</span><span id="LNNDetector.fit-255"><a href="#LNNDetector.fit-255"><span class="linenos">255</span></a>                        <span class="n">seq_pred</span> <span class="o">=</span> <span class="n">seq_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">seq_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],))</span>
</span><span id="LNNDetector.fit-256"><a href="#LNNDetector.fit-256"><span class="linenos">256</span></a>                        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criterion</span><span class="p">(</span><span class="n">seq_pred</span><span class="p">,</span> <span class="n">seq_true</span><span class="p">)</span>
</span><span id="LNNDetector.fit-257"><a href="#LNNDetector.fit-257"><span class="linenos">257</span></a>                        <span class="n">val_losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</span><span id="LNNDetector.fit-258"><a href="#LNNDetector.fit-258"><span class="linenos">258</span></a>                
</span><span id="LNNDetector.fit-259"><a href="#LNNDetector.fit-259"><span class="linenos">259</span></a>                <span class="n">val_loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">val_losses</span><span class="p">)</span>
</span><span id="LNNDetector.fit-260"><a href="#LNNDetector.fit-260"><span class="linenos">260</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val_loss</span><span class="p">)</span>
</span><span id="LNNDetector.fit-261"><a href="#LNNDetector.fit-261"><span class="linenos">261</span></a>                
</span><span id="LNNDetector.fit-262"><a href="#LNNDetector.fit-262"><span class="linenos">262</span></a>                <span class="k">if</span> <span class="n">val_loss</span> <span class="o">&lt;</span> <span class="n">best_loss</span><span class="p">:</span>
</span><span id="LNNDetector.fit-263"><a href="#LNNDetector.fit-263"><span class="linenos">263</span></a>                    <span class="n">best_loss</span> <span class="o">=</span> <span class="n">val_loss</span>
</span><span id="LNNDetector.fit-264"><a href="#LNNDetector.fit-264"><span class="linenos">264</span></a>                    <span class="n">best_model_wts</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">())</span>
</span><span id="LNNDetector.fit-265"><a href="#LNNDetector.fit-265"><span class="linenos">265</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="LNNDetector.fit-266"><a href="#LNNDetector.fit-266"><span class="linenos">266</span></a>                <span class="k">if</span> <span class="n">train_loss</span> <span class="o">&lt;</span> <span class="n">best_loss</span><span class="p">:</span>
</span><span id="LNNDetector.fit-267"><a href="#LNNDetector.fit-267"><span class="linenos">267</span></a>                    <span class="n">best_loss</span> <span class="o">=</span> <span class="n">train_loss</span>
</span><span id="LNNDetector.fit-268"><a href="#LNNDetector.fit-268"><span class="linenos">268</span></a>                    <span class="n">best_model_wts</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">())</span>
</span><span id="LNNDetector.fit-269"><a href="#LNNDetector.fit-269"><span class="linenos">269</span></a>            
</span><span id="LNNDetector.fit-270"><a href="#LNNDetector.fit-270"><span class="linenos">270</span></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="LNNDetector.fit-271"><a href="#LNNDetector.fit-271"><span class="linenos">271</span></a>                <span class="n">log_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Epoch </span><span class="si">{</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="si">}</span><span class="s1">, Train Loss: </span><span class="si">{</span><span class="n">train_loss</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="LNNDetector.fit-272"><a href="#LNNDetector.fit-272"><span class="linenos">272</span></a>                <span class="k">if</span> <span class="n">val_loss</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LNNDetector.fit-273"><a href="#LNNDetector.fit-273"><span class="linenos">273</span></a>                    <span class="n">log_message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;, Val Loss: </span><span class="si">{</span><span class="n">val_loss</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="LNNDetector.fit-274"><a href="#LNNDetector.fit-274"><span class="linenos">274</span></a>                <span class="nb">print</span><span class="p">(</span><span class="n">log_message</span><span class="p">)</span>
</span><span id="LNNDetector.fit-275"><a href="#LNNDetector.fit-275"><span class="linenos">275</span></a>        
</span><span id="LNNDetector.fit-276"><a href="#LNNDetector.fit-276"><span class="linenos">276</span></a>        <span class="c1"># Load the best model</span>
</span><span id="LNNDetector.fit-277"><a href="#LNNDetector.fit-277"><span class="linenos">277</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">best_model_wts</span><span class="p">)</span>
</span><span id="LNNDetector.fit-278"><a href="#LNNDetector.fit-278"><span class="linenos">278</span></a>        
</span><span id="LNNDetector.fit-279"><a href="#LNNDetector.fit-279"><span class="linenos">279</span></a>        <span class="c1"># Calculate threshold based on training data</span>
</span><span id="LNNDetector.fit-280"><a href="#LNNDetector.fit-280"><span class="linenos">280</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_threshold</span><span class="p">(</span><span class="n">X_tensor</span><span class="p">)</span>
</span><span id="LNNDetector.fit-281"><a href="#LNNDetector.fit-281"><span class="linenos">281</span></a>        
</span><span id="LNNDetector.fit-282"><a href="#LNNDetector.fit-282"><span class="linenos">282</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">history</span>
</span></pre></div>


            <div class="docstring"><p>Fit the LNN-based anomaly detector to the input data.</p>

<p>Args:</p>

<pre><code>- X (np.ndarray): Input data for training the model

- X_test (np.ndarray, optional): Test data for validation
verbose (bool): Whether to print training progress
</code></pre>

<p>Returns:</p>

<pre><code>dict: Training history
</code></pre>
</div>


                            </div>
                            <div id="LNNDetector.predict" class="classattr">
                                        <input id="LNNDetector.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LNNDetector.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LNNDetector.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LNNDetector.predict-314"><a href="#LNNDetector.predict-314"><span class="linenos">314</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="LNNDetector.predict-315"><a href="#LNNDetector.predict-315"><span class="linenos">315</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LNNDetector.predict-316"><a href="#LNNDetector.predict-316"><span class="linenos">316</span></a><span class="sd">        Predict anomalies in the input data.</span>
</span><span id="LNNDetector.predict-317"><a href="#LNNDetector.predict-317"><span class="linenos">317</span></a><span class="sd">        </span>
</span><span id="LNNDetector.predict-318"><a href="#LNNDetector.predict-318"><span class="linenos">318</span></a><span class="sd">        Args:</span>
</span><span id="LNNDetector.predict-319"><a href="#LNNDetector.predict-319"><span class="linenos">319</span></a>
</span><span id="LNNDetector.predict-320"><a href="#LNNDetector.predict-320"><span class="linenos">320</span></a><span class="sd">            X (np.ndarray): Input data for anomaly detection</span>
</span><span id="LNNDetector.predict-321"><a href="#LNNDetector.predict-321"><span class="linenos">321</span></a><span class="sd">            </span>
</span><span id="LNNDetector.predict-322"><a href="#LNNDetector.predict-322"><span class="linenos">322</span></a><span class="sd">        Returns:</span>
</span><span id="LNNDetector.predict-323"><a href="#LNNDetector.predict-323"><span class="linenos">323</span></a>
</span><span id="LNNDetector.predict-324"><a href="#LNNDetector.predict-324"><span class="linenos">324</span></a><span class="sd">            np.ndarray: Binary array where 1 indicates anomaly, 0 indicates normal</span>
</span><span id="LNNDetector.predict-325"><a href="#LNNDetector.predict-325"><span class="linenos">325</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LNNDetector.predict-326"><a href="#LNNDetector.predict-326"><span class="linenos">326</span></a>        <span class="n">X_scaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="LNNDetector.predict-327"><a href="#LNNDetector.predict-327"><span class="linenos">327</span></a>        <span class="n">X_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LNNDetector.predict-328"><a href="#LNNDetector.predict-328"><span class="linenos">328</span></a>        
</span><span id="LNNDetector.predict-329"><a href="#LNNDetector.predict-329"><span class="linenos">329</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span><span id="LNNDetector.predict-330"><a href="#LNNDetector.predict-330"><span class="linenos">330</span></a>        <span class="n">anomalies</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LNNDetector.predict-331"><a href="#LNNDetector.predict-331"><span class="linenos">331</span></a>        
</span><span id="LNNDetector.predict-332"><a href="#LNNDetector.predict-332"><span class="linenos">332</span></a>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span><span id="LNNDetector.predict-333"><a href="#LNNDetector.predict-333"><span class="linenos">333</span></a>            <span class="k">for</span> <span class="n">seq_true</span> <span class="ow">in</span> <span class="n">X_tensor</span><span class="p">:</span>
</span><span id="LNNDetector.predict-334"><a href="#LNNDetector.predict-334"><span class="linenos">334</span></a>                <span class="n">seq_true</span> <span class="o">=</span> <span class="n">seq_true</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="LNNDetector.predict-335"><a href="#LNNDetector.predict-335"><span class="linenos">335</span></a>                <span class="n">seq_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">seq_true</span><span class="p">)</span>
</span><span id="LNNDetector.predict-336"><a href="#LNNDetector.predict-336"><span class="linenos">336</span></a>                <span class="n">seq_pred</span> <span class="o">=</span> <span class="n">seq_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">seq_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],))</span>
</span><span id="LNNDetector.predict-337"><a href="#LNNDetector.predict-337"><span class="linenos">337</span></a>                
</span><span id="LNNDetector.predict-338"><a href="#LNNDetector.predict-338"><span class="linenos">338</span></a>                <span class="c1"># Calculate L1 distance (reconstruction error)</span>
</span><span id="LNNDetector.predict-339"><a href="#LNNDetector.predict-339"><span class="linenos">339</span></a>                <span class="n">error</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">seq_pred</span> <span class="o">-</span> <span class="n">seq_true</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span><span id="LNNDetector.predict-340"><a href="#LNNDetector.predict-340"><span class="linenos">340</span></a>                <span class="n">anomalies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">error</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="LNNDetector.predict-341"><a href="#LNNDetector.predict-341"><span class="linenos">341</span></a>        
</span><span id="LNNDetector.predict-342"><a href="#LNNDetector.predict-342"><span class="linenos">342</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">anomalies</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict anomalies in the input data.</p>

<p>Args:</p>

<pre><code>X (np.ndarray): Input data for anomaly detection
</code></pre>

<p>Returns:</p>

<pre><code>np.ndarray: Binary array where 1 indicates anomaly, 0 indicates normal
</code></pre>
</div>


                            </div>
                            <div id="LNNDetector.anomaly_score" class="classattr">
                                        <input id="LNNDetector.anomaly_score-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">anomaly_score</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LNNDetector.anomaly_score-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LNNDetector.anomaly_score"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LNNDetector.anomaly_score-344"><a href="#LNNDetector.anomaly_score-344"><span class="linenos">344</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">anomaly_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="LNNDetector.anomaly_score-345"><a href="#LNNDetector.anomaly_score-345"><span class="linenos">345</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LNNDetector.anomaly_score-346"><a href="#LNNDetector.anomaly_score-346"><span class="linenos">346</span></a><span class="sd">        Calculate anomaly scores for the input data.</span>
</span><span id="LNNDetector.anomaly_score-347"><a href="#LNNDetector.anomaly_score-347"><span class="linenos">347</span></a><span class="sd">        </span>
</span><span id="LNNDetector.anomaly_score-348"><a href="#LNNDetector.anomaly_score-348"><span class="linenos">348</span></a><span class="sd">        Args:</span>
</span><span id="LNNDetector.anomaly_score-349"><a href="#LNNDetector.anomaly_score-349"><span class="linenos">349</span></a>
</span><span id="LNNDetector.anomaly_score-350"><a href="#LNNDetector.anomaly_score-350"><span class="linenos">350</span></a><span class="sd">            X (np.ndarray): Input data for anomaly detection</span>
</span><span id="LNNDetector.anomaly_score-351"><a href="#LNNDetector.anomaly_score-351"><span class="linenos">351</span></a><span class="sd">        </span>
</span><span id="LNNDetector.anomaly_score-352"><a href="#LNNDetector.anomaly_score-352"><span class="linenos">352</span></a><span class="sd">        Returns:</span>
</span><span id="LNNDetector.anomaly_score-353"><a href="#LNNDetector.anomaly_score-353"><span class="linenos">353</span></a>
</span><span id="LNNDetector.anomaly_score-354"><a href="#LNNDetector.anomaly_score-354"><span class="linenos">354</span></a><span class="sd">            np.ndarray: Anomaly scores (reconstruction errors)</span>
</span><span id="LNNDetector.anomaly_score-355"><a href="#LNNDetector.anomaly_score-355"><span class="linenos">355</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LNNDetector.anomaly_score-356"><a href="#LNNDetector.anomaly_score-356"><span class="linenos">356</span></a>        <span class="n">X_scaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="LNNDetector.anomaly_score-357"><a href="#LNNDetector.anomaly_score-357"><span class="linenos">357</span></a>        <span class="n">X_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span><span id="LNNDetector.anomaly_score-358"><a href="#LNNDetector.anomaly_score-358"><span class="linenos">358</span></a>        
</span><span id="LNNDetector.anomaly_score-359"><a href="#LNNDetector.anomaly_score-359"><span class="linenos">359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span><span id="LNNDetector.anomaly_score-360"><a href="#LNNDetector.anomaly_score-360"><span class="linenos">360</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LNNDetector.anomaly_score-361"><a href="#LNNDetector.anomaly_score-361"><span class="linenos">361</span></a>        
</span><span id="LNNDetector.anomaly_score-362"><a href="#LNNDetector.anomaly_score-362"><span class="linenos">362</span></a>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span><span id="LNNDetector.anomaly_score-363"><a href="#LNNDetector.anomaly_score-363"><span class="linenos">363</span></a>            <span class="k">for</span> <span class="n">seq_true</span> <span class="ow">in</span> <span class="n">X_tensor</span><span class="p">:</span>
</span><span id="LNNDetector.anomaly_score-364"><a href="#LNNDetector.anomaly_score-364"><span class="linenos">364</span></a>                <span class="n">seq_true</span> <span class="o">=</span> <span class="n">seq_true</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="LNNDetector.anomaly_score-365"><a href="#LNNDetector.anomaly_score-365"><span class="linenos">365</span></a>                <span class="n">seq_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">seq_true</span><span class="p">)</span>
</span><span id="LNNDetector.anomaly_score-366"><a href="#LNNDetector.anomaly_score-366"><span class="linenos">366</span></a>                <span class="n">seq_pred</span> <span class="o">=</span> <span class="n">seq_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">seq_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],))</span>
</span><span id="LNNDetector.anomaly_score-367"><a href="#LNNDetector.anomaly_score-367"><span class="linenos">367</span></a>                
</span><span id="LNNDetector.anomaly_score-368"><a href="#LNNDetector.anomaly_score-368"><span class="linenos">368</span></a>                <span class="c1"># Calculate L1 distance (reconstruction error)</span>
</span><span id="LNNDetector.anomaly_score-369"><a href="#LNNDetector.anomaly_score-369"><span class="linenos">369</span></a>                <span class="n">error</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">seq_pred</span> <span class="o">-</span> <span class="n">seq_true</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span><span id="LNNDetector.anomaly_score-370"><a href="#LNNDetector.anomaly_score-370"><span class="linenos">370</span></a>                <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</span><span id="LNNDetector.anomaly_score-371"><a href="#LNNDetector.anomaly_score-371"><span class="linenos">371</span></a>        
</span><span id="LNNDetector.anomaly_score-372"><a href="#LNNDetector.anomaly_score-372"><span class="linenos">372</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Calculate anomaly scores for the input data.</p>

<p>Args:</p>

<pre><code>X (np.ndarray): Input data for anomaly detection
</code></pre>

<p>Returns:</p>

<pre><code>np.ndarray: Anomaly scores (reconstruction errors)
</code></pre>
</div>


                            </div>
                            <div id="LNNDetector.save_model" class="classattr">
                                        <input id="LNNDetector.save_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">path</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LNNDetector.save_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LNNDetector.save_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LNNDetector.save_model-374"><a href="#LNNDetector.save_model-374"><span class="linenos">374</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</span><span id="LNNDetector.save_model-375"><a href="#LNNDetector.save_model-375"><span class="linenos">375</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LNNDetector.save_model-376"><a href="#LNNDetector.save_model-376"><span class="linenos">376</span></a><span class="sd">        Save the model to disk.</span>
</span><span id="LNNDetector.save_model-377"><a href="#LNNDetector.save_model-377"><span class="linenos">377</span></a><span class="sd">        </span>
</span><span id="LNNDetector.save_model-378"><a href="#LNNDetector.save_model-378"><span class="linenos">378</span></a><span class="sd">        Args:</span>
</span><span id="LNNDetector.save_model-379"><a href="#LNNDetector.save_model-379"><span class="linenos">379</span></a>
</span><span id="LNNDetector.save_model-380"><a href="#LNNDetector.save_model-380"><span class="linenos">380</span></a><span class="sd">            path (str): File path to save the model</span>
</span><span id="LNNDetector.save_model-381"><a href="#LNNDetector.save_model-381"><span class="linenos">381</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LNNDetector.save_model-382"><a href="#LNNDetector.save_model-382"><span class="linenos">382</span></a>        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="LNNDetector.save_model-383"><a href="#LNNDetector.save_model-383"><span class="linenos">383</span></a>        <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">({</span>
</span><span id="LNNDetector.save_model-384"><a href="#LNNDetector.save_model-384"><span class="linenos">384</span></a>            <span class="s1">&#39;model_state_dict&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
</span><span id="LNNDetector.save_model-385"><a href="#LNNDetector.save_model-385"><span class="linenos">385</span></a>            <span class="s1">&#39;optimizer_state_dict&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
</span><span id="LNNDetector.save_model-386"><a href="#LNNDetector.save_model-386"><span class="linenos">386</span></a>            <span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span>
</span><span id="LNNDetector.save_model-387"><a href="#LNNDetector.save_model-387"><span class="linenos">387</span></a>            <span class="s1">&#39;scaler&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="p">,</span>
</span><span id="LNNDetector.save_model-388"><a href="#LNNDetector.save_model-388"><span class="linenos">388</span></a>        <span class="p">},</span> <span class="n">path</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Save the model to disk.</p>

<p>Args:</p>

<pre><code>path (str): File path to save the model
</code></pre>
</div>


                            </div>
                            <div id="LNNDetector.load_model" class="classattr">
                                        <input id="LNNDetector.load_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">path</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LNNDetector.load_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LNNDetector.load_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LNNDetector.load_model-390"><a href="#LNNDetector.load_model-390"><span class="linenos">390</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</span><span id="LNNDetector.load_model-391"><a href="#LNNDetector.load_model-391"><span class="linenos">391</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LNNDetector.load_model-392"><a href="#LNNDetector.load_model-392"><span class="linenos">392</span></a><span class="sd">        Load the model from disk.</span>
</span><span id="LNNDetector.load_model-393"><a href="#LNNDetector.load_model-393"><span class="linenos">393</span></a><span class="sd">        </span>
</span><span id="LNNDetector.load_model-394"><a href="#LNNDetector.load_model-394"><span class="linenos">394</span></a><span class="sd">        Args:</span>
</span><span id="LNNDetector.load_model-395"><a href="#LNNDetector.load_model-395"><span class="linenos">395</span></a><span class="sd">        </span>
</span><span id="LNNDetector.load_model-396"><a href="#LNNDetector.load_model-396"><span class="linenos">396</span></a><span class="sd">            path (str): File path to load the model</span>
</span><span id="LNNDetector.load_model-397"><a href="#LNNDetector.load_model-397"><span class="linenos">397</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LNNDetector.load_model-398"><a href="#LNNDetector.load_model-398"><span class="linenos">398</span></a>        <span class="n">checkpoint</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="LNNDetector.load_model-399"><a href="#LNNDetector.load_model-399"><span class="linenos">399</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">&#39;model_state_dict&#39;</span><span class="p">])</span>
</span><span id="LNNDetector.load_model-400"><a href="#LNNDetector.load_model-400"><span class="linenos">400</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">&#39;optimizer_state_dict&#39;</span><span class="p">])</span>
</span><span id="LNNDetector.load_model-401"><a href="#LNNDetector.load_model-401"><span class="linenos">401</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">checkpoint</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span>
</span><span id="LNNDetector.load_model-402"><a href="#LNNDetector.load_model-402"><span class="linenos">402</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span> <span class="o">=</span> <span class="n">checkpoint</span><span class="p">[</span><span class="s1">&#39;scaler&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Load the model from disk.</p>

<p>Args:</p>

<pre><code>path (str): File path to load the model
</code></pre>
</div>


                            </div>
                </section>
                <section id="BaseCustomDetector">
                            <input id="BaseCustomDetector-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">BaseCustomDetector</span><wbr>(<span class="base">abc.ABC</span>):

                <label class="view-source-button" for="BaseCustomDetector-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaseCustomDetector"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseCustomDetector-13"><a href="#BaseCustomDetector-13"><span class="linenos">13</span></a><span class="k">class</span><span class="w"> </span><span class="nc">BaseCustomDetector</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="BaseCustomDetector-14"><a href="#BaseCustomDetector-14"><span class="linenos">14</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector-15"><a href="#BaseCustomDetector-15"><span class="linenos">15</span></a><span class="sd">    Abstract base class for all custom anomaly detectors.</span>
</span><span id="BaseCustomDetector-16"><a href="#BaseCustomDetector-16"><span class="linenos">16</span></a><span class="sd">    </span>
</span><span id="BaseCustomDetector-17"><a href="#BaseCustomDetector-17"><span class="linenos">17</span></a><span class="sd">    Users must subclass this and implement the required methods.</span>
</span><span id="BaseCustomDetector-18"><a href="#BaseCustomDetector-18"><span class="linenos">18</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector-19"><a href="#BaseCustomDetector-19"><span class="linenos">19</span></a>
</span><span id="BaseCustomDetector-20"><a href="#BaseCustomDetector-20"><span class="linenos">20</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseCustomDetector-21"><a href="#BaseCustomDetector-21"><span class="linenos">21</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector-22"><a href="#BaseCustomDetector-22"><span class="linenos">22</span></a><span class="sd">        Optional initialization.</span>
</span><span id="BaseCustomDetector-23"><a href="#BaseCustomDetector-23"><span class="linenos">23</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector-24"><a href="#BaseCustomDetector-24"><span class="linenos">24</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="BaseCustomDetector-25"><a href="#BaseCustomDetector-25"><span class="linenos">25</span></a>
</span><span id="BaseCustomDetector-26"><a href="#BaseCustomDetector-26"><span class="linenos">26</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BaseCustomDetector-27"><a href="#BaseCustomDetector-27"><span class="linenos">27</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseCustomDetector-28"><a href="#BaseCustomDetector-28"><span class="linenos">28</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector-29"><a href="#BaseCustomDetector-29"><span class="linenos">29</span></a><span class="sd">        Fit the model to training data.</span>
</span><span id="BaseCustomDetector-30"><a href="#BaseCustomDetector-30"><span class="linenos">30</span></a>
</span><span id="BaseCustomDetector-31"><a href="#BaseCustomDetector-31"><span class="linenos">31</span></a><span class="sd">        Parameters</span>
</span><span id="BaseCustomDetector-32"><a href="#BaseCustomDetector-32"><span class="linenos">32</span></a><span class="sd">            </span>
</span><span id="BaseCustomDetector-33"><a href="#BaseCustomDetector-33"><span class="linenos">33</span></a><span class="sd">            - X : array-like of shape (n_samples, n_features)</span>
</span><span id="BaseCustomDetector-34"><a href="#BaseCustomDetector-34"><span class="linenos">34</span></a><span class="sd">                Training data.</span>
</span><span id="BaseCustomDetector-35"><a href="#BaseCustomDetector-35"><span class="linenos">35</span></a>
</span><span id="BaseCustomDetector-36"><a href="#BaseCustomDetector-36"><span class="linenos">36</span></a><span class="sd">            - y : Ignored (included for compatibility).</span>
</span><span id="BaseCustomDetector-37"><a href="#BaseCustomDetector-37"><span class="linenos">37</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector-38"><a href="#BaseCustomDetector-38"><span class="linenos">38</span></a>        <span class="k">pass</span>
</span><span id="BaseCustomDetector-39"><a href="#BaseCustomDetector-39"><span class="linenos">39</span></a>
</span><span id="BaseCustomDetector-40"><a href="#BaseCustomDetector-40"><span class="linenos">40</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BaseCustomDetector-41"><a href="#BaseCustomDetector-41"><span class="linenos">41</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="BaseCustomDetector-42"><a href="#BaseCustomDetector-42"><span class="linenos">42</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector-43"><a href="#BaseCustomDetector-43"><span class="linenos">43</span></a><span class="sd">        Predict binary labels (1 for anomaly, 0 for normal).</span>
</span><span id="BaseCustomDetector-44"><a href="#BaseCustomDetector-44"><span class="linenos">44</span></a>
</span><span id="BaseCustomDetector-45"><a href="#BaseCustomDetector-45"><span class="linenos">45</span></a><span class="sd">        Parameters</span>
</span><span id="BaseCustomDetector-46"><a href="#BaseCustomDetector-46"><span class="linenos">46</span></a><span class="sd">        </span>
</span><span id="BaseCustomDetector-47"><a href="#BaseCustomDetector-47"><span class="linenos">47</span></a><span class="sd">            X : array-like of shape (n_samples, n_features)</span>
</span><span id="BaseCustomDetector-48"><a href="#BaseCustomDetector-48"><span class="linenos">48</span></a><span class="sd">                Data to predict on.</span>
</span><span id="BaseCustomDetector-49"><a href="#BaseCustomDetector-49"><span class="linenos">49</span></a>
</span><span id="BaseCustomDetector-50"><a href="#BaseCustomDetector-50"><span class="linenos">50</span></a><span class="sd">        Returns</span>
</span><span id="BaseCustomDetector-51"><a href="#BaseCustomDetector-51"><span class="linenos">51</span></a><span class="sd">        </span>
</span><span id="BaseCustomDetector-52"><a href="#BaseCustomDetector-52"><span class="linenos">52</span></a><span class="sd">            array-like of shape (n_samples,)</span>
</span><span id="BaseCustomDetector-53"><a href="#BaseCustomDetector-53"><span class="linenos">53</span></a><span class="sd">                Binary predictions: 1 for anomaly, 0 for normal.</span>
</span><span id="BaseCustomDetector-54"><a href="#BaseCustomDetector-54"><span class="linenos">54</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector-55"><a href="#BaseCustomDetector-55"><span class="linenos">55</span></a>        <span class="k">pass</span>
</span><span id="BaseCustomDetector-56"><a href="#BaseCustomDetector-56"><span class="linenos">56</span></a>
</span><span id="BaseCustomDetector-57"><a href="#BaseCustomDetector-57"><span class="linenos">57</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">anomaly_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="BaseCustomDetector-58"><a href="#BaseCustomDetector-58"><span class="linenos">58</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector-59"><a href="#BaseCustomDetector-59"><span class="linenos">59</span></a><span class="sd">        Compute anomaly scores for input data.</span>
</span><span id="BaseCustomDetector-60"><a href="#BaseCustomDetector-60"><span class="linenos">60</span></a>
</span><span id="BaseCustomDetector-61"><a href="#BaseCustomDetector-61"><span class="linenos">61</span></a><span class="sd">        Parameters</span>
</span><span id="BaseCustomDetector-62"><a href="#BaseCustomDetector-62"><span class="linenos">62</span></a><span class="sd">        </span>
</span><span id="BaseCustomDetector-63"><a href="#BaseCustomDetector-63"><span class="linenos">63</span></a><span class="sd">            X : array-like of shape (n_samples, n_features)</span>
</span><span id="BaseCustomDetector-64"><a href="#BaseCustomDetector-64"><span class="linenos">64</span></a>
</span><span id="BaseCustomDetector-65"><a href="#BaseCustomDetector-65"><span class="linenos">65</span></a><span class="sd">        Returns</span>
</span><span id="BaseCustomDetector-66"><a href="#BaseCustomDetector-66"><span class="linenos">66</span></a><span class="sd">        </span>
</span><span id="BaseCustomDetector-67"><a href="#BaseCustomDetector-67"><span class="linenos">67</span></a><span class="sd">            array-like of shape (n_samples,)</span>
</span><span id="BaseCustomDetector-68"><a href="#BaseCustomDetector-68"><span class="linenos">68</span></a><span class="sd">                Anomaly scores (higher = more anomalous).</span>
</span><span id="BaseCustomDetector-69"><a href="#BaseCustomDetector-69"><span class="linenos">69</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector-70"><a href="#BaseCustomDetector-70"><span class="linenos">70</span></a>        <span class="c1"># Optional: Override for detectors that support scoring</span>
</span><span id="BaseCustomDetector-71"><a href="#BaseCustomDetector-71"><span class="linenos">71</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</span><span id="BaseCustomDetector-72"><a href="#BaseCustomDetector-72"><span class="linenos">72</span></a>
</span><span id="BaseCustomDetector-73"><a href="#BaseCustomDetector-73"><span class="linenos">73</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</span><span id="BaseCustomDetector-74"><a href="#BaseCustomDetector-74"><span class="linenos">74</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector-75"><a href="#BaseCustomDetector-75"><span class="linenos">75</span></a><span class="sd">        Optional method to save model to disk.</span>
</span><span id="BaseCustomDetector-76"><a href="#BaseCustomDetector-76"><span class="linenos">76</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector-77"><a href="#BaseCustomDetector-77"><span class="linenos">77</span></a>        <span class="k">pass</span>
</span><span id="BaseCustomDetector-78"><a href="#BaseCustomDetector-78"><span class="linenos">78</span></a>
</span><span id="BaseCustomDetector-79"><a href="#BaseCustomDetector-79"><span class="linenos">79</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</span><span id="BaseCustomDetector-80"><a href="#BaseCustomDetector-80"><span class="linenos">80</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector-81"><a href="#BaseCustomDetector-81"><span class="linenos">81</span></a><span class="sd">        Optional method to load model from disk.</span>
</span><span id="BaseCustomDetector-82"><a href="#BaseCustomDetector-82"><span class="linenos">82</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector-83"><a href="#BaseCustomDetector-83"><span class="linenos">83</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Abstract base class for all custom anomaly detectors.</p>

<p>Users must subclass this and implement the required methods.</p>
</div>


                            <div id="BaseCustomDetector.__init__" class="classattr">
                                        <input id="BaseCustomDetector.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">BaseCustomDetector</span><span class="signature pdoc-code condensed">()</span>

                <label class="view-source-button" for="BaseCustomDetector.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaseCustomDetector.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseCustomDetector.__init__-20"><a href="#BaseCustomDetector.__init__-20"><span class="linenos">20</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseCustomDetector.__init__-21"><a href="#BaseCustomDetector.__init__-21"><span class="linenos">21</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector.__init__-22"><a href="#BaseCustomDetector.__init__-22"><span class="linenos">22</span></a><span class="sd">        Optional initialization.</span>
</span><span id="BaseCustomDetector.__init__-23"><a href="#BaseCustomDetector.__init__-23"><span class="linenos">23</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector.__init__-24"><a href="#BaseCustomDetector.__init__-24"><span class="linenos">24</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Optional initialization.</p>
</div>


                            </div>
                            <div id="BaseCustomDetector.fit" class="classattr">
                                        <input id="BaseCustomDetector.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BaseCustomDetector.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaseCustomDetector.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseCustomDetector.fit-26"><a href="#BaseCustomDetector.fit-26"><span class="linenos">26</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BaseCustomDetector.fit-27"><a href="#BaseCustomDetector.fit-27"><span class="linenos">27</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseCustomDetector.fit-28"><a href="#BaseCustomDetector.fit-28"><span class="linenos">28</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector.fit-29"><a href="#BaseCustomDetector.fit-29"><span class="linenos">29</span></a><span class="sd">        Fit the model to training data.</span>
</span><span id="BaseCustomDetector.fit-30"><a href="#BaseCustomDetector.fit-30"><span class="linenos">30</span></a>
</span><span id="BaseCustomDetector.fit-31"><a href="#BaseCustomDetector.fit-31"><span class="linenos">31</span></a><span class="sd">        Parameters</span>
</span><span id="BaseCustomDetector.fit-32"><a href="#BaseCustomDetector.fit-32"><span class="linenos">32</span></a><span class="sd">            </span>
</span><span id="BaseCustomDetector.fit-33"><a href="#BaseCustomDetector.fit-33"><span class="linenos">33</span></a><span class="sd">            - X : array-like of shape (n_samples, n_features)</span>
</span><span id="BaseCustomDetector.fit-34"><a href="#BaseCustomDetector.fit-34"><span class="linenos">34</span></a><span class="sd">                Training data.</span>
</span><span id="BaseCustomDetector.fit-35"><a href="#BaseCustomDetector.fit-35"><span class="linenos">35</span></a>
</span><span id="BaseCustomDetector.fit-36"><a href="#BaseCustomDetector.fit-36"><span class="linenos">36</span></a><span class="sd">            - y : Ignored (included for compatibility).</span>
</span><span id="BaseCustomDetector.fit-37"><a href="#BaseCustomDetector.fit-37"><span class="linenos">37</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector.fit-38"><a href="#BaseCustomDetector.fit-38"><span class="linenos">38</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Fit the model to training data.</p>

<p>Parameters</p>

<pre><code>- X : array-like of shape (n_samples, n_features)
    Training data.

- y : Ignored (included for compatibility).
</code></pre>
</div>


                            </div>
                            <div id="BaseCustomDetector.predict" class="classattr">
                                        <input id="BaseCustomDetector.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BaseCustomDetector.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaseCustomDetector.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseCustomDetector.predict-40"><a href="#BaseCustomDetector.predict-40"><span class="linenos">40</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BaseCustomDetector.predict-41"><a href="#BaseCustomDetector.predict-41"><span class="linenos">41</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="BaseCustomDetector.predict-42"><a href="#BaseCustomDetector.predict-42"><span class="linenos">42</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector.predict-43"><a href="#BaseCustomDetector.predict-43"><span class="linenos">43</span></a><span class="sd">        Predict binary labels (1 for anomaly, 0 for normal).</span>
</span><span id="BaseCustomDetector.predict-44"><a href="#BaseCustomDetector.predict-44"><span class="linenos">44</span></a>
</span><span id="BaseCustomDetector.predict-45"><a href="#BaseCustomDetector.predict-45"><span class="linenos">45</span></a><span class="sd">        Parameters</span>
</span><span id="BaseCustomDetector.predict-46"><a href="#BaseCustomDetector.predict-46"><span class="linenos">46</span></a><span class="sd">        </span>
</span><span id="BaseCustomDetector.predict-47"><a href="#BaseCustomDetector.predict-47"><span class="linenos">47</span></a><span class="sd">            X : array-like of shape (n_samples, n_features)</span>
</span><span id="BaseCustomDetector.predict-48"><a href="#BaseCustomDetector.predict-48"><span class="linenos">48</span></a><span class="sd">                Data to predict on.</span>
</span><span id="BaseCustomDetector.predict-49"><a href="#BaseCustomDetector.predict-49"><span class="linenos">49</span></a>
</span><span id="BaseCustomDetector.predict-50"><a href="#BaseCustomDetector.predict-50"><span class="linenos">50</span></a><span class="sd">        Returns</span>
</span><span id="BaseCustomDetector.predict-51"><a href="#BaseCustomDetector.predict-51"><span class="linenos">51</span></a><span class="sd">        </span>
</span><span id="BaseCustomDetector.predict-52"><a href="#BaseCustomDetector.predict-52"><span class="linenos">52</span></a><span class="sd">            array-like of shape (n_samples,)</span>
</span><span id="BaseCustomDetector.predict-53"><a href="#BaseCustomDetector.predict-53"><span class="linenos">53</span></a><span class="sd">                Binary predictions: 1 for anomaly, 0 for normal.</span>
</span><span id="BaseCustomDetector.predict-54"><a href="#BaseCustomDetector.predict-54"><span class="linenos">54</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector.predict-55"><a href="#BaseCustomDetector.predict-55"><span class="linenos">55</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Predict binary labels (1 for anomaly, 0 for normal).</p>

<p>Parameters</p>

<pre><code>X : array-like of shape (n_samples, n_features)
    Data to predict on.
</code></pre>

<p>Returns</p>

<pre><code>array-like of shape (n_samples,)
    Binary predictions: 1 for anomaly, 0 for normal.
</code></pre>
</div>


                            </div>
                            <div id="BaseCustomDetector.anomaly_score" class="classattr">
                                        <input id="BaseCustomDetector.anomaly_score-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">anomaly_score</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BaseCustomDetector.anomaly_score-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaseCustomDetector.anomaly_score"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseCustomDetector.anomaly_score-57"><a href="#BaseCustomDetector.anomaly_score-57"><span class="linenos">57</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">anomaly_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="BaseCustomDetector.anomaly_score-58"><a href="#BaseCustomDetector.anomaly_score-58"><span class="linenos">58</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector.anomaly_score-59"><a href="#BaseCustomDetector.anomaly_score-59"><span class="linenos">59</span></a><span class="sd">        Compute anomaly scores for input data.</span>
</span><span id="BaseCustomDetector.anomaly_score-60"><a href="#BaseCustomDetector.anomaly_score-60"><span class="linenos">60</span></a>
</span><span id="BaseCustomDetector.anomaly_score-61"><a href="#BaseCustomDetector.anomaly_score-61"><span class="linenos">61</span></a><span class="sd">        Parameters</span>
</span><span id="BaseCustomDetector.anomaly_score-62"><a href="#BaseCustomDetector.anomaly_score-62"><span class="linenos">62</span></a><span class="sd">        </span>
</span><span id="BaseCustomDetector.anomaly_score-63"><a href="#BaseCustomDetector.anomaly_score-63"><span class="linenos">63</span></a><span class="sd">            X : array-like of shape (n_samples, n_features)</span>
</span><span id="BaseCustomDetector.anomaly_score-64"><a href="#BaseCustomDetector.anomaly_score-64"><span class="linenos">64</span></a>
</span><span id="BaseCustomDetector.anomaly_score-65"><a href="#BaseCustomDetector.anomaly_score-65"><span class="linenos">65</span></a><span class="sd">        Returns</span>
</span><span id="BaseCustomDetector.anomaly_score-66"><a href="#BaseCustomDetector.anomaly_score-66"><span class="linenos">66</span></a><span class="sd">        </span>
</span><span id="BaseCustomDetector.anomaly_score-67"><a href="#BaseCustomDetector.anomaly_score-67"><span class="linenos">67</span></a><span class="sd">            array-like of shape (n_samples,)</span>
</span><span id="BaseCustomDetector.anomaly_score-68"><a href="#BaseCustomDetector.anomaly_score-68"><span class="linenos">68</span></a><span class="sd">                Anomaly scores (higher = more anomalous).</span>
</span><span id="BaseCustomDetector.anomaly_score-69"><a href="#BaseCustomDetector.anomaly_score-69"><span class="linenos">69</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector.anomaly_score-70"><a href="#BaseCustomDetector.anomaly_score-70"><span class="linenos">70</span></a>        <span class="c1"># Optional: Override for detectors that support scoring</span>
</span><span id="BaseCustomDetector.anomaly_score-71"><a href="#BaseCustomDetector.anomaly_score-71"><span class="linenos">71</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Compute anomaly scores for input data.</p>

<p>Parameters</p>

<pre><code>X : array-like of shape (n_samples, n_features)
</code></pre>

<p>Returns</p>

<pre><code>array-like of shape (n_samples,)
    Anomaly scores (higher = more anomalous).
</code></pre>
</div>


                            </div>
                            <div id="BaseCustomDetector.save_model" class="classattr">
                                        <input id="BaseCustomDetector.save_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">path</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BaseCustomDetector.save_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaseCustomDetector.save_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseCustomDetector.save_model-73"><a href="#BaseCustomDetector.save_model-73"><span class="linenos">73</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</span><span id="BaseCustomDetector.save_model-74"><a href="#BaseCustomDetector.save_model-74"><span class="linenos">74</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector.save_model-75"><a href="#BaseCustomDetector.save_model-75"><span class="linenos">75</span></a><span class="sd">        Optional method to save model to disk.</span>
</span><span id="BaseCustomDetector.save_model-76"><a href="#BaseCustomDetector.save_model-76"><span class="linenos">76</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector.save_model-77"><a href="#BaseCustomDetector.save_model-77"><span class="linenos">77</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Optional method to save model to disk.</p>
</div>


                            </div>
                            <div id="BaseCustomDetector.load_model" class="classattr">
                                        <input id="BaseCustomDetector.load_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">path</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BaseCustomDetector.load_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaseCustomDetector.load_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseCustomDetector.load_model-79"><a href="#BaseCustomDetector.load_model-79"><span class="linenos">79</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
</span><span id="BaseCustomDetector.load_model-80"><a href="#BaseCustomDetector.load_model-80"><span class="linenos">80</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector.load_model-81"><a href="#BaseCustomDetector.load_model-81"><span class="linenos">81</span></a><span class="sd">        Optional method to load model from disk.</span>
</span><span id="BaseCustomDetector.load_model-82"><a href="#BaseCustomDetector.load_model-82"><span class="linenos">82</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseCustomDetector.load_model-83"><a href="#BaseCustomDetector.load_model-83"><span class="linenos">83</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Optional method to load model from disk.</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>